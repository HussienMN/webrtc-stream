import{openBlock as Y,createElementBlock as Q,createCommentVNode as $,createElementVNode as G,pushScopeId as cr,popScopeId as ur,toDisplayString as Ue,withDirectives as Je,vModelText as Ke,createTextVNode as At,defineCustomElement as Xe}from"vue";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))s(d);new MutationObserver(d=>{for(const r of d)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(d){const r={};return d.integrity&&(r.integrity=d.integrity),d.referrerpolicy&&(r.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?r.credentials="include":d.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(d){if(d.ep)return;d.ep=!0;const r=i(d);fetch(d.href,r)}})();const Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABFElEQVQ4je2TTUrDUBRGz5ek065AN+ECTFId2KEgVhBEHFTBbbgFJ0WLCEKLOFRHNq0L6CL82YBTm3cdaEsbEmzTac/s3cc977twH6xYFkVJ4wpxDPhz9qRC7STqNPMugwVlAL5hJ8CMsPba2HCm3WBB2UQ6fYiS/e3U8SCs6pWQzRAPGkdIT4IqQL5Q9uilbg0L1oHnIlk0ODg34waojGv5Qlc5623df/bjuw8nnRYJZRYCmq4tPXKWIP/pUStKDpvOS+WZa2VCTDBpgNnedMqihHU0evfM3kA7RWn6YedSv2v3/Z9wbpKweyunusHXWJiW8Mz0JLXOi+8RI10EQu2/zZ/76xlcZ4u9ze4QGJYItyLDD9x1UbGriRMcAAAAAElFTkSuQmCC",Ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAACD0lEQVQ4jbWTPWsUURiFn/fO7C5CLETslCgSSKN2AUFUEEFB3NmZrGAKBQ1qrWClEAsLwcLCShFEJAHX2Q+FWMQUWopNImjAJv4AuxDNTnaOhWyc7G42GvB089wz575n7h34n1otlc40w/DdShSd28iTlErHOtnPINi/XCzuAXBrxjC8kZo1gKMmPfkRBHt7BQrGkzC82X5eiaJh53kvne/nAAygGUUXkZ6uf1OzuVrtpIHW4XLZS1qtZwZzqdkrgynB+UIcL/yZULrUNYrZiSQMr3ThSqWV87wLwGEnzWTDspUXe9UD7vSCzTQdEgwCH510Nrvmfg+oxgaBXzvBShQNmzQpszHf80YFh7Lf1AHkfb+B2aeuetKtLpamD2U2VojjhXZ9SQfap29t42oQnE6dm842QxrJ12pzG0zfU2vXxq/X3wCTmbU8Zo3lMNy9pUCAnOddRfqcQYM+zKhc3rWlQKtUluRcBHzP4OGk1Xrf/hM2k/WCzSAYwbm3wPYM/oZUNM/boTS9CwwBt3PV6qPs5e8ZCJCMjh5Xmr4GBrJ7Afl1Rmm2JY1vq9cX+wZmJp0GdvbzAUsyu1yI4xeunytfr3+Q2RHgyyaBAyZdg45D6aVCHC/kPG8EaaqPLXVm92GTyp1KSqVTMrsHHMxgAdfz1eqDfw4E0MSEa87PF00qYrZPZo8Lcfz8X3P+Wr8ABB/HFBvq4VkAAAAASUVORK5CYII=",et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABx0lEQVQ4ja2UsWsTURzHP79312tS6JjapVOnLjrUTcSL7f0BDqkVLG4ddBZBQTo5+CcUJ4XWkqVzSMkVBSlUEMFRnRMHU7CNMXfv53BJCLF3zRW/03vfd98P3/ce9+A/SwYDv1GZV3ECIxTzAKzScSOpHazuNodAv1GZR8xnoHSZVoq23Mi5erC62zQAKk5wWVjSSuZiJw4AXAAjFFVTv/+E6H5SRe4A186FGjMzBKZJYUe0+SD0wwhg+Xjzxeyvk9fAelrGZPAi0e6jsJzAAD5e3+5FjvMQiNJCqUCFb2F5vz3uv7+58xP4nhsosLB8vDk17le+VDxgITcQKM6etp+Om60f5hlQSAtlXgoqW+Xw7qJFq0lrswZ6PyuSDQQUNgTZGM4u0IVAoAd87Y8XgX/OdVRZZ9hB5bHbs6XQ31sK/b0lt2dLgj4BOnkbnoqVlcbtt0ejZj2ongAvb4WVd2DqAjMTNRR4Pg4b1aFf/QBsnbdmIHmCRrxuoeC+SoMNNNWz2wp/BnO19gz6W3YjqUWubQkyB7R/d+P18mHq7wpAnFDaJJmm503X+rtLtFK/dyV24mDwakwqtfbM86ZrtRtvWnlyE+svrTqU8LdDK/8AAAAASUVORK5CYII=",tt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABjUlEQVQ4ja3UvU4bQRDA8f/s3dknYsq8BwVSBCZFFIlA3GCv3eRR6KGjdkOZIhL+KCInllwgmkgpoiChPEBaN0hACOfV7VCALWTHPux4utXM/rQ7s3ew5JCsgoG1r/D+QOE4325/yqoPZyVdtfpavf+CSEFgBcgEzVSsUimq9x2gAIBILgubCrpKpajwFVh9DjITdOXy1qIYQJhYa0V1G7j1qnUV6QIvFsEAQlH9CMSInBv4lYUN9vbWIud+S6dzCeDK5Y0wDC/k5OQGHqYcP9amiBhUZ55ARF66fL6utVop8b6oqvskyfbohPNeKWq3e3fWxi5NTw3cRkFQklbrepif+mwWjblBZ+07o7ofBcEbL3Lo0rSjtVphmA+BOx76GKDqs0CFfpQk7x+H8nlgbZ84HjU+VPggsAP88SJnRvWG4dfxj8g1mz/H1t+frid+Dq5a3VTvu4w/bJEfuWZzPesGEz2MGo1vYswOqldZm58FjtAg2F0EnTrlCVT173+BQxRj3gI9FTma56RLi3t9VZbFYnefggAAAABJRU5ErkJggg==",rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABmUlEQVQ4ja2TTU/UUBSGn3N7Z2x0XPo/XJgYZySdQgIoS9Nmwk9hDzvXbFwSKHEn4SMhaTvGkLgwmhh/gFs2JIowDNweF6aEANMyI+/u5Jz75L3nA+5ZUlcQpr3n6ukyBe/ycDOpq7dVySDvTSm6g9JC5CFQCzSjncUdQbeBFgBCsw42EhimcUeN7AKP7wKpBHaz6OWkMAAbpvGbwsisCCeeYdU59oBHk8AArBpZE/BRvrkLfiDVsG4WPb2wjZ+fptaPAII8eiHK9zx8fwz/puwDIOJEMKpa6UDFPrHOrc4dRAuDoXQEWTpvnM5eOhz3S/3uxn6Qx/5gaDKBkwfNYiFvf/hd5keuzaQaGxim8ZwgS36zCBVdORua7W4Wtcq8BQaAj6qnSlF3jM4zh4Uxr/P25hGwFaa9w8a5f9l4q8gi6LxB/zhj+0bdMeV13KKPQfL1apxNJ5+vxjf8TPd77UJ1j+uLLfIlD5Jn1f5v6WEaJAdGZF7hV93jOwFLqCfyahLoyCnfgCqn/wUsoaIyA7qPFm/Hsnpf+gvLXZRbns8R7AAAAABJRU5ErkJggg==",nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABYElEQVQ4jdXUz0pVURQG8J//oEapVwQnDRqk4wTJuTNFpIGIPkHQAxQoBjXQsc+gIggqKBgoPoBWzoyQomGz2+yCSg72Em+3vW8qTVyw4Jz9fevb+9tnrcN/jpYm2AReobNhvYolbN1moyEcoCuDdQc2VDphBe/xDG2x3osRfC1s2I89/Iz3C3zCLGxivE6sMTowENle4LRJV7QBRwXSQyziM5axEs8LeFCoOWptIraDb5L11RAcwY/AsqIlwbdYw3fsYjDyA06xjvlC7V+WOyRrPTjEozqsM/iV4DTeadbyE5zgObbxqw6rxtowvgT3j8gJ/s4byXKy3JLlSmD1k9Ll2vKxjOVcX51Jlz+JN1IDbwc2hteYkr70+U1OSGqJfbyM04xFVqT53pNvm2If1jCKx1E8jZnYpC/Ea4Vam9LYlEavXZrdp5qP3gtsXP0c3kmNWxL9V1zgI+buWH+f4xKFC0baKicJqAAAAABJRU5ErkJggg==",it="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAB3klEQVQ4jd2UMWsUURSFv/NmJOkSENJIigQRtNQQgm2iLLoDLoJFKn+A4B9QiETQ3j9go2AhKLsKgbVVESLYJCAkjRZiYzoNmXnHwqcsu2/AwspTXe5957xz77sz8I+htkJVVVeAG5JmR/O2D4AH/X7/+V8LdrvdZUmvgaLlvsb2+cFg8G5CsNfrHW+a5q7ts5KK5GIemGtzn/BV0qd0vpH0viiKW2Vd1w+BbirkiEfAXopPAmWK52z/udT2cl3XJ0rgQouD75I2Yoxbks4k0o6kDrABTGc4FwMw1SJ2GViQNATWgXVJQ0nzki4BPzK8qZCzJmkDuGZ7McbYkbQtaTvG2LF9CrgK3Mlxy0zuKLU5jDF2QgivbM8AhBBuxhjXQghbtlclbY5r5Bzup5m9LYqiAmZGarOSusCbEMJpSfvj5AlBSa3LPnoMwPbE2QlB2wu2d4CVpmn6wMFI+ZvtAbASY9wFFsb5uRkek9SR9CSEcC/GuJbaxPZA0n3gcdqCCX72lfm1Z08lfQwhbElakrSU4l3gGXA7RwzAYSY/bful7c+2V5OjRyn+Arwgv9iHqqqqT/r0WlADe5JkezHX5gj6ZVmW1+u63gTO/f45tEHSh1zedgNsl2WZHcN/jp+VGrv3WV2zAQAAAABJRU5ErkJggg==",dr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAACoUlEQVQ4ja2TwYtTVxTGf+cmLwEFKxoXtmqgdNmOFFopFtOC2gFhCHmZzLIttAzIoH9LXagQkILQxTC8lwk6ShCpMyuVlkLTTaEba+tG6zAbJXne+3UxL0HHmTYLv+0593e/79x74A3Ldipks7PH5f0cZjXBwbz5EbAGLJbS9O5EwOdxXHVml036AumOOdcLITwEcGZHBNPA54Kb3vuzu7rdhzsCh3H8MXAN+F3SQrnT+W07F4Nmc8qki4L3zGymlCQ/vQZ8HsfVAtwDelGl8q2125kajf2Zc02k9wGQ+lGxmNjS0lPNz0fZkydXBKe998dGTu2lW2+YtDuqVE5Zu50N4/hr4DvgrS0GN5DOlzqdq5qfj7LHj2/LuY1yksyMgdns7HGFsCbvPyx3u/0c9v12cceSvip1Olfz+L8An5bS9K4DkPdzSHfK3W5fjcb+3Nl/y+yCWq195ST5FVjFbA7A5cUT5lwPIHOuuU3M7bQ38z4GMKkH1ACKefFQgAd5lA8mgI00BRDgAdI7Y4eCgDR6IE2MkwIAztnonIPNDXBQzZv6EwPN+jmkavD3GAis5RtAVCwmwMYEsPVoMEgBFMI00trLwEXgs0GzOWVLS0+Rzv8fTyGcs5WV9WGjcRSzGtJinnZTgzi+btKe6MCBk9ZuZ8NG40vMLgB7tzpTCOfKnc4P+bb8aPBPlKb1V4DP6vXDhULhvsGtqFL5xtrtTK3Wvsz7GLPNl5f60WCQ2MrKulqtUvbixRWZnfRwbFea/vUKEGDYbH4k6ZrBHzJbyD/ta8pjXhS8ayHMlJaXfx4H2Nr8rF4/XCgWL5l0Blg1qRec+zMfeFUhTGNWM7iewcLI2Y7AsYs4/iRfp5qktzfHZ48IYRVpsbS8fH+ns29U/wIA+TUeGvfQwAAAAABJRU5ErkJggg==",fr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAACYElEQVQ4jZWUvWuTURSHn3OTt2lT6gcitBVxsFDEQXfJH+DQj6RRWxxFlKKLS0EXBxcpuKiLuKktko+XZskqfswWRFpBHBSs0upQtS9p0vfnktS0edPWM13uOee559z7u8fYxXT27L71ZLIfoCOZ/GJPnvzZKd4AKpnMbaTnCd9fANC5c/trGxvXBVng1NYMmzcpFw+CB1Yur0YD0+kTZjYraQKzk2b2COngLsWvSJpM+H6uBdgEnQMGmvd3MZnZlFcoTDc23ObCrBe4KPi+RxiASbpbyWSyWypUOn2oavYBWCQMb8i5OYPe/wAve0EwYOXyqgOoOXcVOAScwbl7FoYjgm9NCZ8FSzsAD9e6uq5BvWVJ403OrVCzSx3F4rFEsdhvUgr4EkWsKwLT6OiBqnM/aX2INzK7YtIzSRMNSVWz2ZTC8GUU0+vu7nHrZn0RMATHE4XC+zAWu2DOzVTGxk4CePn8qzbtW+X37yNOsLHD3dCZy30InRs3eNqAunY5zsk0PNxTjcdbFA9gUsrz/dfwT/zAfeBxZMu12n5npdIvzOajgDKbqWazKYCE7y/I7KLgTptm5q1U+hWvV5ITnI4IOqowfFnJZJbqcZ8Iw5EonRrkoC6beBA8AFbanIxBn0Ef7XX6Ix4EDzeBVi6vSpoE1A7aZNuhElxuTJ7Nv5zw/ZyZTf0XFIaBj0iLDYdrjvIKhWnBeWB5D9BBc65b0oiZzVbS6RMtQIBEsZj3gmDA4BbwdptbmL0zuOnFYoNePv8i4fsLkiaAcdjD3NPQULLS2XnUwtA61ta+Rk3pZvsLe9YIjA9iThoAAAAASUVORK5CYII=",lr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABOElEQVQ4jc2UMUtCYRSGn/PdCiQpKMKgaK6hlghBoisYNAeZ9AOE/kZ7Q2PUL5A7NAcFXQcposnFORAyKChMpfA7LSUkdb12hXrG8x2e7z3DOfDfkZ8eMmebk9aMzKrolKiMAqjoi+M497y2qufrJw+BwjU/uyhqdkVYRpkHxnuEeUKoqHKjYg+LrlfuCDPFnaW2tZdArM8JP2lascmi65UNQFttPoIMIOaoyQMYAFESAc0aUjrdEQahkFQohZT2FvrpwrXvFlYVthVuIwsBENRPF7yxeGMBlT2gFU3YB0OhuhRx/dzWc519EZ2LJHQvciv4HAikBpJQ4IqAFe3GAKhQC3aG4q4jtNgjhUbYFN0oNNpij7/8PtDj8B0bpexE840ZYyUBxD/KdWu0FhumepryHn870d/yDu+TcMMbTDGzAAAAAElFTkSuQmCC",hr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABVUlEQVQ4jdWTK04DURiFv3On04SHGV6WBZCQGkxNKwmTVNRj2AIKVNkBC8AhEE1QjEF1CYTQDWAbMggegWn/iyidtEAHSjAcee5/vvzn5l5RIF+vl7Io2sD7EgBSP0zTrjqd/rRMqQiYRdEJUoj08G4tZktLL8DetIzybVotl11dbQJBfurcKWa7E4nP3iCsVK7VatkkMI6jrFw+R6oXbf1J3nfC19emkiQFcPmqSZLi3NlMsOHGZyPYBPCv9L+BPUENKb8fpFRQA3q/Aa4aHOD9DnAH3MusAewDq9NChQ9bsO1h4JxrAJjZoSAuyhQCASRVfb//BKAgqOJ94fx3wGFN544MyhrWvwCWfwN8lHPxqKaAUX1vdgkszAqUNzsWbOUGxN5sjbEvOwtwnjHYmL7ycv2znyLvu8BghvxA0s0E4+PEc7O5Hpit/IgWhr25dvt23HsDxO9yGjfOZdYAAAAASUVORK5CYII=",pr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAACUUlEQVQ4jc2Uv4vdRRTFP3PunSe6u+zGH2kE9xGzBC38E0SwVrfSTlKIVlZaWGzxQO1sLRaJSkCEQDRiJRIClmIdQSWJEkSMrPmx2d2Z+c58Ld7b56LfJbCFeJp778zh3MMtDvzfEXpejbuLi+s1hGNVRkEUm1VFGlAsUjCqRMEoNqsSbTZ3+J/HVsefh92lN94qcAH4oyks3ZzvWubWfrsCN/ebGeZ/wHZ56I5i90iJ9rwniVpdaRQ2Gna533eJCDZ1WbIhRLFAm7kEUW3qsvf6ZNZoM/UKnuWUYM9G843jNybbR7nbmVNfLNWWT1cFlHCy3O4u0B1FDEBpq2TJshwV85Lkg8SePnz12PvPfX1ic/leokWRZBFV4nediWsDpIuPfrBWg6/u9Pb6+fFHpydMNCT2M2OyRJbQ3kglKQ5u3Tb3Iv/lhauvvLPr8dsTJ9feO/vU2YVBhzhJjlLV0wkBq/8iZWAHm/d7h5wGIFkk43g2pwvDxObWFfPxh2ufbnTY9V9/uPzmhEkbFJSoQXhSpJMxJPnSlZd/PHPy3KnawjevXXnx1gBlijHk25EuCO/kJDQoGAg9P/HloUIzXAMWEAXHs0QJXm88sHD4ge4BlRizj2rphSc5ne672KW9tz9+/JPvi0WaoBDnQVBnQXAwGNqBuWZ7ojQ2k2vdM5EcWu93/d07D3dLUIEV/g6JBjRuszwfE0Cbvu8srtCpfNbt3n+8t74Pl5655Fev/7ZeZA8WGRXN42rfVTsQV/Uf8VWYRlw229oa/X7hqGf77/AXgQ384L65jNkAAAAASUVORK5CYII=",st="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAABBElEQVQokbWPsU4CQRRFz93diRU22PgPJPyA32AC4QtMrOwlWllqorUmJtLYYSD+gm5rRaMJFPbEQitZdp4FsGtwxaXwVvfOvDPvjiiQNRrVBHYJAof3iYuie3W7b8tzQRGcSEeCZ9L0SWH4kqTpcdGcFuaz2TwTtGarbQtpnFfJs8HdRq/XBoiyeymW2eHsSQFs5ivybFK8snZZ/Qt8AIzmfjTPPxQVHQKnBvuY7SHdCK7XgSuCtptOdxLnYqCyTu1Xg/OJc0MzuwCGpWFBR3Al2JZ0KbgtXdvg5PsXlvKftUspg0PpowwQev++8FntqFZ7mAwGLUH1N9C8H7t6/ZF+H4AvBnpOIAEHayQAAAAASUVORK5CYII=",mr=`img[data-v-b455a7f4]{background:none;border:none}#videoCall[data-v-b455a7f4]{width:75%;height:75%;position:relative;border:solid 1px #000;margin:0 auto;background-color:#ffffff4d;overflow:hidden;border-radius:8px}#videoCall .remote-stream[data-v-b455a7f4]{width:100%;height:50%;background:rgba(245,246,247,.7);z-index:-1}#videoCall .local-stream[data-v-b455a7f4]{width:25%;height:25%;position:absolute;z-index:1000;background:#fff;border:solirgb(203,204,200)x rgba(255,255,255,.3);bottom:0;left:0%}#videoCall .controls[data-v-b455a7f4]{position:initial;bottom:0;right:0;margin-right:20px;margin-bottom:10px}#videoCall .controls button[data-v-b455a7f4]{border:0 none;padding:11px 12px;margin-right:6px}#videoCall .controls button i[data-v-b455a7f4]{color:#f5f5f5}.container[data-v-b455a7f4]{position:relative;width:50%}.container canvas[data-v-b455a7f4]{width:100%;height:auto;border-radius:5px}.container .btn[data-v-b455a7f4]{position:absolute;top:92%;left:96%;transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);padding:5px 9px;border:black;cursor:pointer}.material-icons.md-18[data-v-b455a7f4]{font-size:18px}.material-icons.md-24[data-v-b455a7f4]{font-size:24px}.material-icons.md-36[data-v-b455a7f4]{font-size:36px}.material-icons.md-48[data-v-b455a7f4]{font-size:48px}
`,ot=(l,t)=>{const i=l.__vccOpts||l;for(const[s,d]of t)i[s]=d;return i},gr={data:function(){return{localStream:null,isStreaming:!1,isJoined:!1,SHButton:!1,recordedVideo:[],isrecordedVideo:!1,recording:!1,mediaRecorder:null,webcamVideo:null,SHButton:!1,isShare:!1,stream:null,muteBtn:!1,hideCamBtn:!1,isscreenShot:this.isScreenShot}},props:{videoWidth:{type:[String,Number],default:450},videoHeight:{type:[String,Number],default:250},isAudio:{type:Boolean,default:!0},audioBitsPerSecond:{type:[String,Number],default:128e3},videoBitsPerSecond:{type:[String,Number],default:25e5},mimeType:{type:String,default:"video/webm;codecs=vp8,opus"},isStartStream:{type:Boolean,default:!0},isStoptStream:{type:Boolean,default:!0},isScreenShot:{type:Boolean,default:!0},isRecording:{type:Boolean,default:!1},isShareScreen:{type:Boolean,default:!1}},methods:{startCall:function(){this.isStreaming=!0,this.localStream=navigator.mediaDevices.getUserMedia({video:{height:this.videoHeight,width:this.videoWidth},audio:!0}).then(function(l){this.$refs.localVideo.srcObject=l,this.$refs.localVideo.play(),this.localStream=l}.bind(this)).catch(function(l){console.log(l)})},stopStreaming:function(){this.isStreaming=!1,this.$refs.localVideo.srcObject?(this.$refs.localVideo.srcObject.getTracks().forEach(l=>{l.stop()}),this.$refs.localVideo.srcObject=null,this.noSrc=!1):alert("there is no streaming")},screenShot:function(){this.localStream?(this.SHButton=!0,this.$refs.canvas.width=this.$refs.localVideo.videoWidth,this.$refs.canvas.height=this.$refs.localVideo.videoHeight,this.$refs.canvas.getContext("2d").drawImage(this.$refs.localVideo,0,0,this.videoWidth,this.videoHeight)):alert("error")},screenShotDelete:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,this.videoWidth,this.videoHeight),this.SHButton=!1},startRecording:function(){this.recordedVideo=[];let l=[];l=this.recordedVideo;var t={audioBitsPerSecond:this.audioBitsPerSecond,videoBitsPerSecond:this.videoBitsPerSecond,mimeType:this.mimeType};let i=this.$refs.localVideo.srcObject;this.localStream?(this.mediaRecorder=new MediaRecorder(i,t),console.log("the mediarecorder"+this.mediaRecorder),this.recording=!0,this.isrecordedVideo=!0,this.mediaRecorder.ondataavailable=function(s){if(s.data&&s.data.size>0){l.push(s.data);return}},this.mediaRecorder.start()):alert("there is no streaming pls start streaming first")},playStream:function(){if(this.mediaRecorder!=null){const l=new Blob(this.recordedVideo);this.$refs.webcamVideo.src=URL.createObjectURL(l),this.$refs.webcamVideo.controls=!0,this.SRButton=!0,this.$refs.webcamVideo.play()}else alert("there is no recorded video to be displayed")},playStreamDelete:function(){this.$refs.webcamVideo.src!=null?(this.$refs.webcamVideo.src=null,this.$refs.webcamVideo=null,this.SRButton=!1):console.log("error")},stopRecording:function(){this.mediaRecorder!=null?(this.mediaRecorder.stop(),this.recording=!1):alert("it is not recording")},ShareScreen:function(){this.joined=!0,this.isShare=!0,this.stream=navigator.mediaDevices.getDisplayMedia({audio:!0,video:{width:this.videoWidth,height:this.videoHeight}}).then(function(l){this.$refs.shareScreen.srcObject=l,this.stream.getVideoTracks()[0],this.$refs.shareScreen.srcObject=l}.bind(this)).catch(function(l){alert(l)})},stopShareScreen:function(){this.isShare=!1,this.$refs.shareScreen.srcObject&&(this.$refs.shareScreen.srcObject=null,this.stream=null)},doMute:function(){this.muteBtn=!0,this.$refs.localVideo.srcObject.getTracks()[0].enabled=!1},unMute:function(){this.muteBtn=!1,this.$refs.localVideo.srcObject.getTracks()[0].enabled=!0},hideCam:function(){this.hideCamBtn=!0,this.$refs.localVideo.srcObject.getTracks()[1].enabled=!1},showCam:function(){this.hideCamBtn=!1,this.$refs.localVideo.srcObject.getTracks()[1].enabled=!0}},mounted(){}},Se=l=>(cr("data-v-b455a7f4"),l=l(),ur(),l),yr={id:"videoCall"},vr={key:0,class:"remote-stream",ref:"localVideo",id:"localVideo"},Er={class:"controls"},Sr=Se(()=>G("img",{src:Ct},null,-1)),wr=[Sr],br=Se(()=>G("img",{src:Ze},null,-1)),Ar=[br],Cr=Se(()=>G("img",{src:et},null,-1)),kr=[Cr],xr=Se(()=>G("img",{src:tt},null,-1)),Br=[xr],Tr=Se(()=>G("img",{src:rt},null,-1)),_r=[Tr],Rr=Se(()=>G("img",{src:nt},null,-1)),Nr=[Rr],Or=Se(()=>G("img",{src:it},null,-1)),Ir=[Or],Fr=["isRecording"],Pr=Se(()=>G("img",{src:dr},null,-1)),Mr=[Pr],Dr=Se(()=>G("img",{src:fr},null,-1)),Vr=[Dr],jr=Se(()=>G("img",{src:lr},null,-1)),Ur=[jr],Lr=Se(()=>G("img",{src:hr},null,-1)),zr=[Lr],Hr=Se(()=>G("img",{src:pr},null,-1)),Wr=[Hr],Gr={key:1,class:"media_v",ref:"webcamVideo",autoplay:"",playsinline:"",style:{"border-radius":"8px"}},Yr={key:2,class:"media_v",ref:"shareScreen",autoplay:"",playsinline:""},Qr={class:""},qr={key:0,class:"container",id:"container"},$r={ref:"canvas"},Jr=Se(()=>G("img",{src:st},null,-1)),Kr=[Jr],Xr=Se(()=>G("img",{src:st},null,-1)),Zr=[Xr];function en(l,t,i,s,d,r){return Y(),Q("div",yr,[l.isStreaming?(Y(),Q("video",vr,"thier video",512)):$("",!0),G("div",Er,[l.isStreaming?$("",!0):(Y(),Q("button",{key:0,onClick:t[0]||(t[0]=(...h)=>r.startCall&&r.startCall(...h)),title:"start stream"},wr)),l.isStreaming?(Y(),Q("button",{key:1,onClick:t[1]||(t[1]=(...h)=>r.stopStreaming&&r.stopStreaming(...h)),title:"start stream"},Ar)):$("",!0),l.isStreaming&&l.isscreenShot?(Y(),Q("button",{key:2,onClick:t[2]||(t[2]=(...h)=>r.screenShot&&r.screenShot(...h)),title:"selfie"},kr)):$("",!0),l.isStreaming&&!l.muteBtn?(Y(),Q("button",{key:3,id:"muteBtn",onClick:t[3]||(t[3]=(...h)=>r.doMute&&r.doMute(...h)),title:"mute"},Br)):$("",!0),l.isStreaming&&l.muteBtn?(Y(),Q("button",{key:4,id:"muteBtn",onClick:t[4]||(t[4]=(...h)=>r.unMute&&r.unMute(...h)),title:"ummute"},_r)):$("",!0),l.isStreaming&&!l.hideCamBtn?(Y(),Q("button",{key:5,id:"hideCamBtn",onClick:t[5]||(t[5]=(...h)=>r.hideCam&&r.hideCam(...h)),title:"hide camera"},Nr)):$("",!0),l.isStreaming&&l.hideCamBtn?(Y(),Q("button",{key:6,id:"hideCamBtn",onClick:t[6]||(t[6]=(...h)=>r.showCam&&r.showCam(...h)),title:"show camera"},Ir)):$("",!0),this.isStreaming?(Y(),Q("button",{key:7,onClick:t[7]||(t[7]=(...h)=>r.startRecording&&r.startRecording(...h)),isRecording:i.isRecording,title:"start recording"},Mr,8,Fr)):$("",!0),this.isStreaming&&this.mediaRecorder?(Y(),Q("button",{key:8,onClick:t[8]||(t[8]=(...h)=>r.stopRecording&&r.stopRecording(...h)),title:"stop recording"},Vr)):$("",!0),this.isStreaming&&this.mediaRecorder?(Y(),Q("button",{key:9,onClick:t[9]||(t[9]=(...h)=>r.playStream&&r.playStream(...h)),title:"play record"},Ur)):$("",!0),this.isStreaming&&this.mediaRecorder?(Y(),Q("button",{key:10,onClick:t[10]||(t[10]=(...h)=>r.playStreamDelete&&r.playStreamDelete(...h)),title:"delete record"},zr)):$("",!0),this.isStreaming?(Y(),Q("button",{key:11,onClick:t[11]||(t[11]=(...h)=>r.ShareScreen&&r.ShareScreen(...h)),title:"sharescreen"},Wr)):$("",!0)]),l.isStreaming?(Y(),Q("video",Gr,null,512)):$("",!0),l.isStreaming?(Y(),Q("video",Yr,null,512)):$("",!0),G("div",Qr,[l.isStreaming?(Y(),Q("div",qr,[G("canvas",$r,null,512),l.isStreaming&&this.SHButton?(Y(),Q("button",{key:0,class:"btn",onClick:t[12]||(t[12]=(...h)=>r.screenShotDelete&&r.screenShotDelete(...h))},Kr)):$("",!0)])):$("",!0)]),this.isStreaming&&this.isShare?(Y(),Q("button",{key:3,onClick:t[13]||(t[13]=(...h)=>r.stopShareScreen&&r.stopShareScreen(...h))},Zr)):$("",!0)])}const tn=ot(gr,[["render",en],["styles",[mr]],["__scopeId","data-v-b455a7f4"]]),xe=Object.create(null);xe.open="0";xe.close="1";xe.ping="2";xe.pong="3";xe.message="4";xe.upgrade="5";xe.noop="6";const Qe=Object.create(null);Object.keys(xe).forEach(l=>{Qe[xe[l]]=l});const rn={type:"error",data:"parser error"},nn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",sn=typeof ArrayBuffer=="function",on=l=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(l):l&&l.buffer instanceof ArrayBuffer,jt=({type:l,data:t},i,s)=>nn&&t instanceof Blob?i?s(t):Nt(t,s):sn&&(t instanceof ArrayBuffer||on(t))?i?s(t):Nt(new Blob([t]),s):s(xe[l]+(t||"")),Nt=(l,t)=>{const i=new FileReader;return i.onload=function(){const s=i.result.split(",")[1];t("b"+s)},i.readAsDataURL(l)},Ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",je=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let l=0;l<Ot.length;l++)je[Ot.charCodeAt(l)]=l;const an=l=>{let t=l.length*.75,i=l.length,s,d=0,r,h,v,E;l[l.length-1]==="="&&(t--,l[l.length-2]==="="&&t--);const k=new ArrayBuffer(t),S=new Uint8Array(k);for(s=0;s<i;s+=4)r=je[l.charCodeAt(s)],h=je[l.charCodeAt(s+1)],v=je[l.charCodeAt(s+2)],E=je[l.charCodeAt(s+3)],S[d++]=r<<2|h>>4,S[d++]=(h&15)<<4|v>>2,S[d++]=(v&3)<<6|E&63;return k},cn=typeof ArrayBuffer=="function",Ut=(l,t)=>{if(typeof l!="string")return{type:"message",data:Lt(l,t)};const i=l.charAt(0);return i==="b"?{type:"message",data:un(l.substring(1),t)}:Qe[i]?l.length>1?{type:Qe[i],data:l.substring(1)}:{type:Qe[i]}:rn},un=(l,t)=>{if(cn){const i=an(l);return Lt(i,t)}else return{base64:!0,data:l}},Lt=(l,t)=>{switch(t){case"blob":return l instanceof ArrayBuffer?new Blob([l]):l;case"arraybuffer":default:return l}},zt=String.fromCharCode(30),dn=(l,t)=>{const i=l.length,s=new Array(i);let d=0;l.forEach((r,h)=>{jt(r,!1,v=>{s[h]=v,++d===i&&t(s.join(zt))})})},fn=(l,t)=>{const i=l.split(zt),s=[];for(let d=0;d<i.length;d++){const r=Ut(i[d],t);if(s.push(r),r.type==="error")break}return s},Ht=4;function ce(l){if(l)return ln(l)}function ln(l){for(var t in ce.prototype)l[t]=ce.prototype[t];return l}ce.prototype.on=ce.prototype.addEventListener=function(l,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+l]=this._callbacks["$"+l]||[]).push(t),this};ce.prototype.once=function(l,t){function i(){this.off(l,i),t.apply(this,arguments)}return i.fn=t,this.on(l,i),this};ce.prototype.off=ce.prototype.removeListener=ce.prototype.removeAllListeners=ce.prototype.removeEventListener=function(l,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+l];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+l],this;for(var s,d=0;d<i.length;d++)if(s=i[d],s===t||s.fn===t){i.splice(d,1);break}return i.length===0&&delete this._callbacks["$"+l],this};ce.prototype.emit=function(l){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),i=this._callbacks["$"+l],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(i){i=i.slice(0);for(var s=0,d=i.length;s<d;++s)i[s].apply(this,t)}return this};ce.prototype.emitReserved=ce.prototype.emit;ce.prototype.listeners=function(l){return this._callbacks=this._callbacks||{},this._callbacks["$"+l]||[]};ce.prototype.hasListeners=function(l){return!!this.listeners(l).length};const Te=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Wt(l,...t){return t.reduce((i,s)=>(l.hasOwnProperty(s)&&(i[s]=l[s]),i),{})}const hn=setTimeout,pn=clearTimeout;function at(l,t){t.useNativeTimers?(l.setTimeoutFn=hn.bind(Te),l.clearTimeoutFn=pn.bind(Te)):(l.setTimeoutFn=setTimeout.bind(Te),l.clearTimeoutFn=clearTimeout.bind(Te))}const mn=1.33;function gn(l){return typeof l=="string"?yn(l):Math.ceil((l.byteLength||l.size)*mn)}function yn(l){let t=0,i=0;for(let s=0,d=l.length;s<d;s++)t=l.charCodeAt(s),t<128?i+=1:t<2048?i+=2:t<55296||t>=57344?i+=3:(s++,i+=4);return i}class vn extends Error{constructor(t,i,s){super(t),this.description=i,this.context=s,this.type="TransportError"}}class Gt extends ce{constructor(t){super(),this.writable=!1,at(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,i,s){return super.emitReserved("error",new vn(t,i,s)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const i=Ut(t,this.socket.binaryType);this.onPacket(i)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const Yt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),vt=64,En={};let It=0,Ge=0,Ft;function Pt(l){let t="";do t=Yt[l%vt]+t,l=Math.floor(l/vt);while(l>0);return t}function Qt(){const l=Pt(+new Date);return l!==Ft?(It=0,Ft=l):l+"."+Pt(It++)}for(;Ge<vt;Ge++)En[Yt[Ge]]=Ge;function qt(l){let t="";for(let i in l)l.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(l[i]));return t}function Sn(l){let t={},i=l.split("&");for(let s=0,d=i.length;s<d;s++){let r=i[s].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}let $t=!1;try{$t=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const wn=$t;function Jt(l){const t=l.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||wn))return new XMLHttpRequest}catch{}if(!t)try{return new Te[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function bn(){}const An=function(){return new Jt({xdomain:!1}).responseType!=null}();class Cn extends Gt{constructor(t){if(super(t),this.polling=!1,typeof location<"u"){const s=location.protocol==="https:";let d=location.port;d||(d=s?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||d!==t.port,this.xs=t.secure!==s}const i=t&&t.forceBase64;this.supportsBinary=An&&!i}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const i=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let s=0;this.polling&&(s++,this.once("pollComplete",function(){--s||i()})),this.writable||(s++,this.once("drain",function(){--s||i()}))}else i()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const i=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};fn(t,this.socket.binaryType).forEach(i),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,dn(t,i=>{this.doWrite(i,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{};const i=this.opts.secure?"https":"http";let s="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Qt()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&(i==="https"&&Number(this.opts.port)!==443||i==="http"&&Number(this.opts.port)!==80)&&(s=":"+this.opts.port);const d=qt(t),r=this.opts.hostname.indexOf(":")!==-1;return i+"://"+(r?"["+this.opts.hostname+"]":this.opts.hostname)+s+this.opts.path+(d.length?"?"+d:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new ke(this.uri(),t)}doWrite(t,i){const s=this.request({method:"POST",data:t});s.on("success",i),s.on("error",(d,r)=>{this.onError("xhr post error",d,r)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(i,s)=>{this.onError("xhr poll error",i,s)}),this.pollXhr=t}}class ke extends ce{constructor(t,i){super(),at(this,i),this.opts=i,this.method=i.method||"GET",this.uri=t,this.async=i.async!==!1,this.data=i.data!==void 0?i.data:null,this.create()}create(){const t=Wt(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const i=this.xhr=new Jt(t);try{i.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let s in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(s)&&i.setRequestHeader(s,this.opts.extraHeaders[s])}}catch{}if(this.method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=()=>{i.readyState===4&&(i.status===200||i.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof i.status=="number"?i.status:0)},0))},i.send(this.data)}catch(s){this.setTimeoutFn(()=>{this.onError(s)},0);return}typeof document<"u"&&(this.index=ke.requestsCount++,ke.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=bn,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete ke.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}ke.requestsCount=0;ke.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Mt);else if(typeof addEventListener=="function"){const l="onpagehide"in Te?"pagehide":"unload";addEventListener(l,Mt,!1)}}function Mt(){for(let l in ke.requests)ke.requests.hasOwnProperty(l)&&ke.requests[l].abort()}const kn=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,i)=>i(t,0))(),Ye=Te.WebSocket||Te.MozWebSocket,Dt=!0,xn="arraybuffer",Vt=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Bn extends Gt{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),i=this.opts.protocols,s=Vt?{}:Wt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=Dt&&!Vt?i?new Ye(t,i):new Ye(t):new Ye(t,i,s)}catch(d){return this.emitReserved("error",d)}this.ws.binaryType=this.socket.binaryType||xn,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let i=0;i<t.length;i++){const s=t[i],d=i===t.length-1;jt(s,this.supportsBinary,r=>{const h={};try{Dt&&this.ws.send(r)}catch{}d&&kn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const i=this.opts.secure?"wss":"ws";let s="";this.opts.port&&(i==="wss"&&Number(this.opts.port)!==443||i==="ws"&&Number(this.opts.port)!==80)&&(s=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Qt()),this.supportsBinary||(t.b64=1);const d=qt(t),r=this.opts.hostname.indexOf(":")!==-1;return i+"://"+(r?"["+this.opts.hostname+"]":this.opts.hostname)+s+this.opts.path+(d.length?"?"+d:"")}check(){return!!Ye}}const Tn={websocket:Bn,polling:Cn},_n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Rn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Et(l){const t=l,i=l.indexOf("["),s=l.indexOf("]");i!=-1&&s!=-1&&(l=l.substring(0,i)+l.substring(i,s).replace(/:/g,";")+l.substring(s,l.length));let d=_n.exec(l||""),r={},h=14;for(;h--;)r[Rn[h]]=d[h]||"";return i!=-1&&s!=-1&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=Nn(r,r.path),r.queryKey=On(r,r.query),r}function Nn(l,t){const i=/\/{2,9}/g,s=t.replace(i,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&s.splice(0,1),t.substr(t.length-1,1)=="/"&&s.splice(s.length-1,1),s}function On(l,t){const i={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,d,r){d&&(i[d]=r)}),i}class Be extends ce{constructor(t,i={}){super(),t&&typeof t=="object"&&(i=t,t=null),t?(t=Et(t),i.hostname=t.host,i.secure=t.protocol==="https"||t.protocol==="wss",i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=Et(i.host).host),at(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=i.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},i),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Sn(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const i=Object.assign({},this.opts.query);i.EIO=Ht,i.transport=t,this.id&&(i.sid=this.id);const s=Object.assign({},this.opts.transportOptions[t],this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Tn[t](s)}open(){let t;if(this.opts.rememberUpgrade&&Be.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",i=>this.onClose("transport close",i))}probe(t){let i=this.createTransport(t),s=!1;Be.priorWebsocketSuccess=!1;const d=()=>{s||(i.send([{type:"ping",data:"probe"}]),i.once("packet",g=>{if(!s)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;Be.priorWebsocketSuccess=i.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(S(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=i.name,this.emitReserved("upgradeError",e)}}))};function r(){s||(s=!0,S(),i.close(),i=null)}const h=g=>{const e=new Error("probe error: "+g);e.transport=i.name,r(),this.emitReserved("upgradeError",e)};function v(){h("transport closed")}function E(){h("socket closed")}function k(g){i&&g.name!==i.name&&r()}const S=()=>{i.removeListener("open",d),i.removeListener("error",h),i.removeListener("close",v),this.off("close",E),this.off("upgrading",k)};i.once("open",d),i.once("error",h),i.once("close",v),this.once("close",E),this.once("upgrading",k),i.open()}onOpen(){if(this.readyState="open",Be.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let t=0;const i=this.upgrades.length;for(;t<i;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const i=new Error("server error");i.code=t.data,this.onError(i);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let s=0;s<this.writeBuffer.length;s++){const d=this.writeBuffer[s].data;if(d&&(i+=gn(d)),s>0&&i>this.maxPayload)return this.writeBuffer.slice(0,s);i+=2}return this.writeBuffer}write(t,i,s){return this.sendPacket("message",t,i,s),this}send(t,i,s){return this.sendPacket("message",t,i,s),this}sendPacket(t,i,s,d){if(typeof i=="function"&&(d=i,i=void 0),typeof s=="function"&&(d=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const r={type:t,data:i,options:s};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),d&&this.once("flush",d),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),t()},s=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}onError(t){Be.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,i){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,i),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const i=[];let s=0;const d=t.length;for(;s<d;s++)~this.transports.indexOf(t[s])&&i.push(t[s]);return i}}Be.protocol=Ht;function In(l,t="",i){let s=l;i=i||typeof location<"u"&&location,l==null&&(l=i.protocol+"//"+i.host),typeof l=="string"&&(l.charAt(0)==="/"&&(l.charAt(1)==="/"?l=i.protocol+l:l=i.host+l),/^(https?|wss?):\/\//.test(l)||(typeof i<"u"?l=i.protocol+"//"+l:l="https://"+l),s=Et(l)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const r=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+r+":"+s.port+t,s.href=s.protocol+"://"+r+(i&&i.port===s.port?"":":"+s.port),s}const Fn=typeof ArrayBuffer=="function",Pn=l=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(l):l.buffer instanceof ArrayBuffer,Kt=Object.prototype.toString,Mn=typeof Blob=="function"||typeof Blob<"u"&&Kt.call(Blob)==="[object BlobConstructor]",Dn=typeof File=="function"||typeof File<"u"&&Kt.call(File)==="[object FileConstructor]";function kt(l){return Fn&&(l instanceof ArrayBuffer||Pn(l))||Mn&&l instanceof Blob||Dn&&l instanceof File}function qe(l,t){if(!l||typeof l!="object")return!1;if(Array.isArray(l)){for(let i=0,s=l.length;i<s;i++)if(qe(l[i]))return!0;return!1}if(kt(l))return!0;if(l.toJSON&&typeof l.toJSON=="function"&&arguments.length===1)return qe(l.toJSON(),!0);for(const i in l)if(Object.prototype.hasOwnProperty.call(l,i)&&qe(l[i]))return!0;return!1}function Vn(l){const t=[],i=l.data,s=l;return s.data=St(i,t),s.attachments=t.length,{packet:s,buffers:t}}function St(l,t){if(!l)return l;if(kt(l)){const i={_placeholder:!0,num:t.length};return t.push(l),i}else if(Array.isArray(l)){const i=new Array(l.length);for(let s=0;s<l.length;s++)i[s]=St(l[s],t);return i}else if(typeof l=="object"&&!(l instanceof Date)){const i={};for(const s in l)Object.prototype.hasOwnProperty.call(l,s)&&(i[s]=St(l[s],t));return i}return l}function jn(l,t){return l.data=wt(l.data,t),l.attachments=void 0,l}function wt(l,t){if(!l)return l;if(l&&l._placeholder===!0){if(typeof l.num=="number"&&l.num>=0&&l.num<t.length)return t[l.num];throw new Error("illegal attachments")}else if(Array.isArray(l))for(let i=0;i<l.length;i++)l[i]=wt(l[i],t);else if(typeof l=="object")for(const i in l)Object.prototype.hasOwnProperty.call(l,i)&&(l[i]=wt(l[i],t));return l}const Un=5;var Z;(function(l){l[l.CONNECT=0]="CONNECT",l[l.DISCONNECT=1]="DISCONNECT",l[l.EVENT=2]="EVENT",l[l.ACK=3]="ACK",l[l.CONNECT_ERROR=4]="CONNECT_ERROR",l[l.BINARY_EVENT=5]="BINARY_EVENT",l[l.BINARY_ACK=6]="BINARY_ACK"})(Z||(Z={}));class Ln{constructor(t){this.replacer=t}encode(t){return(t.type===Z.EVENT||t.type===Z.ACK)&&qe(t)?(t.type=t.type===Z.EVENT?Z.BINARY_EVENT:Z.BINARY_ACK,this.encodeAsBinary(t)):[this.encodeAsString(t)]}encodeAsString(t){let i=""+t.type;return(t.type===Z.BINARY_EVENT||t.type===Z.BINARY_ACK)&&(i+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(i+=t.nsp+","),t.id!=null&&(i+=t.id),t.data!=null&&(i+=JSON.stringify(t.data,this.replacer)),i}encodeAsBinary(t){const i=Vn(t),s=this.encodeAsString(i.packet),d=i.buffers;return d.unshift(s),d}}class xt extends ce{constructor(t){super(),this.reviver=t}add(t){let i;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");i=this.decodeString(t),i.type===Z.BINARY_EVENT||i.type===Z.BINARY_ACK?(this.reconstructor=new zn(i),i.attachments===0&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(kt(t)||t.base64)if(this.reconstructor)i=this.reconstructor.takeBinaryData(t),i&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let i=0;const s={type:Number(t.charAt(0))};if(Z[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Z.BINARY_EVENT||s.type===Z.BINARY_ACK){const r=i+1;for(;t.charAt(++i)!=="-"&&i!=t.length;);const h=t.substring(r,i);if(h!=Number(h)||t.charAt(i)!=="-")throw new Error("Illegal attachments");s.attachments=Number(h)}if(t.charAt(i+1)==="/"){const r=i+1;for(;++i&&!(t.charAt(i)===","||i===t.length););s.nsp=t.substring(r,i)}else s.nsp="/";const d=t.charAt(i+1);if(d!==""&&Number(d)==d){const r=i+1;for(;++i;){const h=t.charAt(i);if(h==null||Number(h)!=h){--i;break}if(i===t.length)break}s.id=Number(t.substring(r,i+1))}if(t.charAt(++i)){const r=this.tryParse(t.substr(i));if(xt.isPayloadValid(s.type,r))s.data=r;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,i){switch(t){case Z.CONNECT:return typeof i=="object";case Z.DISCONNECT:return i===void 0;case Z.CONNECT_ERROR:return typeof i=="string"||typeof i=="object";case Z.EVENT:case Z.BINARY_EVENT:return Array.isArray(i)&&i.length>0;case Z.ACK:case Z.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class zn{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const i=jn(this.reconPack,this.buffers);return this.finishedReconstruction(),i}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Hn=Object.freeze(Object.defineProperty({__proto__:null,protocol:Un,get PacketType(){return Z},Encoder:Ln,Decoder:xt},Symbol.toStringTag,{value:"Module"}));function Ae(l,t,i){return l.on(t,i),function(){l.off(t,i)}}const Wn=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xt extends ce{constructor(t,i,s){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=i,s&&s.auth&&(this.auth=s.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ae(t,"open",this.onopen.bind(this)),Ae(t,"packet",this.onpacket.bind(this)),Ae(t,"error",this.onerror.bind(this)),Ae(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...i){if(Wn.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');i.unshift(t);const s={type:Z.EVENT,data:i};if(s.options={},s.options.compress=this.flags.compress!==!1,typeof i[i.length-1]=="function"){const h=this.ids++,v=i.pop();this._registerAckCallback(h,v),s.id=h}const d=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!d||!this.connected)||(this.connected?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(t,i){const s=this.flags.timeout;if(s===void 0){this.acks[t]=i;return}const d=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let r=0;r<this.sendBuffer.length;r++)this.sendBuffer[r].id===t&&this.sendBuffer.splice(r,1);i.call(this,new Error("operation has timed out"))},s);this.acks[t]=(...r)=>{this.io.clearTimeoutFn(d),i.apply(this,[null,...r])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this.packet({type:Z.CONNECT,data:t})}):this.packet({type:Z.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,i){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,i)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Z.CONNECT:if(t.data&&t.data.sid){const d=t.data.sid;this.onconnect(d)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Z.EVENT:case Z.BINARY_EVENT:this.onevent(t);break;case Z.ACK:case Z.BINARY_ACK:this.onack(t);break;case Z.DISCONNECT:this.ondisconnect();break;case Z.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const i=t.data||[];t.id!=null&&i.push(this.ack(t.id)),this.connected?this.emitEvent(i):this.receiveBuffer.push(Object.freeze(i))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const i=this._anyListeners.slice();for(const s of i)s.apply(this,t)}super.emit.apply(this,t)}ack(t){const i=this;let s=!1;return function(...d){s||(s=!0,i.packet({type:Z.ACK,id:t,data:d}))}}onack(t){const i=this.acks[t.id];typeof i=="function"&&(i.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Z.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const i=this._anyListeners;for(let s=0;s<i.length;s++)if(t===i[s])return i.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const i=this._anyOutgoingListeners;for(let s=0;s<i.length;s++)if(t===i[s])return i.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const i=this._anyOutgoingListeners.slice();for(const s of i)s.apply(this,t.data)}}}function Me(l){l=l||{},this.ms=l.min||100,this.max=l.max||1e4,this.factor=l.factor||2,this.jitter=l.jitter>0&&l.jitter<=1?l.jitter:0,this.attempts=0}Me.prototype.duration=function(){var l=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),i=Math.floor(t*this.jitter*l);l=(Math.floor(t*10)&1)==0?l-i:l+i}return Math.min(l,this.max)|0};Me.prototype.reset=function(){this.attempts=0};Me.prototype.setMin=function(l){this.ms=l};Me.prototype.setMax=function(l){this.max=l};Me.prototype.setJitter=function(l){this.jitter=l};class bt extends ce{constructor(t,i){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(i=t,t=void 0),i=i||{},i.path=i.path||"/socket.io",this.opts=i,at(this,i),this.reconnection(i.reconnection!==!1),this.reconnectionAttempts(i.reconnectionAttempts||1/0),this.reconnectionDelay(i.reconnectionDelay||1e3),this.reconnectionDelayMax(i.reconnectionDelayMax||5e3),this.randomizationFactor((s=i.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Me({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(i.timeout==null?2e4:i.timeout),this._readyState="closed",this.uri=t;const d=i.parser||Hn;this.encoder=new d.Encoder,this.decoder=new d.Decoder,this._autoConnect=i.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var i;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(i=this.backoff)===null||i===void 0||i.setMin(t),this)}randomizationFactor(t){var i;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(i=this.backoff)===null||i===void 0||i.setJitter(t),this)}reconnectionDelayMax(t){var i;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(i=this.backoff)===null||i===void 0||i.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Be(this.uri,this.opts);const i=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const d=Ae(i,"open",function(){s.onopen(),t&&t()}),r=Ae(i,"error",h=>{s.cleanup(),s._readyState="closed",this.emitReserved("error",h),t?t(h):s.maybeReconnectOnOpen()});if(this._timeout!==!1){const h=this._timeout;h===0&&d();const v=this.setTimeoutFn(()=>{d(),i.close(),i.emit("error",new Error("timeout"))},h);this.opts.autoUnref&&v.unref(),this.subs.push(function(){clearTimeout(v)})}return this.subs.push(d),this.subs.push(r),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Ae(t,"ping",this.onping.bind(this)),Ae(t,"data",this.ondata.bind(this)),Ae(t,"error",this.onerror.bind(this)),Ae(t,"close",this.onclose.bind(this)),Ae(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch{this.onclose("parse error")}}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,i){let s=this.nsps[t];return s||(s=new Xt(this,t,i),this.nsps[t]=s),s}_destroy(t){const i=Object.keys(this.nsps);for(const s of i)if(this.nsps[s].active)return;this._close()}_packet(t){const i=this.encoder.encode(t);for(let s=0;s<i.length;s++)this.engine.write(i[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,i){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,i),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const i=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(d=>{d?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",d)):t.onreconnect()}))},i);this.opts.autoUnref&&s.unref(),this.subs.push(function(){clearTimeout(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ve={};function $e(l,t){typeof l=="object"&&(t=l,l=void 0),t=t||{};const i=In(l,t.path||"/socket.io"),s=i.source,d=i.id,r=i.path,h=Ve[d]&&r in Ve[d].nsps,v=t.forceNew||t["force new connection"]||t.multiplex===!1||h;let E;return v?E=new bt(s,t):(Ve[d]||(Ve[d]=new bt(s,t)),E=Ve[d]),i.query&&!t.query&&(t.query=i.queryKey),E.socket(i.path,t)}Object.assign($e,{Manager:bt,Socket:Xt,io:$e,connect:$e});const Gn=`.video-call{display:grid}*{box-sizing:border-box}.grid-container{display:grid;grid-template-columns:auto auto auto auto;grid-gap:5px;padding:0}.grid-container>div{text-align:center;padding:0;font-size:20px}.item1{grid-column:1 / 5;height:120px}.item2{height:430px}.item3{grid-area:2/2/2/4;height:430px;min-width:-webkit-fill-available}.item4{height:430px;text-align:left}.chatMsg{width:100%;border-radius:8px}.chat-box{text-align:left;background-color:#d9eaeb;border-radius:8px}.form{padding:10px;margin-left:35%;margin-right:35%}input[type=text]{width:100%;display:inline-block;border-radius:4px;font-size:15px}.label{font-size:20px}.btn{width:25%;margin-top:10px}.uname{color:#830e0e;font-size:15px}.txtmsg{color:#000}@media screen and (max-width: 600px){.item1{width:100%}.item3{width:100%;grid-area:2/2/2/5}.item4{width:100%;height:5rem;margin-top:0;grid-area:3/1/3/5}}
`,Yn={name:"webrtcComponent",data:function(){return{joined:!1,isscreenShot:this.isScreenShot,creator:!1,joinedChat:!1,roomName:"",userName:"",socketInsance:null,userStream:null,remoteStream:null,userVideo:null,peerVideo:null,userAudio:null,peerAudio:null,rtcPeerConnection:null,rtcDataChannel:null,canvas:null,SHButton:!1,isAudio:this.isAudio,senders:[],iceServers:{iceServers:[{urls:"stun:stun.services.mozilla.com"},{urls:"stun:stun.l.google.com:19302"}]},msg:"",messages:[],muteBtn:!1,hideCamBtn:!1}},props:{socketURL:{type:String,default:"http://localhost:4000"},isAudio:{type:Boolean,default:!1},RoomNameLabel:{type:String,default:"Room Name"},userNameLabel:{type:String,default:"User Name"},videoHeight:{type:[String,Number],default:420},videoWidth:{type:[String,Number],default:420},isScreenShot:{type:Boolean,default:!1},isShareScreen:{type:Boolean,default:!1},isChat:{type:Boolean,default:!1},callEvent:{type:String,default:"call"},readyEvent:{type:String,default:"ready"},leaveEvent:{type:String,default:"leave"},candidateEvent:{type:String,default:"candidate"},offerEvent:{type:String,default:"offer"},answerEvent:{type:String,default:"answer"},createEvent:{type:String,default:"create-room"},joinEvent:{type:String,default:"join-room"}},methods:{call:function(){this.roomName==""||this.roomName==" "||this.roomName==null||this.userName==""||this.userName==" "||this.userName==null?alert("enter a vailed username and room name !"):(this.joined=!0,this.socketInsance.emit(this.callEvent,this.roomName))},createRoom:function(){this.creator=!0,this.joined=!0,this.userStream=navigator.mediaDevices.getUserMedia({video:{width:this.videoWidth,height:this.videoHeight},audio:!0}).then(function(l){let t=this.$el.parentNode.getElementById("peerVideo");this.userStream=l,t.srcObject=l,t.onloadedmetadata=function(i){t.play()}}.bind(this)).catch(function(l){console.log(l)})},joinRoom:function(){this.creator=!1,this.joined=!0,this.userStream=navigator.mediaDevices.getUserMedia({audio:!0,video:{width:this.videoWidth,height:this.videoHeight}}).then(function(l){this.userStream=l;let t=this.$el.parentNode.getElementById("peerVideo");t.srcObject=l,t.onloadedmetadata=i=>{t.play()},this.socketInsance.emit(this.readyEvent,this.roomName)}.bind(this))},leave:function(){this.socketInsance.emit(this.leaveEvent,this.roomName),this.isAudio?this.isAudio&&this.userStream.getTracks().forEach(l=>{l.stop()}):this.userStream.getTracks().forEach(l=>{l.stop()}),this.isAudio?this.isAudio&&this.userStream.getTracks().forEach(l=>{l.stop()}):this.userStream.getTracks().forEach(l=>{l.stop()}),this.rtcPeerConnection&&(this.rtcPeerConnection.onicecandidate=null,this.rtcPeerConnection.ontrack=null,this.rtcPeerConnection.close(),this.rtcPeerConnection=null),this.joined=!1,this.joinedChat=!1,this.roomName="",this.userName=""},ready:function(){if(this.creator){let l=this.$el.parentNode.getElementById("userVideo");this.rtcPeerConnection=new RTCPeerConnection(this.iceServers),this.rtcPeerConnection.onicecandidate=t=>{console.log("candidate"),console.log(t.candidate),t.candidate&&(console.log("from on track function"),this.socketInsance.emit(this.candidateEvent,t.candidate,this.roomName))},this.rtcPeerConnection.ontrack=t=>{l.srcObject=t.streams[0],l.onloadedmetadata=function(i){l.play()}},this.rtcPeerConnection.addTrack(this.userStream.getTracks()[0],this.userStream),this.rtcPeerConnection.addTrack(this.userStream.getTracks()[1],this.userStream),this.rtcPeerConnection.createOffer().then(function(t){this.rtcPeerConnection.setLocalDescription(t),this.socketInsance.emit(this.offerEvent,t,this.roomName)}.bind(this)).catch(t=>{console.log(t)})}},offer:function(l){if(!this.creator){let t=this.$el.parentNode.getElementById("userVideo");this.rtcPeerConnection=new RTCPeerConnection(this.iceServers),this.rtcPeerConnection.onicecandidate=i=>{console.log("candidate"),console.log(i.candidate),i.candidate&&(console.log("from on track function"),this.socketInsance.emit(this.candidateEvent,i.candidate,this.roomName))},this.rtcPeerConnection.ontrack=i=>{t.srcObject=i.streams[0],console.log("from on track function"),t.onloadedmetadata=function(s){t.play()}},this.rtcPeerConnection.addTrack(this.userStream.getTracks()[1],this.userStream),this.rtcPeerConnection.setRemoteDescription(l),console.log("offer okay"),this.rtcPeerConnection.createAnswer().then(function(i){this.rtcPeerConnection.setLocalDescription(i),this.socketInsance.emit(this.answerEvent,i,this.roomName)}.bind(this)).catch(i=>{console.log(i)})}},candidate:function(l){let t=new RTCIceCandidate(l);this.rtcPeerConnection.addIceCandidate(t),console.log(l)},sendMsg:function(){this.joined&&(this.msg="")},addMsg:function(){this.$refs.msg.focus();let l=document.getElementById("msg");if(this.joined){const t={id:new Date().getHours(),msgText:l.value,user:this.userName};l==null||l==""||l==" "?alert("enter a message text"):(this.messages=this.messages.concat(t),this.rtcDataChannel.send(t),l.value="")}},startChat:function(l){this.joinedChat=!0,this.messages=this.messages.concat(l)},screenShot:function(){this.$refs.peerVideo?(this.$refs.canvas.width=this.$refs.peerVideo.videoWidth,this.$refs.canvas.height=this.$refs.peerVideo.videoHeight,this.SHButton=!0,this.$refs.canvas.getContext("2d").drawImage(this.$refs.peerVideo,0,0,320,220)):alert("error")},screenShotDelete:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,this.videoWidth,this.videoHeight),this.SHButton=!1},doMute:function(){this.muteBtn=!0,this.$refs.peerVideo.srcObject.getTracks()[0].enabled=!1},unMute:function(){this.muteBtn=!1,this.$refs.peerVideo.srcObject.getTracks()[0].enabled=!0},hideCam:function(){this.hideCamBtn=!0,this.$refs.peerVideo.srcObject.getTracks()[1].enabled=!1},showCam:function(){this.hideCamBtn=!1,this.$refs.peerVideo.srcObject.getTracks()[1].enabled=!0},ShareScreen:function(){this.joined=!0,this.rtcPeerConnection=new RTCPeerConnection(this.iceServers);let l=this.userStream;this.senders=[];let t=[];t=this.senders,l.getTracks().forEach(function(i){this.senders.push(this.rtcPeerConnection.addTrack(i,l))}.bind(this)),console.log("the senders:",this.senders),navigator.mediaDevices.getDisplayMedia({audio:!0,video:{width:this.videoWidth,height:this.videoHeight}}).then(function(i){const s=i.getTracks()[0];this.isShare=!0,t.find(d=>d.track.kind==="video").replaceTrack(s),s.onended=function(){t.find(d=>d.track.kind==="video").replaceTrack(l.getTracks()[1])}}.bind(this),function(i){alert("error")})}},created:function(){},mounted(){this.socketInsance=$e(this.socketURL),this.rtcPeerConnection=new RTCPeerConnection(this.iceServers),this.rtcDataChannel=this.rtcPeerConnection.createDataChannel("channel"),this.userVideo=document.getElementById("userVideo"),this.peerVideo=document.getElementById("peerVideo"),this.peerAudio=document.getElementById("peerAudio"),this.userAudio=document.getElementById("userAudio"),this.canvas=document.getElementById("canvas"),this.socketInsance.on("leave",function(){this.rtcPeerConnection&&(this.rtcPeerConnection.ontrack=null,this.rtcPeerConnection.onicecandidate=null,this.rtcPeerConnection.close(),this.rtcPeerConnection=null),peerVideo.srcObject&&(peerVideo.srcObject.getTracks()[0].stop(),peerVideo.srcObject.getTracks()[1].stop())}),this.socketInsance.on(this.createEvent,function(){this.createRoom()}.bind(this)),this.socketInsance.on(this.joinEvent,function(){this.joinRoom()}.bind(this)),this.socketInsance.on(this.readyEvent,function(){this.ready()}.bind(this)),this.socketInsance.on(this.candidateEvent,function(l){this.candidate(l)}.bind(this)),this.socketInsance.on(this.offerEvent,function(l){this.offer(l)}.bind(this)),this.socketInsance.on(this.answerEvent,function(l){this.rtcPeerConnection.setRemoteDescription(l)}.bind(this)),this.rtcDataChannel.onmessage=l=>{document.getElementById("textmsg").innerHTML+=l.data},this.rtcDataChannel.onopen=function(){var l=document.getElementById("message").value;document.getElementById("textmsg").innerHTML+=l,rtcDataChannel.send(l)}}},Qn={class:"grid-container"},qn={class:"item1"},$n={key:0,class:""},Jn={class:"form"},Kn={for:"fname"},Xn={for:"lname"},Zn={class:"item2"},ei={key:0},ti={class:"video-call",id:"localCall"},ri={key:0,class:"video2",ref:"peerVideo",id:"peerVideo"},ni={ref:"canvas",id:"canvas"},ii=G("img",{src:st},null,-1),si=[ii],oi={class:"item3",style:{}},ai={key:0},ci={class:"video-call"},ui={ref:"video-chat-room",id:"remoteCall"},di={key:0,ref:"userVideo",id:"userVideo"},fi={key:1},li=At("Welcome to "),hi=At("!"),pi=G("img",{src:Ze},null,-1),mi=[pi],gi=["isscreenShot"],yi=G("img",{src:et},null,-1),vi=[yi],Ei=G("img",{src:rt},null,-1),Si=[Ei],wi=G("img",{src:tt},null,-1),bi=[wi],Ai=G("img",{src:nt},null,-1),Ci=[Ai],ki=G("img",{src:it},null,-1),xi=[ki];function Bi(l,t,i,s,d,r){return Y(),Q("div",Qn,[G("div",qn,[l.joined?$("",!0):(Y(),Q("div",$n,[G("div",Jn,[G("label",Kn,Ue(i.RoomNameLabel),1),Je(G("input",{class:"lable",type:"text","onUpdate:modelValue":t[0]||(t[0]=h=>l.roomName=h)},null,512),[[Ke,l.roomName]]),G("label",Xn,Ue(i.userNameLabel),1),Je(G("input",{class:"lable",type:"text","onUpdate:modelValue":t[1]||(t[1]=h=>l.userName=h)},null,512),[[Ke,l.userName]]),G("button",{class:"btn",onClick:t[2]||(t[2]=(...h)=>r.call&&r.call(...h))},"Call")])]))]),G("div",Zn,[l.joined?(Y(),Q("div",ei,[G("div",ti,[i.isAudio?$("",!0):(Y(),Q("video",ri,null,512))]),G("canvas",ni,null,512),l.SHButton?(Y(),Q("button",{key:0,class:"btn",onClick:t[3]||(t[3]=(...h)=>r.screenShotDelete&&r.screenShotDelete(...h))},si)):$("",!0)])):$("",!0)]),G("div",oi,[l.joined?(Y(),Q("div",ai,[G("div",ci,[G("div",ui,[i.isAudio?$("",!0):(Y(),Q("video",di,null,512)),l.joined?(Y(),Q("div",fi,[G("h3",null,[li,G("b",null,Ue(l.roomName),1),hi]),G("button",{onClick:t[4]||(t[4]=(...h)=>r.leave&&r.leave(...h))},mi),G("button",{onClick:t[5]||(t[5]=(...h)=>r.screenShot&&r.screenShot(...h)),isscreenShot:i.isScreenShot},vi,8,gi),l.muteBtn?$("",!0):(Y(),Q("button",{key:0,id:"muteBtn",onClick:t[6]||(t[6]=(...h)=>r.doMute&&r.doMute(...h)),title:"mute"},Si)),l.muteBtn?(Y(),Q("button",{key:1,id:"muteBtn",onClick:t[7]||(t[7]=(...h)=>r.unMute&&r.unMute(...h)),title:"ummute"},bi)):$("",!0),l.hideCamBtn?$("",!0):(Y(),Q("button",{key:2,id:"hideCamBtn",onClick:t[8]||(t[8]=(...h)=>r.hideCam&&r.hideCam(...h)),title:"hide camera"},Ci)),l.hideCamBtn?(Y(),Q("button",{key:3,id:"hideCamBtn",onClick:t[9]||(t[9]=(...h)=>r.showCam&&r.showCam(...h)),title:"show camera"},xi)):$("",!0)])):$("",!0)],512)])])):$("",!0)])])}const Ti=ot(Yn,[["render",Bi],["styles",[Gn]]]);function _i(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var Zt={exports:{}};/*!
 * SkyWay Copyright(c) 2022 NTT Communications Corporation
 * peerjs Copyright(c) 2013 Michelle Bu <michelle@michellebu.com>
 */(function(l,t){(function(s,d){l.exports=d()})(globalThis,function(){return function(i){var s={};function d(r){if(s[r])return s[r].exports;var h=s[r]={i:r,l:!1,exports:{}};return i[r].call(h.exports,h,h.exports,d),h.l=!0,h.exports}return d.m=i,d.c=s,d.d=function(r,h,v){d.o(r,h)||Object.defineProperty(r,h,{enumerable:!0,get:v})},d.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},d.t=function(r,h){if(h&1&&(r=d(r)),h&8||h&4&&typeof r=="object"&&r&&r.__esModule)return r;var v=Object.create(null);if(d.r(v),Object.defineProperty(v,"default",{enumerable:!0,value:r}),h&2&&typeof r!="string")for(var E in r)d.d(v,E,function(k){return r[k]}.bind(null,E));return v},d.n=function(r){var h=r&&r.__esModule?function(){return r.default}:function(){return r};return d.d(h,"a",h),h},d.o=function(r,h){return Object.prototype.hasOwnProperty.call(r,h)},d.p="",d(d.s="./src/peer.js")}({"./node_modules/@jitsi/sdp-interop/lib/array-equals.js":function(i,s){i.exports=function d(r){if(!r||this.length!=r.length)return!1;for(var h=0,v=this.length;h<v;h++)if(this[h]instanceof Array&&r[h]instanceof Array){if(!d.apply(this[h],[r[h]]))return!1}else if(this[h]!=r[h])return!1;return!0}},"./node_modules/@jitsi/sdp-interop/lib/index.js":function(i,s,d){s.Interop=d("./node_modules/@jitsi/sdp-interop/lib/interop.js")},"./node_modules/@jitsi/sdp-interop/lib/interop.js":function(i,s,d){var r=d("./node_modules/@jitsi/sdp-interop/lib/transform.js"),h=d("./node_modules/@jitsi/sdp-interop/lib/array-equals.js");function v(S){typeof S.mid=="number"&&(S.mid=S.mid.toString())}function E(){this.cache={mlB2UMap:{},mlU2BMap:{}}}i.exports=E,E.prototype.candidateToUnifiedPlan=function(S){var g=new RTCIceCandidate(S);return g.sdpMLineIndex=this.cache.mlB2UMap[g.sdpMLineIndex],g},E.prototype.candidateToPlanB=function(S){var g=new RTCIceCandidate(S);if(g.sdpMid.indexOf("audio")===0)g.sdpMid="audio";else if(g.sdpMid.indexOf("video")===0)g.sdpMid="video";else throw new Error("candidate with "+g.sdpMid+" not allowed");return g.sdpMLineIndex=this.cache.mlU2BMap[g.sdpMLineIndex],g},E.prototype.getFirstSendingIndexFromAnswer=function(S){if(!this.cache.answer)return null;var g=r.parse(this.cache.answer);if(g&&g.media&&Array.isArray(g.media)){for(var e=0;e<g.media.length;e++)if(g.media[e].type==S&&(!g.media[e].direction||g.media[e].direction==="sendrecv"||g.media[e].direction==="sendonly"))return e}return null},E.prototype.toPlanB=function(S){var g=this;if(typeof S!="object"||S===null||typeof S.sdp!="string")return console.warn("An empty description was passed as an argument."),S;var e=r.parse(S.sdp);if(typeof e.media>"u"||!Array.isArray(e.media)||e.media.length===0)return console.warn("The description has no media."),S;if(e.media.length<=3&&e.media.every(function(B){return["video","audio","data"].indexOf(B.mid)!==-1}))return console.warn("This description does not look like Unified Plan."),S;for(var f=S.sdp,p=!1,c=0;c<e.media.length;c++){var n=e.media[c];n.rtp.forEach(function(B){if(B.codec==="NULL"){p=!0;var _=r.parse(g.cache.offer);B.codec=_.media[c].rtp[0].codec}})}p&&(f=r.write(e)),this.cache[S.type]=f;var y=e.media;e.media=[];var A={},O=[],R={};y.forEach(function(B){if(v(B),(typeof B.rtcpMux!="string"||B.rtcpMux!=="rtcp-mux")&&B.direction!=="inactive"&&B.type!=="application")throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");(typeof A[B.type]>"u"||A[B.type].direction==="inactive")&&(A[B.type]=B)}),y.forEach(function(B){var _=B.type;if(_==="application"){B.mid="data",e.media.push(B),O.push(B.mid);return}typeof B.sources=="object"&&Object.keys(B.sources).forEach(function(x){typeof A[_].sources!="object"&&(A[_].sources={}),A[_].sources[x]=B.sources[x],typeof B.msid<"u"&&(A[_].sources[x].msid=B.msid)}),typeof B.ssrcGroups<"u"&&Array.isArray(B.ssrcGroups)&&((typeof A[_].ssrcGroups>"u"||!Array.isArray(A[_].ssrcGroups))&&(A[_].ssrcGroups=[]),h.apply(A[_].ssrcGroups,[B.ssrcGroups])||(A[_].ssrcGroups=A[_].ssrcGroups.concat(B.ssrcGroups)));var T=B.direction;R[_]=(R[_]||0)|k[T||"inactive"],A[_]===B&&(B.mid=_,delete B.bundleOnly,delete B.msid,T!=="inactive"&&O.push(_),e.media.push(B))}),e.groups.some(function(B){if(B.type==="BUNDLE")return B.mids=O.join(" "),!0}),e.msidSemantic={semantic:"WMS",token:"*"};var b=r.write(e);return new RTCSessionDescription({type:S.type,sdp:b})},E.prototype.toUnifiedPlan=function(S){var g=this;if(typeof S!="object"||S===null||typeof S.sdp!="string")return console.warn("An empty description was passed as an argument."),S;var e=r.parse(S.sdp);if(typeof e.media>"u"||!Array.isArray(e.media)||e.media.length===0)return console.warn("The description has no media."),S;if(e.media.length>3||!e.media.every(function(_){return["video","audio","data"].indexOf(_.mid)!==-1}))return console.warn("This description does not look like Plan B."),S;var f=[];e.media.forEach(function(_){f.push(_.mid)});var p=!1;if(typeof e.groups<"u"&&Array.isArray(e.groups)&&(p=e.groups.every(function(_){return _.type!=="BUNDLE"||h.apply(_.mids.sort(),[f.sort()])})),!p)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.");var c;typeof this.cache[S.type]<"u"&&(c=r.parse(this.cache[S.type]));var n={audio:{},video:{}},y={},A=0,O=0;if(e.media.forEach(function(_){if((typeof _.rtcpMux!="string"||_.rtcpMux!=="rtcp-mux")&&_.direction!=="inactive"&&_.type!=="application")throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if(_.type==="application"){var T=null;c&&c.media&&(T=c.media.find(function(q){return q.type==="application"})),T?y[T.mid]=T:y[_.mid]=_;return}var x=_.sources,N=_.ssrcGroups,P=_.candidates,F=_.iceUfrag,L=_.icePwd,z=_.fingerprint,H=_.port;delete _.sources,delete _.ssrcGroups,delete _.candidates,delete _.iceUfrag,delete _.icePwd,delete _.fingerprint,delete _.port,delete _.mid;var D={};typeof N<"u"&&Array.isArray(N)&&N.forEach(function(q){q.semantics!=="SIM"&&typeof q.ssrcs<"u"&&Array.isArray(q.ssrcs)&&q.ssrcs.forEach(function(J){typeof D[J]>"u"&&(D[J]=[]),D[J].push(q)})});var X={};typeof x=="object"&&Object.keys(x).forEach(function(q){var J;if(S.type==="offer"&&!x[q].msid){n[_.type][q]=x[q];return}if(typeof D[q]<"u"&&Array.isArray(D[q])&&D[q].some(function(de){return de.ssrcs.some(function(he){if(typeof X[he]=="object")return J=X[he],!0})}),typeof J=="object")J.sources[q]=x[q],delete x[q].msid;else{if(J=Object.create(_),X[q]=J,typeof x[q].msid<"u"&&(J.msid=x[q].msid,delete x[q].msid),J.sources={},J.sources[q]=x[q],J.ssrcGroups=D[q],typeof c<"u"&&typeof c.media<"u"&&Array.isArray(c.media)&&c.media.forEach(function(de){typeof de.sources=="object"&&Object.keys(de.sources).forEach(function(he){he===q&&(J.mid=de.mid)})}),v(J),typeof J.mid>"u"){if(S.type==="answer")throw new Error("An unmapped SSRC was found.");J.mid=[_.type,"-",q].join("")}J.candidates=P,J.iceUfrag=F,J.icePwd=L,J.fingerprint=z,J.port=H,y[J.mid]=J,g.cache.mlU2BMap[O]=A,typeof g.cache.mlB2UMap[A]>"u"&&(g.cache.mlB2UMap[A]=O),O++}}),A++}),e.media=[],f=[],S.type==="answer")for(var R=0;R<c.media.length;R++){var b=c.media[R];v(b),typeof y[b.mid]>"u"&&(delete b.msid,delete b.sources,delete b.ssrcGroups,!b.direction||b.direction==="sendrecv"?b.direction="recvonly":b.direction==="sendonly"&&(b.direction="inactive")),e.media.push(b),typeof b.mid=="string"&&f.push(b.mid)}else typeof c<"u"&&typeof c.media<"u"&&Array.isArray(c.media)&&c.media.forEach(function(_){v(_),f.push(_.mid),typeof y[_.mid]<"u"?e.media.push(y[_.mid]):(delete _.msid,delete _.sources,delete _.ssrcGroups,(!_.direction||_.direction==="sendrecv")&&(_.direction="recvonly"),(!_.direction||_.direction==="sendonly")&&(_.direction="inactive"),e.media.push(_))}),Object.keys(y).forEach(function(_){f.indexOf(_)===-1&&(f.push(_),y[_].direction==="recvonly"?e.media.some(function(T){if((T.direction==="sendrecv"||T.direction==="sendonly")&&T.type===y[_].type)return Object.keys(y[_].sources).forEach(function(x){T.sources[x]=y[_].sources[x]}),!0}):e.media.push(y[_]))});["audio","video"].forEach(function(_){if(!(!e||!e.media||!Array.isArray(e.media))){var T=null;if(Object.keys(n[_]).length>0&&(T=g.getFirstSendingIndexFromAnswer(_),T===null)){for(var x=0;x<e.media.length;x++)if(e.media[x].type===_){T=x;break}}if(T&&e.media.length>T){var N=e.media[T];Object.keys(n[_]).forEach(function(P){N.sources&&N.sources[P]&&console.warn("Replacing an existing SSRC."),N.sources||(N.sources={}),N.sources[P]=n[_][P]})}}}),e.groups.some(function(_){if(_.type==="BUNDLE")return _.mids=f.join(" "),!0}),e.msidSemantic={semantic:"WMS",token:"*"};var B=r.write(e);return this.cache[S.type]=B,new RTCSessionDescription({type:S.type,sdp:B})};var k={inactive:0,recvonly:1,sendonly:2,sendrecv:3}},"./node_modules/@jitsi/sdp-interop/lib/transform.js":function(i,s,d){var r=d("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/index.js");s.write=function(h,v){return typeof h<"u"&&typeof h.media<"u"&&Array.isArray(h.media)&&h.media.forEach(function(E){typeof E.sources<"u"&&Object.keys(E.sources).length!==0&&(E.ssrcs=[],Object.keys(E.sources).forEach(function(k){var S=E.sources[k];Object.keys(S).forEach(function(g){E.ssrcs.push({id:k,attribute:g,value:S[g]})})}),delete E.sources),typeof E.ssrcGroups<"u"&&Array.isArray(E.ssrcGroups)&&E.ssrcGroups.forEach(function(k){typeof k.ssrcs<"u"&&Array.isArray(k.ssrcs)&&(k.ssrcs=k.ssrcs.join(" "))})}),typeof h<"u"&&typeof h.groups<"u"&&Array.isArray(h.groups)&&h.groups.forEach(function(E){typeof E.mids<"u"&&Array.isArray(E.mids)&&(E.mids=E.mids.join(" "))}),r.write(h,v)},s.parse=function(h){var v=r.parse(h);return typeof v<"u"&&typeof v.media<"u"&&Array.isArray(v.media)&&v.media.forEach(function(E){typeof E.ssrcs<"u"&&Array.isArray(E.ssrcs)&&(E.sources={},E.ssrcs.forEach(function(k){E.sources[k.id]||(E.sources[k.id]={}),E.sources[k.id][k.attribute]=k.value}),delete E.ssrcs),typeof E.ssrcGroups<"u"&&Array.isArray(E.ssrcGroups)&&E.ssrcGroups.forEach(function(k){typeof k.ssrcs=="string"&&(k.ssrcs=k.ssrcs.split(" "))})}),typeof v<"u"&&typeof v.groups<"u"&&Array.isArray(v.groups)&&v.groups.forEach(function(E){typeof E.mids=="string"&&(E.mids=E.mids.split(" "))}),v}},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/grammar.js":function(i,s){var d=i.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(r){return r.encoding?"rtpmap:%d %s/%s/%s":r.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(r){return r.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(r){return r.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(r){return"extmap:%d"+(r.direction?"/%s":"%v")+" %s"+(r.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(r){return r.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(r){var h="candidate:%s %d %s %d %s %d typ %s";return h+=r.raddr!=null?" raddr %s rport %d":"%v%v",h+=r.tcptype!=null?" tcptype %s":"%v",r.generation!=null&&(h+=" generation %d"),h+=r["network-id"]!=null?" network-id %d":"%v",h+=r["network-cost"]!=null?" network-cost %d":"%v",h}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(r){var h="ssrc:%d";return r.attribute!=null&&(h+=" %s",r.value!=null&&(h+=":%s")),h}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(r){return r.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(r){return r.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(r){return"imageattr:%s %s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(r){return"simulcast:%s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(d).forEach(function(r){var h=d[r];h.forEach(function(v){v.reg||(v.reg=/(.*)/),v.format||(v.format="%s")})})},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/index.js":function(i,s,d){var r=d("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/parser.js"),h=d("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/writer.js");s.write=h,s.parse=r.parse,s.parseFmtpConfig=r.parseFmtpConfig,s.parseParams=r.parseParams,s.parsePayloads=r.parsePayloads,s.parseRemoteCandidates=r.parseRemoteCandidates,s.parseImageAttributes=r.parseImageAttributes,s.parseSimulcastStreamList=r.parseSimulcastStreamList},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/parser.js":function(i,s,d){var r=function(g){return String(Number(g))===g?Number(g):g},h=function(g,e,f,p){if(p&&!f)e[p]=r(g[1]);else for(var c=0;c<f.length;c+=1)g[c+1]!=null&&(e[f[c]]=r(g[c+1]))},v=function(g,e,f){var p=g.name&&g.names;g.push&&!e[g.push]?e[g.push]=[]:p&&!e[g.name]&&(e[g.name]={});var c=g.push?{}:p?e[g.name]:e;h(f.match(g.reg),c,g.names,g.name),g.push&&e[g.push].push(c)},E=d("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/grammar.js"),k=RegExp.prototype.test.bind(/^([a-z])=(.*)/);s.parse=function(g){var e={},f=[],p=e;return g.split(/(\r\n|\r|\n)/).filter(k).forEach(function(c){var n=c[0],y=c.slice(2);n==="m"&&(f.push({rtp:[],fmtp:[]}),p=f[f.length-1]);for(var A=0;A<(E[n]||[]).length;A+=1){var O=E[n][A];if(O.reg.test(y))return v(O,p,y)}}),e.media=f,e};var S=function(g,e){var f=e.split(/=(.+)/,2);return f.length===2&&(g[f[0]]=r(f[1])),g};s.parseParams=function(g){return g.split(/\;\s?/).reduce(S,{})},s.parseFmtpConfig=s.parseParams,s.parsePayloads=function(g){return g.split(" ").map(Number)},s.parseRemoteCandidates=function(g){for(var e=[],f=g.split(" ").map(r),p=0;p<f.length;p+=3)e.push({component:f[p],ip:f[p+1],port:f[p+2]});return e},s.parseImageAttributes=function(g){return g.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(S,{})})},s.parseSimulcastStreamList=function(g){return g.split(";").map(function(e){return e.split(",").map(function(f){var p,c=!1;return f[0]!=="~"?p=r(f):(p=r(f.substring(1,f.length)),c=!0),{scid:p,paused:c}})})}},"./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/writer.js":function(i,s,d){var r=d("./node_modules/@jitsi/sdp-interop/node_modules/sdp-transform/lib/grammar.js"),h=/%[sdv%]/g,v=function(g){var e=1,f=arguments,p=f.length;return g.replace(h,function(c){if(e>=p)return c;var n=f[e];switch(e+=1,c){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}})},E=function(g,e,f){var p=e.format instanceof Function?e.format(e.push?f:f[e.name]):e.format,c=[g+"="+p];if(e.names)for(var n=0;n<e.names.length;n+=1){var y=e.names[n];e.name?c.push(f[e.name][y]):c.push(f[e.names[n]])}else c.push(f[e.name]);return v.apply(null,c)},k=["v","o","s","i","u","e","p","c","b","t","r","z","a"],S=["i","c","b","a"];i.exports=function(g,e){e=e||{},g.version==null&&(g.version=0),g.name==null&&(g.name=" "),g.media.forEach(function(n){n.payloads==null&&(n.payloads="")});var f=e.outerOrder||k,p=e.innerOrder||S,c=[];return f.forEach(function(n){r[n].forEach(function(y){y.name in g&&g[y.name]!=null?c.push(E(n,y,g)):y.push in g&&g[y.push]!=null&&g[y.push].forEach(function(A){c.push(E(n,y,A))})})}),g.media.forEach(function(n){c.push(E("m",r.m[0],n)),p.forEach(function(y){r[y].forEach(function(A){A.name in n&&n[A.name]!=null?c.push(E(y,A,n)):A.push in n&&n[A.push]!=null&&n[A.push].forEach(function(O){c.push(E(y,A,O))})})})}),c.join(`\r
`)+`\r
`}},"./node_modules/after/index.js":function(i,s){i.exports=d;function d(h,v,E){var k=!1;return E=E||r,S.count=h,h===0?v():S;function S(g,e){if(S.count<=0)throw new Error("after called too many times");--S.count,g?(k=!0,v(g),v=E):S.count===0&&!k&&v(null,e)}}function r(){}},"./node_modules/arraybuffer.slice/index.js":function(i,s){i.exports=function(d,r,h){var v=d.byteLength;if(r=r||0,h=h||v,d.slice)return d.slice(r,h);if(r<0&&(r+=v),h<0&&(h+=v),h>v&&(h=v),r>=v||r>=h||v===0)return new ArrayBuffer(0);for(var E=new Uint8Array(d),k=new Uint8Array(h-r),S=r,g=0;S<h;S++,g++)k[g]=E[S];return k.buffer}},"./node_modules/backo2/index.js":function(i,s){i.exports=d;function d(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}d.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var h=Math.random(),v=Math.floor(h*this.jitter*r);r=(Math.floor(h*10)&1)==0?r-v:r+v}return Math.min(r,this.max)|0},d.prototype.reset=function(){this.attempts=0},d.prototype.setMin=function(r){this.ms=r},d.prototype.setMax=function(r){this.max=r},d.prototype.setJitter=function(r){this.jitter=r}},"./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(i,s){(function(d){s.encode=function(r){var h=new Uint8Array(r),v,E=h.length,k="";for(v=0;v<E;v+=3)k+=d[h[v]>>2],k+=d[(h[v]&3)<<4|h[v+1]>>4],k+=d[(h[v+1]&15)<<2|h[v+2]>>6],k+=d[h[v+2]&63];return E%3===2?k=k.substring(0,k.length-1)+"=":E%3===1&&(k=k.substring(0,k.length-2)+"=="),k},s.decode=function(r){var h=r.length*.75,v=r.length,E,k=0,S,g,e,f;r[r.length-1]==="="&&(h--,r[r.length-2]==="="&&h--);var p=new ArrayBuffer(h),c=new Uint8Array(p);for(E=0;E<v;E+=4)S=d.indexOf(r[E]),g=d.indexOf(r[E+1]),e=d.indexOf(r[E+2]),f=d.indexOf(r[E+3]),c[k++]=S<<2|g>>4,c[k++]=(g&15)<<4|e>>2,c[k++]=(e&3)<<6|f&63;return p}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},"./node_modules/base64-js/index.js":function(i,s,d){s.byteLength=e,s.toByteArray=p,s.fromByteArray=y;for(var r=[],h=[],v=typeof Uint8Array<"u"?Uint8Array:Array,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=0,S=E.length;k<S;++k)r[k]=E[k],h[E.charCodeAt(k)]=k;h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63;function g(A){var O=A.length;if(O%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var R=A.indexOf("=");R===-1&&(R=O);var b=R===O?0:4-R%4;return[R,b]}function e(A){var O=g(A),R=O[0],b=O[1];return(R+b)*3/4-b}function f(A,O,R){return(O+R)*3/4-R}function p(A){var O,R=g(A),b=R[0],B=R[1],_=new v(f(A,b,B)),T=0,x=B>0?b-4:b,N;for(N=0;N<x;N+=4)O=h[A.charCodeAt(N)]<<18|h[A.charCodeAt(N+1)]<<12|h[A.charCodeAt(N+2)]<<6|h[A.charCodeAt(N+3)],_[T++]=O>>16&255,_[T++]=O>>8&255,_[T++]=O&255;return B===2&&(O=h[A.charCodeAt(N)]<<2|h[A.charCodeAt(N+1)]>>4,_[T++]=O&255),B===1&&(O=h[A.charCodeAt(N)]<<10|h[A.charCodeAt(N+1)]<<4|h[A.charCodeAt(N+2)]>>2,_[T++]=O>>8&255,_[T++]=O&255),_}function c(A){return r[A>>18&63]+r[A>>12&63]+r[A>>6&63]+r[A&63]}function n(A,O,R){for(var b,B=[],_=O;_<R;_+=3)b=(A[_]<<16&16711680)+(A[_+1]<<8&65280)+(A[_+2]&255),B.push(c(b));return B.join("")}function y(A){for(var O,R=A.length,b=R%3,B=[],_=16383,T=0,x=R-b;T<x;T+=_)B.push(n(A,T,T+_>x?x:T+_));return b===1?(O=A[R-1],B.push(r[O>>2]+r[O<<4&63]+"==")):b===2&&(O=(A[R-2]<<8)+A[R-1],B.push(r[O>>10]+r[O>>4&63]+r[O<<2&63]+"=")),B.join("")}},"./node_modules/blob/index.js":function(i,s){var d=typeof d<"u"?d:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:!1,r=function(){try{var g=new Blob(["hi"]);return g.size===2}catch{return!1}}(),h=r&&function(){try{var g=new Blob([new Uint8Array([1,2])]);return g.size===2}catch{return!1}}(),v=d&&d.prototype.append&&d.prototype.getBlob;function E(g){return g.map(function(e){if(e.buffer instanceof ArrayBuffer){var f=e.buffer;if(e.byteLength!==f.byteLength){var p=new Uint8Array(e.byteLength);p.set(new Uint8Array(f,e.byteOffset,e.byteLength)),f=p.buffer}return f}return e})}function k(g,e){e=e||{};var f=new d;return E(g).forEach(function(p){f.append(p)}),e.type?f.getBlob(e.type):f.getBlob()}function S(g,e){return new Blob(E(g),e||{})}typeof Blob<"u"&&(k.prototype=Blob.prototype,S.prototype=Blob.prototype),i.exports=function(){return r?h?Blob:S:v?k:void 0}()},"./node_modules/component-bind/index.js":function(i,s){var d=[].slice;i.exports=function(r,h){if(typeof h=="string"&&(h=r[h]),typeof h!="function")throw new Error("bind() requires a function");var v=d.call(arguments,2);return function(){return h.apply(r,v.concat(d.call(arguments)))}}},"./node_modules/component-emitter/index.js":function(i,s,d){i.exports=r;function r(v){if(v)return h(v)}function h(v){for(var E in r.prototype)v[E]=r.prototype[E];return v}r.prototype.on=r.prototype.addEventListener=function(v,E){return this._callbacks=this._callbacks||{},(this._callbacks["$"+v]=this._callbacks["$"+v]||[]).push(E),this},r.prototype.once=function(v,E){function k(){this.off(v,k),E.apply(this,arguments)}return k.fn=E,this.on(v,k),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(v,E){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var k=this._callbacks["$"+v];if(!k)return this;if(arguments.length==1)return delete this._callbacks["$"+v],this;for(var S,g=0;g<k.length;g++)if(S=k[g],S===E||S.fn===E){k.splice(g,1);break}return k.length===0&&delete this._callbacks["$"+v],this},r.prototype.emit=function(v){this._callbacks=this._callbacks||{};for(var E=new Array(arguments.length-1),k=this._callbacks["$"+v],S=1;S<arguments.length;S++)E[S-1]=arguments[S];if(k){k=k.slice(0);for(var S=0,g=k.length;S<g;++S)k[S].apply(this,E)}return this},r.prototype.listeners=function(v){return this._callbacks=this._callbacks||{},this._callbacks["$"+v]||[]},r.prototype.hasListeners=function(v){return!!this.listeners(v).length}},"./node_modules/component-inherit/index.js":function(i,s){i.exports=function(d,r){var h=function(){};h.prototype=r.prototype,d.prototype=new h,d.prototype.constructor=d}},"./node_modules/debug/src/browser.js":function(i,s,d){(function(r){s=i.exports=d("./node_modules/debug/src/debug.js"),s.log=E,s.formatArgs=v,s.save=k,s.load=S,s.useColors=h,s.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:g(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function h(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}s.formatters.j=function(e){try{return JSON.stringify(e)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}};function v(e){var f=this.useColors;if(e[0]=(f?"%c":"")+this.namespace+(f?" %c":" ")+e[0]+(f?"%c ":" ")+"+"+s.humanize(this.diff),!!f){var p="color: "+this.color;e.splice(1,0,p,"color: inherit");var c=0,n=0;e[0].replace(/%[a-zA-Z%]/g,function(y){y!=="%%"&&(c++,y==="%c"&&(n=c))}),e.splice(n,0,p)}}function E(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function k(e){try{e==null?s.storage.removeItem("debug"):s.storage.debug=e}catch{}}function S(){var e;try{e=s.storage.debug}catch{}return!e&&typeof r<"u"&&"env"in r&&(e=r.env.DEBUG),e}s.enable(S());function g(){try{return window.localStorage}catch{}}}).call(this,d("./node_modules/process/browser.js"))},"./node_modules/debug/src/debug.js":function(i,s,d){s=i.exports=h.debug=h.default=h,s.coerce=g,s.disable=k,s.enable=E,s.enabled=S,s.humanize=d("./node_modules/ms/index.js"),s.instances=[],s.names=[],s.skips=[],s.formatters={};function r(e){var f=0,p;for(p in e)f=(f<<5)-f+e.charCodeAt(p),f|=0;return s.colors[Math.abs(f)%s.colors.length]}function h(e){var f;function p(){if(!!p.enabled){var c=p,n=+new Date,y=n-(f||n);c.diff=y,c.prev=f,c.curr=n,f=n;for(var A=new Array(arguments.length),O=0;O<A.length;O++)A[O]=arguments[O];A[0]=s.coerce(A[0]),typeof A[0]!="string"&&A.unshift("%O");var R=0;A[0]=A[0].replace(/%([a-zA-Z%])/g,function(B,_){if(B==="%%")return B;R++;var T=s.formatters[_];if(typeof T=="function"){var x=A[R];B=T.call(c,x),A.splice(R,1),R--}return B}),s.formatArgs.call(c,A);var b=p.log||s.log||console.log.bind(console);b.apply(c,A)}}return p.namespace=e,p.enabled=s.enabled(e),p.useColors=s.useColors(),p.color=r(e),p.destroy=v,typeof s.init=="function"&&s.init(p),s.instances.push(p),p}function v(){var e=s.instances.indexOf(this);return e!==-1?(s.instances.splice(e,1),!0):!1}function E(e){s.save(e),s.names=[],s.skips=[];var f,p=(typeof e=="string"?e:"").split(/[\s,]+/),c=p.length;for(f=0;f<c;f++)!p[f]||(e=p[f].replace(/\*/g,".*?"),e[0]==="-"?s.skips.push(new RegExp("^"+e.substr(1)+"$")):s.names.push(new RegExp("^"+e+"$")));for(f=0;f<s.instances.length;f++){var n=s.instances[f];n.enabled=s.enabled(n.namespace)}}function k(){s.enable("")}function S(e){if(e[e.length-1]==="*")return!0;var f,p;for(f=0,p=s.skips.length;f<p;f++)if(s.skips[f].test(e))return!1;for(f=0,p=s.names.length;f<p;f++)if(s.names[f].test(e))return!0;return!1}function g(e){return e instanceof Error?e.stack||e.message:e}},"./node_modules/decode-uri-component/index.js":function(i,s,d){var r="%[a-f0-9]{2}",h=new RegExp(r,"gi"),v=new RegExp("("+r+")+","gi");function E(g,e){try{return decodeURIComponent(g.join(""))}catch{}if(g.length===1)return g;e=e||1;var f=g.slice(0,e),p=g.slice(e);return Array.prototype.concat.call([],E(f),E(p))}function k(g){try{return decodeURIComponent(g)}catch{for(var e=g.match(h),f=1;f<e.length;f++)g=E(e,f).join(""),e=g.match(h);return g}}function S(g){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},f=v.exec(g);f;){try{e[f[0]]=decodeURIComponent(f[0])}catch{var p=k(f[0]);p!==f[0]&&(e[f[0]]=p)}f=v.exec(g)}e["%C2"]="\uFFFD";for(var c=Object.keys(e),n=0;n<c.length;n++){var y=c[n];g=g.replace(new RegExp(y,"g"),e[y])}return g}i.exports=function(g){if(typeof g!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof g+"`");try{return g=g.replace(/\+/g," "),decodeURIComponent(g)}catch{return S(g)}}},"./node_modules/detect-browser/index.js":function(i,s,d){(function(r){var h=this&&this.__spreadArrays||function(){for(var R=0,b=0,B=arguments.length;b<B;b++)R+=arguments[b].length;for(var _=Array(R),T=0,b=0;b<B;b++)for(var x=arguments[b],N=0,P=x.length;N<P;N++,T++)_[T]=x[N];return _};Object.defineProperty(s,"__esModule",{value:!0});var v=function(){function R(b,B,_){this.name=b,this.version=B,this.os=_}return R}();s.BrowserInfo=v;var E=function(){function R(b){this.version=b,this.name="node",this.os=r.platform}return R}();s.NodeInfo=E;var k=function(){function R(){this.bot=!0,this.name="bot",this.version=null,this.os=null}return R}();s.BotInfo=k;var S=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,g=/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/,e=3,f=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",S]],p=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",g]];function c(R){return R?n(R):typeof navigator<"u"?n(navigator.userAgent):A()}s.detect=c;function n(R){var b=R!==""&&f.reduce(function(x,N){var P=N[0],F=N[1];if(x)return x;var L=F.exec(R);return!!L&&[P,L]},!1);if(!b)return null;var B=b[0],_=b[1];if(B==="searchbot")return new k;var T=_[1]&&_[1].split(/[._]/).slice(0,3);return T?T.length<e&&(T=h(T,O(e-T.length))):T=[],new v(B,T.join("."),y(R))}s.parseUserAgent=n;function y(R){for(var b=0,B=p.length;b<B;b++){var _=p[b],T=_[0],x=_[1],N=x.test(R);if(N)return T}return null}s.detectOS=y;function A(){var R=typeof r<"u"&&r.version;return R?new E(r.version.slice(1)):null}s.getNodeVersion=A;function O(R){for(var b=[],B=0;B<R;B++)b.push("0");return b}}).call(this,d("./node_modules/process/browser.js"))},"./node_modules/engine.io-client/lib/globalThis.browser.js":function(i,s){i.exports=function(){return typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}()},"./node_modules/engine.io-client/lib/index.js":function(i,s,d){i.exports=d("./node_modules/engine.io-client/lib/socket.js"),i.exports.parser=d("./node_modules/engine.io-parser/lib/browser.js")},"./node_modules/engine.io-client/lib/socket.js":function(i,s,d){var r=d("./node_modules/engine.io-client/lib/transports/index.js"),h=d("./node_modules/component-emitter/index.js"),v=d("./node_modules/debug/src/browser.js")("engine.io-client:socket"),E=d("./node_modules/indexof/index.js"),k=d("./node_modules/engine.io-parser/lib/browser.js"),S=d("./node_modules/parseuri/index.js"),g=d("./node_modules/parseqs/index.js");i.exports=e;function e(p,c){if(!(this instanceof e))return new e(p,c);c=c||{},p&&typeof p=="object"&&(c=p,p=null),p?(p=S(p),c.hostname=p.host,c.secure=p.protocol==="https"||p.protocol==="wss",c.port=p.port,p.query&&(c.query=p.query)):c.host&&(c.hostname=S(c.host).host),this.secure=c.secure!=null?c.secure:typeof location<"u"&&location.protocol==="https:",c.hostname&&!c.port&&(c.port=this.secure?"443":"80"),this.agent=c.agent||!1,this.hostname=c.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=c.port||(typeof location<"u"&&location.port?location.port:this.secure?443:80),this.query=c.query||{},typeof this.query=="string"&&(this.query=g.decode(this.query)),this.upgrade=c.upgrade!==!1,this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!c.forceJSONP,this.jsonp=c.jsonp!==!1,this.forceBase64=!!c.forceBase64,this.enablesXDR=!!c.enablesXDR,this.withCredentials=c.withCredentials!==!1,this.timestampParam=c.timestampParam||"t",this.timestampRequests=c.timestampRequests,this.transports=c.transports||["polling","websocket"],this.transportOptions=c.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=c.policyPort||843,this.rememberUpgrade=c.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=c.onlyBinaryUpgrades,this.perMessageDeflate=c.perMessageDeflate!==!1?c.perMessageDeflate||{}:!1,this.perMessageDeflate===!0&&(this.perMessageDeflate={}),this.perMessageDeflate&&this.perMessageDeflate.threshold==null&&(this.perMessageDeflate.threshold=1024),this.pfx=c.pfx||void 0,this.key=c.key||void 0,this.passphrase=c.passphrase||void 0,this.cert=c.cert||void 0,this.ca=c.ca||void 0,this.ciphers=c.ciphers||void 0,this.rejectUnauthorized=c.rejectUnauthorized===void 0?!0:c.rejectUnauthorized,this.forceNode=!!c.forceNode,this.isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",(typeof self>"u"||this.isReactNative)&&(c.extraHeaders&&Object.keys(c.extraHeaders).length>0&&(this.extraHeaders=c.extraHeaders),c.localAddress&&(this.localAddress=c.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.priorWebsocketSuccess=!1,h(e.prototype),e.protocol=k.protocol,e.Socket=e,e.Transport=d("./node_modules/engine.io-client/lib/transport.js"),e.transports=d("./node_modules/engine.io-client/lib/transports/index.js"),e.parser=d("./node_modules/engine.io-parser/lib/browser.js"),e.prototype.createTransport=function(p){v('creating transport "%s"',p);var c=f(this.query);c.EIO=k.protocol,c.transport=p;var n=this.transportOptions[p]||{};this.id&&(c.sid=this.id);var y=new r[p]({query:c,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative});return y};function f(p){var c={};for(var n in p)p.hasOwnProperty(n)&&(c[n]=p[n]);return c}e.prototype.open=function(){var p;if(this.rememberUpgrade&&e.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)p="websocket";else if(this.transports.length===0){var c=this;setTimeout(function(){c.emit("error","No transports available")},0);return}else p=this.transports[0];this.readyState="opening";try{p=this.createTransport(p)}catch{this.transports.shift(),this.open();return}p.open(),this.setTransport(p)},e.prototype.setTransport=function(p){v("setting transport %s",p.name);var c=this;this.transport&&(v("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=p,p.on("drain",function(){c.onDrain()}).on("packet",function(n){c.onPacket(n)}).on("error",function(n){c.onError(n)}).on("close",function(){c.onClose("transport close")})},e.prototype.probe=function(p){v('probing transport "%s"',p);var c=this.createTransport(p,{probe:1}),n=!1,y=this;e.priorWebsocketSuccess=!1;function A(){if(y.onlyBinaryUpgrades){var x=!this.supportsBinary&&y.transport.supportsBinary;n=n||x}n||(v('probe transport "%s" opened',p),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(N){if(!n)if(N.type==="pong"&&N.data==="probe"){if(v('probe transport "%s" pong',p),y.upgrading=!0,y.emit("upgrading",c),!c)return;e.priorWebsocketSuccess=c.name==="websocket",v('pausing current transport "%s"',y.transport.name),y.transport.pause(function(){n||y.readyState!=="closed"&&(v("changing transport and sending upgrade packet"),T(),y.setTransport(c),c.send([{type:"upgrade"}]),y.emit("upgrade",c),c=null,y.upgrading=!1,y.flush())})}else{v('probe transport "%s" failed',p);var P=new Error("probe error");P.transport=c.name,y.emit("upgradeError",P)}}))}function O(){n||(n=!0,T(),c.close(),c=null)}function R(x){var N=new Error("probe error: "+x);N.transport=c.name,O(),v('probe transport "%s" failed because of error: %s',p,x),y.emit("upgradeError",N)}function b(){R("transport closed")}function B(){R("socket closed")}function _(x){c&&x.name!==c.name&&(v('"%s" works - aborting "%s"',x.name,c.name),O())}function T(){c.removeListener("open",A),c.removeListener("error",R),c.removeListener("close",b),y.removeListener("close",B),y.removeListener("upgrading",_)}c.once("open",A),c.once("error",R),c.once("close",b),this.once("close",B),this.once("upgrading",_),c.open()},e.prototype.onOpen=function(){if(v("socket open"),this.readyState="open",e.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.upgrade&&this.transport.pause){v("starting upgrade probes");for(var p=0,c=this.upgrades.length;p<c;p++)this.probe(this.upgrades[p])}},e.prototype.onPacket=function(p){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(v('socket receive: type "%s", data "%s"',p.type,p.data),this.emit("packet",p),this.emit("heartbeat"),p.type){case"open":this.onHandshake(JSON.parse(p.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var c=new Error("server error");c.code=p.data,this.onError(c);break;case"message":this.emit("data",p.data),this.emit("message",p.data);break}else v('packet received with socket readyState "%s"',this.readyState)},e.prototype.onHandshake=function(p){this.emit("handshake",p),this.id=p.sid,this.transport.query.sid=p.sid,this.upgrades=this.filterUpgrades(p.upgrades),this.pingInterval=p.pingInterval,this.pingTimeout=p.pingTimeout,this.onOpen(),this.readyState!=="closed"&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},e.prototype.onHeartbeat=function(p){clearTimeout(this.pingTimeoutTimer);var c=this;c.pingTimeoutTimer=setTimeout(function(){c.readyState!=="closed"&&c.onClose("ping timeout")},p||c.pingInterval+c.pingTimeout)},e.prototype.setPing=function(){var p=this;clearTimeout(p.pingIntervalTimer),p.pingIntervalTimer=setTimeout(function(){v("writing ping packet - expecting pong within %sms",p.pingTimeout),p.ping(),p.onHeartbeat(p.pingTimeout)},p.pingInterval)},e.prototype.ping=function(){var p=this;this.sendPacket("ping",function(){p.emit("ping")})},e.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()},e.prototype.flush=function(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(v("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},e.prototype.write=e.prototype.send=function(p,c,n){return this.sendPacket("message",p,c,n),this},e.prototype.sendPacket=function(p,c,n,y){if(typeof c=="function"&&(y=c,c=void 0),typeof n=="function"&&(y=n,n=null),!(this.readyState==="closing"||this.readyState==="closed")){n=n||{},n.compress=n.compress!==!1;var A={type:p,data:c,options:n};this.emit("packetCreate",A),this.writeBuffer.push(A),y&&this.once("flush",y),this.flush()}},e.prototype.close=function(){if(this.readyState==="opening"||this.readyState==="open"){this.readyState="closing";var p=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?y():c()}):this.upgrading?y():c()}function c(){p.onClose("forced close"),v("socket closing - telling transport to close"),p.transport.close()}function n(){p.removeListener("upgrade",n),p.removeListener("upgradeError",n),c()}function y(){p.once("upgrade",n),p.once("upgradeError",n)}return this},e.prototype.onError=function(p){v("socket error %j",p),e.priorWebsocketSuccess=!1,this.emit("error",p),this.onClose("transport error",p)},e.prototype.onClose=function(p,c){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){v('socket close with reason: "%s"',p);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",p,c),n.writeBuffer=[],n.prevBufferLen=0}},e.prototype.filterUpgrades=function(p){for(var c=[],n=0,y=p.length;n<y;n++)~E(this.transports,p[n])&&c.push(p[n]);return c}},"./node_modules/engine.io-client/lib/transport.js":function(i,s,d){var r=d("./node_modules/engine.io-parser/lib/browser.js"),h=d("./node_modules/component-emitter/index.js");i.exports=v;function v(E){this.path=E.path,this.hostname=E.hostname,this.port=E.port,this.secure=E.secure,this.query=E.query,this.timestampParam=E.timestampParam,this.timestampRequests=E.timestampRequests,this.readyState="",this.agent=E.agent||!1,this.socket=E.socket,this.enablesXDR=E.enablesXDR,this.withCredentials=E.withCredentials,this.pfx=E.pfx,this.key=E.key,this.passphrase=E.passphrase,this.cert=E.cert,this.ca=E.ca,this.ciphers=E.ciphers,this.rejectUnauthorized=E.rejectUnauthorized,this.forceNode=E.forceNode,this.isReactNative=E.isReactNative,this.extraHeaders=E.extraHeaders,this.localAddress=E.localAddress}h(v.prototype),v.prototype.onError=function(E,k){var S=new Error(E);return S.type="TransportError",S.description=k,this.emit("error",S),this},v.prototype.open=function(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this},v.prototype.close=function(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this},v.prototype.send=function(E){if(this.readyState==="open")this.write(E);else throw new Error("Transport not open")},v.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},v.prototype.onData=function(E){var k=r.decodePacket(E,this.socket.binaryType);this.onPacket(k)},v.prototype.onPacket=function(E){this.emit("packet",E)},v.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},"./node_modules/engine.io-client/lib/transports/index.js":function(i,s,d){var r=d("./node_modules/engine.io-client/lib/xmlhttprequest.js"),h=d("./node_modules/engine.io-client/lib/transports/polling-xhr.js"),v=d("./node_modules/engine.io-client/lib/transports/polling-jsonp.js"),E=d("./node_modules/engine.io-client/lib/transports/websocket.js");s.polling=k,s.websocket=E;function k(S){var g,e=!1,f=!1,p=S.jsonp!==!1;if(typeof location<"u"){var c=location.protocol==="https:",n=location.port;n||(n=c?443:80),e=S.hostname!==location.hostname||n!==S.port,f=S.secure!==c}if(S.xdomain=e,S.xscheme=f,g=new r(S),"open"in g&&!S.forceJSONP)return new h(S);if(!p)throw new Error("JSONP disabled");return new v(S)}},"./node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(i,s,d){var r=d("./node_modules/engine.io-client/lib/transports/polling.js"),h=d("./node_modules/component-inherit/index.js"),v=d("./node_modules/engine.io-client/lib/globalThis.browser.js");i.exports=e;var E=/\n/g,k=/\\n/g,S;function g(){}function e(f){r.call(this,f),this.query=this.query||{},S||(S=v.___eio=v.___eio||[]),this.index=S.length;var p=this;S.push(function(c){p.onData(c)}),this.query.j=this.index,typeof addEventListener=="function"&&addEventListener("beforeunload",function(){p.script&&(p.script.onerror=g)},!1)}h(e,r),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},e.prototype.doPoll=function(){var f=this,p=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),p.async=!0,p.src=this.uri(),p.onerror=function(y){f.onError("jsonp poll error",y)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(p,c):(document.head||document.body).appendChild(p),this.script=p;var n=typeof navigator<"u"&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var y=document.createElement("iframe");document.body.appendChild(y),document.body.removeChild(y)},100)},e.prototype.doWrite=function(f,p){var c=this;if(!this.form){var n=document.createElement("form"),y=document.createElement("textarea"),A=this.iframeId="eio_iframe_"+this.index,O;n.className="socketio",n.style.position="absolute",n.style.top="-1000px",n.style.left="-1000px",n.target=A,n.method="POST",n.setAttribute("accept-charset","utf-8"),y.name="d",n.appendChild(y),document.body.appendChild(n),this.form=n,this.area=y}this.form.action=this.uri();function R(){b(),p()}function b(){if(c.iframe)try{c.form.removeChild(c.iframe)}catch(_){c.onError("jsonp polling iframe removal error",_)}try{var B='<iframe src="javascript:0" name="'+c.iframeId+'">';O=document.createElement(B)}catch{O=document.createElement("iframe"),O.name=c.iframeId,O.src="javascript:0"}O.id=c.iframeId,c.form.appendChild(O),c.iframe=O}b(),f=f.replace(k,`\\
`),this.area.value=f.replace(E,"\\n");try{this.form.submit()}catch{}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){c.iframe.readyState==="complete"&&R()}:this.iframe.onload=R}},"./node_modules/engine.io-client/lib/transports/polling-xhr.js":function(i,s,d){var r=d("./node_modules/engine.io-client/lib/xmlhttprequest.js"),h=d("./node_modules/engine.io-client/lib/transports/polling.js"),v=d("./node_modules/component-emitter/index.js"),E=d("./node_modules/component-inherit/index.js"),k=d("./node_modules/debug/src/browser.js")("engine.io-client:polling-xhr"),S=d("./node_modules/engine.io-client/lib/globalThis.browser.js");i.exports=e,i.exports.Request=f;function g(){}function e(n){if(h.call(this,n),this.requestTimeout=n.requestTimeout,this.extraHeaders=n.extraHeaders,typeof location<"u"){var y=location.protocol==="https:",A=location.port;A||(A=y?443:80),this.xd=typeof location<"u"&&n.hostname!==location.hostname||A!==n.port,this.xs=n.secure!==y}}E(e,h),e.prototype.supportsBinary=!0,e.prototype.request=function(n){return n=n||{},n.uri=this.uri(),n.xd=this.xd,n.xs=this.xs,n.agent=this.agent||!1,n.supportsBinary=this.supportsBinary,n.enablesXDR=this.enablesXDR,n.withCredentials=this.withCredentials,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,n.requestTimeout=this.requestTimeout,n.extraHeaders=this.extraHeaders,new f(n)},e.prototype.doWrite=function(n,y){var A=typeof n!="string"&&n!==void 0,O=this.request({method:"POST",data:n,isBinary:A}),R=this;O.on("success",y),O.on("error",function(b){R.onError("xhr post error",b)}),this.sendXhr=O},e.prototype.doPoll=function(){k("xhr poll");var n=this.request(),y=this;n.on("data",function(A){y.onData(A)}),n.on("error",function(A){y.onError("xhr poll error",A)}),this.pollXhr=n};function f(n){this.method=n.method||"GET",this.uri=n.uri,this.xd=!!n.xd,this.xs=!!n.xs,this.async=n.async!==!1,this.data=n.data!==void 0?n.data:null,this.agent=n.agent,this.isBinary=n.isBinary,this.supportsBinary=n.supportsBinary,this.enablesXDR=n.enablesXDR,this.withCredentials=n.withCredentials,this.requestTimeout=n.requestTimeout,this.pfx=n.pfx,this.key=n.key,this.passphrase=n.passphrase,this.cert=n.cert,this.ca=n.ca,this.ciphers=n.ciphers,this.rejectUnauthorized=n.rejectUnauthorized,this.extraHeaders=n.extraHeaders,this.create()}if(v(f.prototype),f.prototype.create=function(){var n={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized;var y=this.xhr=new r(n),A=this;try{k("xhr open %s: %s",this.method,this.uri),y.open(this.method,this.uri,this.async);try{if(this.extraHeaders){y.setDisableHeaderCheck&&y.setDisableHeaderCheck(!0);for(var O in this.extraHeaders)this.extraHeaders.hasOwnProperty(O)&&y.setRequestHeader(O,this.extraHeaders[O])}}catch{}if(this.method==="POST")try{this.isBinary?y.setRequestHeader("Content-type","application/octet-stream"):y.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{y.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in y&&(y.withCredentials=this.withCredentials),this.requestTimeout&&(y.timeout=this.requestTimeout),this.hasXDR()?(y.onload=function(){A.onLoad()},y.onerror=function(){A.onError(y.responseText)}):y.onreadystatechange=function(){if(y.readyState===2)try{var R=y.getResponseHeader("Content-Type");(A.supportsBinary&&R==="application/octet-stream"||R==="application/octet-stream; charset=UTF-8")&&(y.responseType="arraybuffer")}catch{}y.readyState===4&&(y.status===200||y.status===1223?A.onLoad():setTimeout(function(){A.onError(typeof y.status=="number"?y.status:0)},0))},k("xhr data %s",this.data),y.send(this.data)}catch(R){setTimeout(function(){A.onError(R)},0);return}typeof document<"u"&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(n){this.emit("data",n),this.onSuccess()},f.prototype.onError=function(n){this.emit("error",n),this.cleanup(!0)},f.prototype.cleanup=function(n){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=g:this.xhr.onreadystatechange=g,n)try{this.xhr.abort()}catch{}typeof document<"u"&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var n;try{var y;try{y=this.xhr.getResponseHeader("Content-Type")}catch{}y==="application/octet-stream"||y==="application/octet-stream; charset=UTF-8"?n=this.xhr.response||this.xhr.responseText:n=this.xhr.responseText}catch(A){this.onError(A)}n!=null&&this.onData(n)},f.prototype.hasXDR=function(){return typeof XDomainRequest<"u"&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},f.requestsCount=0,f.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",c);else if(typeof addEventListener=="function"){var p="onpagehide"in S?"pagehide":"unload";addEventListener(p,c,!1)}}function c(){for(var n in f.requests)f.requests.hasOwnProperty(n)&&f.requests[n].abort()}},"./node_modules/engine.io-client/lib/transports/polling.js":function(i,s,d){var r=d("./node_modules/engine.io-client/lib/transport.js"),h=d("./node_modules/parseqs/index.js"),v=d("./node_modules/engine.io-parser/lib/browser.js"),E=d("./node_modules/component-inherit/index.js"),k=d("./node_modules/yeast/index.js"),S=d("./node_modules/debug/src/browser.js")("engine.io-client:polling");i.exports=e;var g=function(){var f=d("./node_modules/engine.io-client/lib/xmlhttprequest.js"),p=new f({xdomain:!1});return p.responseType!=null}();function e(f){var p=f&&f.forceBase64;(!g||p)&&(this.supportsBinary=!1),r.call(this,f)}E(e,r),e.prototype.name="polling",e.prototype.doOpen=function(){this.poll()},e.prototype.pause=function(f){var p=this;this.readyState="pausing";function c(){S("paused"),p.readyState="paused",f()}if(this.polling||!this.writable){var n=0;this.polling&&(S("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){S("pre-pause polling complete"),--n||c()})),this.writable||(S("we are currently writing - waiting to pause"),n++,this.once("drain",function(){S("pre-pause writing complete"),--n||c()}))}else c()},e.prototype.poll=function(){S("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},e.prototype.onData=function(f){var p=this;S("polling got data %s",f);var c=function(n,y,A){if(p.readyState==="opening"&&n.type==="open"&&p.onOpen(),n.type==="close")return p.onClose(),!1;p.onPacket(n)};v.decodePayload(f,this.socket.binaryType,c),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():S('ignoring poll - transport state "%s"',this.readyState))},e.prototype.doClose=function(){var f=this;function p(){S("writing close packet"),f.write([{type:"close"}])}this.readyState==="open"?(S("transport open - closing"),p()):(S("transport not open - deferring close"),this.once("open",p))},e.prototype.write=function(f){var p=this;this.writable=!1;var c=function(){p.writable=!0,p.emit("drain")};v.encodePayload(f,this.supportsBinary,function(n){p.doWrite(n,c)})},e.prototype.uri=function(){var f=this.query||{},p=this.secure?"https":"http",c="";this.timestampRequests!==!1&&(f[this.timestampParam]=k()),!this.supportsBinary&&!f.sid&&(f.b64=1),f=h.encode(f),this.port&&(p==="https"&&Number(this.port)!==443||p==="http"&&Number(this.port)!==80)&&(c=":"+this.port),f.length&&(f="?"+f);var n=this.hostname.indexOf(":")!==-1;return p+"://"+(n?"["+this.hostname+"]":this.hostname)+c+this.path+f}},"./node_modules/engine.io-client/lib/transports/websocket.js":function(i,s,d){(function(r){var h=d("./node_modules/engine.io-client/lib/transport.js"),v=d("./node_modules/engine.io-parser/lib/browser.js"),E=d("./node_modules/parseqs/index.js"),k=d("./node_modules/component-inherit/index.js"),S=d("./node_modules/yeast/index.js"),g=d("./node_modules/debug/src/browser.js")("engine.io-client:websocket"),e,f;if(typeof WebSocket<"u"?e=WebSocket:typeof self<"u"&&(e=self.WebSocket||self.MozWebSocket),typeof window>"u")try{f=d(0)}catch{}var p=e||f;i.exports=c;function c(n){var y=n&&n.forceBase64;y&&(this.supportsBinary=!1),this.perMessageDeflate=n.perMessageDeflate,this.usingBrowserWebSocket=e&&!n.forceNode,this.protocols=n.protocols,this.usingBrowserWebSocket||(p=f),h.call(this,n)}k(c,h),c.prototype.name="websocket",c.prototype.supportsBinary=!0,c.prototype.doOpen=function(){if(!!this.check()){var n=this.uri(),y=this.protocols,A={};this.isReactNative||(A.agent=this.agent,A.perMessageDeflate=this.perMessageDeflate,A.pfx=this.pfx,A.key=this.key,A.passphrase=this.passphrase,A.cert=this.cert,A.ca=this.ca,A.ciphers=this.ciphers,A.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(A.headers=this.extraHeaders),this.localAddress&&(A.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?y?new p(n,y):new p(n):new p(n,y,A)}catch(O){return this.emit("error",O)}this.ws.binaryType===void 0&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},c.prototype.addEventListeners=function(){var n=this;this.ws.onopen=function(){n.onOpen()},this.ws.onclose=function(){n.onClose()},this.ws.onmessage=function(y){n.onData(y.data)},this.ws.onerror=function(y){n.onError("websocket error",y)}},c.prototype.write=function(n){var y=this;this.writable=!1;for(var A=n.length,O=0,R=A;O<R;O++)(function(B){v.encodePacket(B,y.supportsBinary,function(_){if(!y.usingBrowserWebSocket){var T={};if(B.options&&(T.compress=B.options.compress),y.perMessageDeflate){var x=typeof _=="string"?r.byteLength(_):_.length;x<y.perMessageDeflate.threshold&&(T.compress=!1)}}try{y.usingBrowserWebSocket?y.ws.send(_):y.ws.send(_,T)}catch{g("websocket closed before onclose event")}--A||b()})})(n[O]);function b(){y.emit("flush"),setTimeout(function(){y.writable=!0,y.emit("drain")},0)}},c.prototype.onClose=function(){h.prototype.onClose.call(this)},c.prototype.doClose=function(){typeof this.ws<"u"&&this.ws.close()},c.prototype.uri=function(){var n=this.query||{},y=this.secure?"wss":"ws",A="";this.port&&(y==="wss"&&Number(this.port)!==443||y==="ws"&&Number(this.port)!==80)&&(A=":"+this.port),this.timestampRequests&&(n[this.timestampParam]=S()),this.supportsBinary||(n.b64=1),n=E.encode(n),n.length&&(n="?"+n);var O=this.hostname.indexOf(":")!==-1;return y+"://"+(O?"["+this.hostname+"]":this.hostname)+A+this.path+n},c.prototype.check=function(){return!!p&&!("__initialize"in p&&this.name===c.prototype.name)}}).call(this,d("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/engine.io-client/lib/xmlhttprequest.js":function(i,s,d){var r=d("./node_modules/has-cors/index.js"),h=d("./node_modules/engine.io-client/lib/globalThis.browser.js");i.exports=function(v){var E=v.xdomain,k=v.xscheme,S=v.enablesXDR;try{if(typeof XMLHttpRequest<"u"&&(!E||r))return new XMLHttpRequest}catch{}try{if(typeof XDomainRequest<"u"&&!k&&S)return new XDomainRequest}catch{}if(!E)try{return new h[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}},"./node_modules/engine.io-parser/lib/browser.js":function(i,s,d){var r=d("./node_modules/engine.io-parser/lib/keys.js"),h=d("./node_modules/has-binary2/index.js"),v=d("./node_modules/arraybuffer.slice/index.js"),E=d("./node_modules/after/index.js"),k=d("./node_modules/engine.io-parser/lib/utf8.js"),S;typeof ArrayBuffer<"u"&&(S=d("./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var g=typeof navigator<"u"&&/Android/i.test(navigator.userAgent),e=typeof navigator<"u"&&/PhantomJS/i.test(navigator.userAgent),f=g||e;s.protocol=3;var p=s.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},c=r(p),n={type:"error",data:"parser error"},y=d("./node_modules/blob/index.js");s.encodePacket=function(T,x,N,P){typeof x=="function"&&(P=x,x=!1),typeof N=="function"&&(P=N,N=null);var F=T.data===void 0?void 0:T.data.buffer||T.data;if(typeof ArrayBuffer<"u"&&F instanceof ArrayBuffer)return O(T,x,P);if(typeof y<"u"&&F instanceof y)return b(T,x,P);if(F&&F.base64)return A(T,P);var L=p[T.type];return T.data!==void 0&&(L+=N?k.encode(String(T.data),{strict:!1}):String(T.data)),P(""+L)};function A(T,x){var N="b"+s.packets[T.type]+T.data.data;return x(N)}function O(T,x,N){if(!x)return s.encodeBase64Packet(T,N);var P=T.data,F=new Uint8Array(P),L=new Uint8Array(1+P.byteLength);L[0]=p[T.type];for(var z=0;z<F.length;z++)L[z+1]=F[z];return N(L.buffer)}function R(T,x,N){if(!x)return s.encodeBase64Packet(T,N);var P=new FileReader;return P.onload=function(){s.encodePacket({type:T.type,data:P.result},x,!0,N)},P.readAsArrayBuffer(T.data)}function b(T,x,N){if(!x)return s.encodeBase64Packet(T,N);if(f)return R(T,x,N);var P=new Uint8Array(1);P[0]=p[T.type];var F=new y([P.buffer,T.data]);return N(F)}s.encodeBase64Packet=function(T,x){var N="b"+s.packets[T.type];if(typeof y<"u"&&T.data instanceof y){var P=new FileReader;return P.onload=function(){var D=P.result.split(",")[1];x(N+D)},P.readAsDataURL(T.data)}var F;try{F=String.fromCharCode.apply(null,new Uint8Array(T.data))}catch{for(var L=new Uint8Array(T.data),z=new Array(L.length),H=0;H<L.length;H++)z[H]=L[H];F=String.fromCharCode.apply(null,z)}return N+=btoa(F),x(N)},s.decodePacket=function(T,x,N){if(T===void 0)return n;if(typeof T=="string"){if(T.charAt(0)==="b")return s.decodeBase64Packet(T.substr(1),x);if(N&&(T=B(T),T===!1))return n;var F=T.charAt(0);return Number(F)!=F||!c[F]?n:T.length>1?{type:c[F],data:T.substring(1)}:{type:c[F]}}var P=new Uint8Array(T),F=P[0],L=v(T,1);return y&&x==="blob"&&(L=new y([L])),{type:c[F],data:L}};function B(T){try{T=k.decode(T,{strict:!1})}catch{return!1}return T}s.decodeBase64Packet=function(T,x){var N=c[T.charAt(0)];if(!S)return{type:N,data:{base64:!0,data:T.substr(1)}};var P=S.decode(T.substr(1));return x==="blob"&&y&&(P=new y([P])),{type:N,data:P}},s.encodePayload=function(T,x,N){typeof x=="function"&&(N=x,x=null);var P=h(T);if(x&&P)return y&&!f?s.encodePayloadAsBlob(T,N):s.encodePayloadAsArrayBuffer(T,N);if(!T.length)return N("0:");function F(z){return z.length+":"+z}function L(z,H){s.encodePacket(z,P?x:!1,!1,function(D){H(null,F(D))})}_(T,L,function(z,H){return N(H.join(""))})};function _(T,x,N){for(var P=new Array(T.length),F=E(T.length,N),L=function(H,D,X){x(D,function(q,J){P[H]=J,X(q,P)})},z=0;z<T.length;z++)L(z,T[z],F)}s.decodePayload=function(T,x,N){if(typeof T!="string")return s.decodePayloadAsBinary(T,x,N);typeof x=="function"&&(N=x,x=null);var P;if(T==="")return N(n,0,1);for(var F="",L,z,H=0,D=T.length;H<D;H++){var X=T.charAt(H);if(X!==":"){F+=X;continue}if(F===""||F!=(L=Number(F))||(z=T.substr(H+1,L),F!=z.length))return N(n,0,1);if(z.length){if(P=s.decodePacket(z,x,!1),n.type===P.type&&n.data===P.data)return N(n,0,1);var q=N(P,H+L,D);if(q===!1)return}H+=L,F=""}if(F!=="")return N(n,0,1)},s.encodePayloadAsArrayBuffer=function(T,x){if(!T.length)return x(new ArrayBuffer(0));function N(P,F){s.encodePacket(P,!0,!0,function(L){return F(null,L)})}_(T,N,function(P,F){var L=F.reduce(function(D,X){var q;return typeof X=="string"?q=X.length:q=X.byteLength,D+q.toString().length+q+2},0),z=new Uint8Array(L),H=0;return F.forEach(function(D){var X=typeof D=="string",q=D;if(X){for(var he=new Uint8Array(D.length),J=0;J<D.length;J++)he[J]=D.charCodeAt(J);q=he.buffer}X?z[H++]=0:z[H++]=1;for(var de=q.byteLength.toString(),J=0;J<de.length;J++)z[H++]=parseInt(de[J]);z[H++]=255;for(var he=new Uint8Array(q),J=0;J<he.length;J++)z[H++]=he[J]}),x(z.buffer)})},s.encodePayloadAsBlob=function(T,x){function N(P,F){s.encodePacket(P,!0,!0,function(L){var z=new Uint8Array(1);if(z[0]=1,typeof L=="string"){for(var H=new Uint8Array(L.length),D=0;D<L.length;D++)H[D]=L.charCodeAt(D);L=H.buffer,z[0]=0}for(var X=L instanceof ArrayBuffer?L.byteLength:L.size,q=X.toString(),J=new Uint8Array(q.length+1),D=0;D<q.length;D++)J[D]=parseInt(q[D]);if(J[q.length]=255,y){var de=new y([z.buffer,J.buffer,L]);F(null,de)}})}_(T,N,function(P,F){return x(new y(F))})},s.decodePayloadAsBinary=function(T,x,N){typeof x=="function"&&(N=x,x=null);for(var P=T,F=[];P.byteLength>0;){for(var L=new Uint8Array(P),z=L[0]===0,H="",D=1;L[D]!==255;D++){if(H.length>310)return N(n,0,1);H+=L[D]}P=v(P,2+H.length),H=parseInt(H);var X=v(P,0,H);if(z)try{X=String.fromCharCode.apply(null,new Uint8Array(X))}catch{var q=new Uint8Array(X);X="";for(var D=0;D<q.length;D++)X+=String.fromCharCode(q[D])}F.push(X),P=v(P,H)}var J=F.length;F.forEach(function(de,he){N(s.decodePacket(de,x,!0),he,J)})}},"./node_modules/engine.io-parser/lib/keys.js":function(i,s){i.exports=Object.keys||function(r){var h=[],v=Object.prototype.hasOwnProperty;for(var E in r)v.call(r,E)&&h.push(E);return h}},"./node_modules/engine.io-parser/lib/utf8.js":function(i,s){/*! https://mths.be/utf8js v2.1.2 by @mathias */var d=String.fromCharCode;function r(y){for(var A=[],O=0,R=y.length,b,B;O<R;)b=y.charCodeAt(O++),b>=55296&&b<=56319&&O<R?(B=y.charCodeAt(O++),(B&64512)==56320?A.push(((b&1023)<<10)+(B&1023)+65536):(A.push(b),O--)):A.push(b);return A}function h(y){for(var A=y.length,O=-1,R,b="";++O<A;)R=y[O],R>65535&&(R-=65536,b+=d(R>>>10&1023|55296),R=56320|R&1023),b+=d(R);return b}function v(y,A){if(y>=55296&&y<=57343){if(A)throw Error("Lone surrogate U+"+y.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function E(y,A){return d(y>>A&63|128)}function k(y,A){if((y&4294967168)==0)return d(y);var O="";return(y&4294965248)==0?O=d(y>>6&31|192):(y&4294901760)==0?(v(y,A)||(y=65533),O=d(y>>12&15|224),O+=E(y,6)):(y&4292870144)==0&&(O=d(y>>18&7|240),O+=E(y,12),O+=E(y,6)),O+=d(y&63|128),O}function S(y,A){A=A||{};for(var O=A.strict!==!1,R=r(y),b=R.length,B=-1,_,T="";++B<b;)_=R[B],T+=k(_,O);return T}function g(){if(c>=p)throw Error("Invalid byte index");var y=f[c]&255;if(c++,(y&192)==128)return y&63;throw Error("Invalid continuation byte")}function e(y){var A,O,R,b,B;if(c>p)throw Error("Invalid byte index");if(c==p)return!1;if(A=f[c]&255,c++,(A&128)==0)return A;if((A&224)==192){if(O=g(),B=(A&31)<<6|O,B>=128)return B;throw Error("Invalid continuation byte")}if((A&240)==224){if(O=g(),R=g(),B=(A&15)<<12|O<<6|R,B>=2048)return v(B,y)?B:65533;throw Error("Invalid continuation byte")}if((A&248)==240&&(O=g(),R=g(),b=g(),B=(A&7)<<18|O<<12|R<<6|b,B>=65536&&B<=1114111))return B;throw Error("Invalid UTF-8 detected")}var f,p,c;function n(y,A){A=A||{};var O=A.strict!==!1;f=r(y),p=f.length,c=0;for(var R=[],b;(b=e(O))!==!1;)R.push(b);return h(R)}i.exports={version:"2.1.2",encode:S,decode:n}},"./node_modules/enum/lib/enum.js":function(i,s,d){d.r(s),function(r){d.d(s,"default",function(){return e});var h=d("./node_modules/enum/lib/enumItem.js"),v=d("./node_modules/enum/lib/isType.js"),E=d("./node_modules/enum/lib/indexOf.js");const k=c=>c!=null&&c.constructor!=null&&typeof c.constructor.isBuffer=="function"&&c.constructor.isBuffer(c),g=(()=>{const c=new ArrayBuffer(2);return new DataView(c).setInt16(0,256,!0),new Int16Array(c)[0]===256?"LE":"BE"})();class e{constructor(n,y){if(this.size=4,this.indirection=1,y&&Object(v.isString)(y)&&(y={name:y}),this._options=y||{},this._options.separator=this._options.separator||" | ",this._options.endianness=this._options.endianness||g,this._options.ignoreCase=this._options.ignoreCase||!1,this._options.freez=this._options.freez||!1,this._options.freeze=this._options.freeze||this._options.freez||!1,this.enums=[],n.length){this._enumLastIndex=n.length;var A=n;n={};for(var O=0;O<A.length;O++)n[A[O]]=Math.pow(2,O)}for(var R in n)p(this._options.name,R),this[R]=new h.default(R,n[R],{ignoreCase:this._options.ignoreCase}),this.enums.push(this[R]);this._enumMap=n,this._options.ignoreCase&&(this.getLowerCaseEnums=function(){for(var B={},_=0,T=this.enums.length;_<T;_++)B[this.enums[_].key.toLowerCase()]=this.enums[_];return B}),this._options.name&&(this.name=this._options.name);const b=()=>{for(var B=0,_=this.enums.length;B<_;B++){var T=this.enums[B];if(!(T.value!==0&&!(T.value&T.value-1)))return!1}return!0};this.isFlaggable=b(),this._options.freeze&&this.freezeEnums()}getKey(n){var y=this.get(n);if(y)return y.key}getValue(n){var y=this.get(n);if(y)return y.value}get(n,y){if(n!=null)if(k(n)&&(n=n["readUInt32"+this._options.endianness](y||0)),h.default.isEnumItem(n)){var A=E.indexOf.call(this.enums,n);return A>=0?n:!this.isFlaggable||this.isFlaggable&&n.key.indexOf(this._options.separator)<0?void 0:this.get(n.key)}else if(Object(v.isString)(n)){var O=this;if(this._options.ignoreCase&&(O=this.getLowerCaseEnums(),n=n.toLowerCase()),n.indexOf(this._options.separator)>0){for(var R=n.split(this._options.separator),b=0,B=0;B<R.length;B++){var _=R[B];b|=O[_].value}return new h.default(n,b)}else return O[n]}else{for(var T in this)if(this.hasOwnProperty(T)&&this[T].value===n)return this[T];var x=null;if(this.isFlaggable)for(var N in this)this.hasOwnProperty(N)&&(n&this[N].value)!==0&&(x?x+=this._options.separator:x="",x+=N);return this.get(x||null)}}set(n,y,A){var O=this.get(A);if(O)return n["writeUInt32"+this._options.endianness](O.value,y||0)}freezeEnums(){function n(){return Object.isFrozen&&Object.isSealed&&Object.getOwnPropertyNames&&Object.getOwnPropertyDescriptor&&Object.defineProperties&&Object.__defineGetter__&&Object.__defineSetter__}function y(R){var b=Object.getOwnPropertyNames(R);return b.forEach(function(B){!Object.getOwnPropertyDescriptor(R,B).configurable||Object.defineProperties(R,B,{writable:!1,configurable:!1})}),R}function A(R){return R}function O(R){if(!(typeof R!="object"||R===null||Object.isFrozen(R)||Object.isSealed(R))){for(var b in R)R.hasOwnProperty(b)&&(R.__defineGetter__(b,A.bind(null,R[b])),R.__defineSetter__(b,function(_){throw TypeError("Cannot redefine property; Enum Type is not extensible.")}),O(R[b]));Object.freeze?Object.freeze(R):y(R)}}return n()&&O(this),this}isDefined(n){let y=A=>A===n;return(Object(v.isString)(n)||Object(v.isNumber)(n))&&(y=A=>A.is(n)),this.enums.some(y)}toJSON(){return this._enumMap}extend(n){if(n.length){var y=n;n={};for(var A=0;A<y.length;A++){var O=this._enumLastIndex+A;n[y[A]]=Math.pow(2,O)}for(var R in n)p(this._options.name,R),this[R]=new h.default(R,n[R],{ignoreCase:this._options.ignoreCase}),this.enums.push(this[R]);for(var b in this._enumMap)n[b]=this._enumMap[b];this._enumLastIndex+=n.length,this._enumMap=n,this._options.freeze&&this.freezeEnums()}}static register(n="Enum"){typeof r<"u"&&!r[n]?r[n]=e:typeof window<"u"&&!window[n]&&(window[n]=e)}[Symbol.iterator](){let n=0;return{next:()=>n<this.enums.length?{done:!1,value:this.enums[n++]}:{done:!0}}}}var f=["_options","get","getKey","getValue","enums","isFlaggable","_enumMap","toJSON","_enumLastIndex"];function p(c,n){if(c&&n==="name"||E.indexOf.call(f,n)>=0)throw new Error(`Enum key ${n} is a reserved word!`)}}.call(this,d("./node_modules/webpack/buildin/global.js"))},"./node_modules/enum/lib/enumItem.js":function(i,s,d){d.r(s),d.d(s,"default",function(){return h});var r=d("./node_modules/enum/lib/isType.js");class h{constructor(E,k,S={}){this.key=E,this.value=k,this._options=S,this._options.ignoreCase=this._options.ignoreCase||!1}has(E){return h.isEnumItem(E)?(this.value&E.value)!==0:Object(r.isString)(E)?this._options.ignoreCase?this.key.toLowerCase().indexOf(E.toLowerCase())>=0:this.key.indexOf(E)>=0:(this.value&E)!==0}is(E){return h.isEnumItem(E)?this.key===E.key:Object(r.isString)(E)?this._options.ignoreCase?this.key.toLowerCase()===E.toLowerCase():this.key===E:this.value===E}toString(){return this.key}toJSON(){return this.key}valueOf(){return this.value}static isEnumItem(E){return E instanceof h||Object(r.isObject)(E)&&E.key!==void 0&&E.value!==void 0}}},"./node_modules/enum/lib/indexOf.js":function(i,s,d){d.r(s),d.d(s,"indexOf",function(){return r});const r=Array.prototype.indexOf||function(h,v){v===void 0&&(v=0),v<0&&(v+=this.length),v<0&&(v=0);for(var E=this.length;v<E;v++)if(v in this&&this[v]===h)return v;return-1}},"./node_modules/enum/lib/isType.js":function(i,s,d){d.r(s),d.d(s,"isType",function(){return r}),d.d(s,"isObject",function(){return h}),d.d(s,"isString",function(){return v}),d.d(s,"isNumber",function(){return E});const r=(k,S)=>typeof S===k,h=k=>r("object",k),v=k=>r("string",k),E=k=>r("number",k)},"./node_modules/events/events.js":function(i,s,d){var r=typeof Reflect=="object"?Reflect:null,h=r&&typeof r.apply=="function"?r.apply:function(N,P,F){return Function.prototype.apply.call(N,P,F)},v;r&&typeof r.ownKeys=="function"?v=r.ownKeys:Object.getOwnPropertySymbols?v=function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:v=function(N){return Object.getOwnPropertyNames(N)};function E(x){console&&console.warn&&console.warn(x)}var k=Number.isNaN||function(N){return N!==N};function S(){S.init.call(this)}i.exports=S,i.exports.once=B,S.EventEmitter=S,S.prototype._events=void 0,S.prototype._eventsCount=0,S.prototype._maxListeners=void 0;var g=10;function e(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}Object.defineProperty(S,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(x){if(typeof x!="number"||x<0||k(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");g=x}}),S.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},S.prototype.setMaxListeners=function(N){if(typeof N!="number"||N<0||k(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this};function f(x){return x._maxListeners===void 0?S.defaultMaxListeners:x._maxListeners}S.prototype.getMaxListeners=function(){return f(this)},S.prototype.emit=function(N){for(var P=[],F=1;F<arguments.length;F++)P.push(arguments[F]);var L=N==="error",z=this._events;if(z!==void 0)L=L&&z.error===void 0;else if(!L)return!1;if(L){var H;if(P.length>0&&(H=P[0]),H instanceof Error)throw H;var D=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw D.context=H,D}var X=z[N];if(X===void 0)return!1;if(typeof X=="function")h(X,this,P);else for(var q=X.length,J=O(X,q),F=0;F<q;++F)h(J[F],this,P);return!0};function p(x,N,P,F){var L,z,H;if(e(P),z=x._events,z===void 0?(z=x._events=Object.create(null),x._eventsCount=0):(z.newListener!==void 0&&(x.emit("newListener",N,P.listener?P.listener:P),z=x._events),H=z[N]),H===void 0)H=z[N]=P,++x._eventsCount;else if(typeof H=="function"?H=z[N]=F?[P,H]:[H,P]:F?H.unshift(P):H.push(P),L=f(x),L>0&&H.length>L&&!H.warned){H.warned=!0;var D=new Error("Possible EventEmitter memory leak detected. "+H.length+" "+String(N)+" listeners added. Use emitter.setMaxListeners() to increase limit");D.name="MaxListenersExceededWarning",D.emitter=x,D.type=N,D.count=H.length,E(D)}return x}S.prototype.addListener=function(N,P){return p(this,N,P,!1)},S.prototype.on=S.prototype.addListener,S.prototype.prependListener=function(N,P){return p(this,N,P,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function n(x,N,P){var F={fired:!1,wrapFn:void 0,target:x,type:N,listener:P},L=c.bind(F);return L.listener=P,F.wrapFn=L,L}S.prototype.once=function(N,P){return e(P),this.on(N,n(this,N,P)),this},S.prototype.prependOnceListener=function(N,P){return e(P),this.prependListener(N,n(this,N,P)),this},S.prototype.removeListener=function(N,P){var F,L,z,H,D;if(e(P),L=this._events,L===void 0)return this;if(F=L[N],F===void 0)return this;if(F===P||F.listener===P)--this._eventsCount===0?this._events=Object.create(null):(delete L[N],L.removeListener&&this.emit("removeListener",N,F.listener||P));else if(typeof F!="function"){for(z=-1,H=F.length-1;H>=0;H--)if(F[H]===P||F[H].listener===P){D=F[H].listener,z=H;break}if(z<0)return this;z===0?F.shift():R(F,z),F.length===1&&(L[N]=F[0]),L.removeListener!==void 0&&this.emit("removeListener",N,D||P)}return this},S.prototype.off=S.prototype.removeListener,S.prototype.removeAllListeners=function(N){var P,F,L;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[N]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete F[N]),this;if(arguments.length===0){var z=Object.keys(F),H;for(L=0;L<z.length;++L)H=z[L],H!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=F[N],typeof P=="function")this.removeListener(N,P);else if(P!==void 0)for(L=P.length-1;L>=0;L--)this.removeListener(N,P[L]);return this};function y(x,N,P){var F=x._events;if(F===void 0)return[];var L=F[N];return L===void 0?[]:typeof L=="function"?P?[L.listener||L]:[L]:P?b(L):O(L,L.length)}S.prototype.listeners=function(N){return y(this,N,!0)},S.prototype.rawListeners=function(N){return y(this,N,!1)},S.listenerCount=function(x,N){return typeof x.listenerCount=="function"?x.listenerCount(N):A.call(x,N)},S.prototype.listenerCount=A;function A(x){var N=this._events;if(N!==void 0){var P=N[x];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}S.prototype.eventNames=function(){return this._eventsCount>0?v(this._events):[]};function O(x,N){for(var P=new Array(N),F=0;F<N;++F)P[F]=x[F];return P}function R(x,N){for(;N+1<x.length;N++)x[N]=x[N+1];x.pop()}function b(x){for(var N=new Array(x.length),P=0;P<N.length;++P)N[P]=x[P].listener||x[P];return N}function B(x,N){return new Promise(function(P,F){function L(H){x.removeListener(N,z),F(H)}function z(){typeof x.removeListener=="function"&&x.removeListener("error",L),P([].slice.call(arguments))}T(x,N,z,{once:!0}),N!=="error"&&_(x,L,{once:!0})})}function _(x,N,P){typeof x.on=="function"&&T(x,"error",N,P)}function T(x,N,P,F){if(typeof x.on=="function")F.once?x.once(N,P):x.on(N,P);else if(typeof x.addEventListener=="function")x.addEventListener(N,function L(z){F.once&&x.removeEventListener(N,L),P(z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof x)}},"./node_modules/filter-obj/index.js":function(i,s,d){i.exports=function(r,h){for(var v={},E=Object.keys(r),k=Array.isArray(h),S=0;S<E.length;S++){var g=E[S],e=r[g];(k?h.indexOf(g)!==-1:h(g,e,r))&&(v[g]=e)}return v}},"./node_modules/has-binary2/index.js":function(i,s,d){(function(r){var h=d("./node_modules/isarray/index.js"),v=Object.prototype.toString,E=typeof Blob=="function"||typeof Blob<"u"&&v.call(Blob)==="[object BlobConstructor]",k=typeof File=="function"||typeof File<"u"&&v.call(File)==="[object FileConstructor]";i.exports=S;function S(g){if(!g||typeof g!="object")return!1;if(h(g)){for(var e=0,f=g.length;e<f;e++)if(S(g[e]))return!0;return!1}if(typeof r=="function"&&r.isBuffer&&r.isBuffer(g)||typeof ArrayBuffer=="function"&&g instanceof ArrayBuffer||E&&g instanceof Blob||k&&g instanceof File)return!0;if(g.toJSON&&typeof g.toJSON=="function"&&arguments.length===1)return S(g.toJSON(),!0);for(var p in g)if(Object.prototype.hasOwnProperty.call(g,p)&&S(g[p]))return!0;return!1}}).call(this,d("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/has-cors/index.js":function(i,s){try{i.exports=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{i.exports=!1}},"./node_modules/ieee754/index.js":function(i,s){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(d,r,h,v,E){var k,S,g=E*8-v-1,e=(1<<g)-1,f=e>>1,p=-7,c=h?E-1:0,n=h?-1:1,y=d[r+c];for(c+=n,k=y&(1<<-p)-1,y>>=-p,p+=g;p>0;k=k*256+d[r+c],c+=n,p-=8);for(S=k&(1<<-p)-1,k>>=-p,p+=v;p>0;S=S*256+d[r+c],c+=n,p-=8);if(k===0)k=1-f;else{if(k===e)return S?NaN:(y?-1:1)*(1/0);S=S+Math.pow(2,v),k=k-f}return(y?-1:1)*S*Math.pow(2,k-v)},s.write=function(d,r,h,v,E,k){var S,g,e,f=k*8-E-1,p=(1<<f)-1,c=p>>1,n=E===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=v?0:k-1,A=v?1:-1,O=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(g=isNaN(r)?1:0,S=p):(S=Math.floor(Math.log(r)/Math.LN2),r*(e=Math.pow(2,-S))<1&&(S--,e*=2),S+c>=1?r+=n/e:r+=n*Math.pow(2,1-c),r*e>=2&&(S++,e/=2),S+c>=p?(g=0,S=p):S+c>=1?(g=(r*e-1)*Math.pow(2,E),S=S+c):(g=r*Math.pow(2,c-1)*Math.pow(2,E),S=0));E>=8;d[h+y]=g&255,y+=A,g/=256,E-=8);for(S=S<<E|g,f+=E;f>0;d[h+y]=S&255,y+=A,S/=256,f-=8);d[h+y-A]|=O*128}},"./node_modules/indexof/index.js":function(i,s){var d=[].indexOf;i.exports=function(r,h){if(d)return r.indexOf(h);for(var v=0;v<r.length;++v)if(r[v]===h)return v;return-1}},"./node_modules/isarray/index.js":function(i,s){var d={}.toString;i.exports=Array.isArray||function(r){return d.call(r)=="[object Array]"}},"./node_modules/js-binarypack/lib/binarypack.js":function(i,s,d){var r=d("./node_modules/js-binarypack/lib/bufferbuilder.js").BufferBuilder,h=d("./node_modules/js-binarypack/lib/bufferbuilder.js").binaryFeatures,v={unpack:function(e){var f=new E(e);return f.unpack()},pack:function(e){var f=new k;f.pack(e);var p=f.getBuffer();return p}};i.exports=v;function E(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}E.prototype.unpack=function(){var e=this.unpack_uint8();if(e<128){var f=e;return f}else if((e^224)<32){var p=(e^224)-32;return p}var c;if((c=e^160)<=15)return this.unpack_raw(c);if((c=e^176)<=15)return this.unpack_string(c);if((c=e^144)<=15)return this.unpack_array(c);if((c=e^128)<=15)return this.unpack_map(c);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return c=this.unpack_uint16(),this.unpack_string(c);case 217:return c=this.unpack_uint32(),this.unpack_string(c);case 218:return c=this.unpack_uint16(),this.unpack_raw(c);case 219:return c=this.unpack_uint32(),this.unpack_raw(c);case 220:return c=this.unpack_uint16(),this.unpack_array(c);case 221:return c=this.unpack_uint32(),this.unpack_array(c);case 222:return c=this.unpack_uint16(),this.unpack_map(c);case 223:return c=this.unpack_uint32(),this.unpack_map(c)}},E.prototype.unpack_uint8=function(){var e=this.dataView[this.index]&255;return this.index++,e},E.prototype.unpack_uint16=function(){var e=this.read(2),f=(e[0]&255)*256+(e[1]&255);return this.index+=2,f},E.prototype.unpack_uint32=function(){var e=this.read(4),f=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,f},E.prototype.unpack_uint64=function(){var e=this.read(8),f=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,f},E.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-(1<<8)},E.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-(1<<16)},E.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},E.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},E.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var f=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,f},E.prototype.unpack_string=function(e){for(var f=this.read(e),p=0,c="",n,y;p<e;)n=f[p],n<128?(c+=String.fromCharCode(n),p++):(n^192)<32?(y=(n^192)<<6|f[p+1]&63,c+=String.fromCharCode(y),p+=2):(y=(n&15)<<12|(f[p+1]&63)<<6|f[p+2]&63,c+=String.fromCharCode(y),p+=3);return this.index+=e,c},E.prototype.unpack_array=function(e){for(var f=new Array(e),p=0;p<e;p++)f[p]=this.unpack();return f},E.prototype.unpack_map=function(e){for(var f={},p=0;p<e;p++){var c=this.unpack(),n=this.unpack();f[c]=n}return f},E.prototype.unpack_float=function(){var e=this.unpack_uint32(),f=e>>31,p=(e>>23&255)-127,c=e&8388607|8388608;return(f==0?1:-1)*c*Math.pow(2,p-23)},E.prototype.unpack_double=function(){var e=this.unpack_uint32(),f=this.unpack_uint32(),p=e>>31,c=(e>>20&2047)-1023,n=e&1048575|1048576,y=n*Math.pow(2,c-20)+f*Math.pow(2,c-52);return(p==0?1:-1)*y},E.prototype.read=function(e){var f=this.index;if(f+e<=this.length)return this.dataView.subarray(f,f+e);throw new Error("BinaryPackFailure: read index out of range")};function k(){this.bufferBuilder=new r}k.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},k.prototype.pack=function(e){var f=typeof e;if(f=="string")this.pack_string(e);else if(f=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(f=="boolean")e===!0?this.bufferBuilder.append(195):e===!1&&this.bufferBuilder.append(194);else if(f=="undefined")this.bufferBuilder.append(192);else if(f=="object")if(e===null)this.bufferBuilder.append(192);else{var p=e.constructor;if(p==Array)this.pack_array(e);else if(p==Blob||p==File)this.pack_bin(e);else if(p==ArrayBuffer)h.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)h.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(p==Object)this.pack_object(e);else if(p==Date)this.pack_string(e.toString());else if(typeof e.toBinaryPack=="function")this.bufferBuilder.append(e.toBinaryPack());else throw new Error('Type "'+p.toString()+'" not yet supported')}else throw new Error('Type "'+f+'" not yet supported');this.bufferBuilder.flush()},k.prototype.pack_bin=function(e){var f=e.length||e.byteLength||e.size;if(f<=15)this.pack_uint8(160+f);else if(f<=65535)this.bufferBuilder.append(218),this.pack_uint16(f);else if(f<=4294967295)this.bufferBuilder.append(219),this.pack_uint32(f);else throw new Error("Invalid length");this.bufferBuilder.append(e)},k.prototype.pack_string=function(e){var f=g(e);if(f<=15)this.pack_uint8(176+f);else if(f<=65535)this.bufferBuilder.append(216),this.pack_uint16(f);else if(f<=4294967295)this.bufferBuilder.append(217),this.pack_uint32(f);else throw new Error("Invalid length");this.bufferBuilder.append(e)},k.prototype.pack_array=function(e){var f=e.length;if(f<=15)this.pack_uint8(144+f);else if(f<=65535)this.bufferBuilder.append(220),this.pack_uint16(f);else if(f<=4294967295)this.bufferBuilder.append(221),this.pack_uint32(f);else throw new Error("Invalid length");for(var p=0;p<f;p++)this.pack(e[p])},k.prototype.pack_integer=function(e){if(-32<=e&&e<=127)this.bufferBuilder.append(e&255);else if(0<=e&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(-128<=e&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(0<=e&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(-32768<=e&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(0<=e&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(-2147483648<=e&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(-9223372036854776e3<=e&&e<=9223372036854776e3)this.bufferBuilder.append(211),this.pack_int64(e);else if(0<=e&&e<=18446744073709552e3)this.bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")},k.prototype.pack_double=function(e){var f=0;e<0&&(f=1,e=-e);var p=Math.floor(Math.log(e)/Math.LN2),c=e/Math.pow(2,p)-1,n=Math.floor(c*Math.pow(2,52)),y=Math.pow(2,32),A=f<<31|p+1023<<20|n/y&1048575,O=n%y;this.bufferBuilder.append(203),this.pack_int32(A),this.pack_int32(O)},k.prototype.pack_object=function(e){var f=Object.keys(e),p=f.length;if(p<=15)this.pack_uint8(128+p);else if(p<=65535)this.bufferBuilder.append(222),this.pack_uint16(p);else if(p<=4294967295)this.bufferBuilder.append(223),this.pack_uint32(p);else throw new Error("Invalid length");for(var c in e)e.hasOwnProperty(c)&&(this.pack(c),this.pack(e[c]))},k.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},k.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(e&255)},k.prototype.pack_uint32=function(e){var f=e&4294967295;this.bufferBuilder.append((f&4278190080)>>>24),this.bufferBuilder.append((f&16711680)>>>16),this.bufferBuilder.append((f&65280)>>>8),this.bufferBuilder.append(f&255)},k.prototype.pack_uint64=function(e){var f=e/Math.pow(2,32),p=e%Math.pow(2,32);this.bufferBuilder.append((f&4278190080)>>>24),this.bufferBuilder.append((f&16711680)>>>16),this.bufferBuilder.append((f&65280)>>>8),this.bufferBuilder.append(f&255),this.bufferBuilder.append((p&4278190080)>>>24),this.bufferBuilder.append((p&16711680)>>>16),this.bufferBuilder.append((p&65280)>>>8),this.bufferBuilder.append(p&255)},k.prototype.pack_int8=function(e){this.bufferBuilder.append(e&255)},k.prototype.pack_int16=function(e){this.bufferBuilder.append((e&65280)>>8),this.bufferBuilder.append(e&255)},k.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((e&16711680)>>>16),this.bufferBuilder.append((e&65280)>>>8),this.bufferBuilder.append(e&255)},k.prototype.pack_int64=function(e){var f=Math.floor(e/Math.pow(2,32)),p=e%Math.pow(2,32);this.bufferBuilder.append((f&4278190080)>>>24),this.bufferBuilder.append((f&16711680)>>>16),this.bufferBuilder.append((f&65280)>>>8),this.bufferBuilder.append(f&255),this.bufferBuilder.append((p&4278190080)>>>24),this.bufferBuilder.append((p&16711680)>>>16),this.bufferBuilder.append((p&65280)>>>8),this.bufferBuilder.append(p&255)};function S(e){var f=e.charCodeAt(0);return f<=2047?"00":f<=65535?"000":f<=2097151?"0000":f<=67108863?"00000":"000000"}function g(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,S).length}},"./node_modules/js-binarypack/lib/bufferbuilder.js":function(i,s){var d={};d.useBlobBuilder=function(){try{return new Blob([]),!1}catch{return!0}}(),d.useArrayBufferView=!d.useBlobBuilder&&function(){try{return new Blob([new Uint8Array([])]).size===0}catch{return!0}}(),i.exports.binaryFeatures=d;var r=i.exports.BlobBuilder;typeof window<"u"&&(r=i.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder);function h(){this._pieces=[],this._parts=[]}h.prototype.append=function(v){typeof v=="number"?this._pieces.push(v):(this.flush(),this._parts.push(v))},h.prototype.flush=function(){if(this._pieces.length>0){var v=new Uint8Array(this._pieces);d.useArrayBufferView||(v=v.buffer),this._parts.push(v),this._pieces=[]}},h.prototype.getBuffer=function(){if(this.flush(),d.useBlobBuilder){for(var v=new r,E=0,k=this._parts.length;E<k;E++)v.append(this._parts[E]);return v.getBlob()}else return new Blob(this._parts)},i.exports.BufferBuilder=h},"./node_modules/ms/index.js":function(i,s){var d=1e3,r=d*60,h=r*60,v=h*24,E=v*365.25;i.exports=function(f,p){p=p||{};var c=typeof f;if(c==="string"&&f.length>0)return k(f);if(c==="number"&&isNaN(f)===!1)return p.long?g(f):S(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function k(f){if(f=String(f),!(f.length>100)){var p=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(f);if(!!p){var c=parseFloat(p[1]),n=(p[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return c*E;case"days":case"day":case"d":return c*v;case"hours":case"hour":case"hrs":case"hr":case"h":return c*h;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function S(f){return f>=v?Math.round(f/v)+"d":f>=h?Math.round(f/h)+"h":f>=r?Math.round(f/r)+"m":f>=d?Math.round(f/d)+"s":f+"ms"}function g(f){return e(f,v,"day")||e(f,h,"hour")||e(f,r,"minute")||e(f,d,"second")||f+" ms"}function e(f,p,c){if(!(f<p))return f<p*1.5?Math.floor(f/p)+" "+c:Math.ceil(f/p)+" "+c+"s"}},"./node_modules/node-libs-browser/node_modules/buffer/index.js":function(i,s,d){(function(r){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <http://feross.org>
* @license  MIT
*/var h=d("./node_modules/base64-js/index.js"),v=d("./node_modules/ieee754/index.js"),E=d("./node_modules/node-libs-browser/node_modules/isarray/index.js");s.Buffer=e,s.SlowBuffer=B,s.INSPECT_MAX_BYTES=50,e.TYPED_ARRAY_SUPPORT=r.TYPED_ARRAY_SUPPORT!==void 0?r.TYPED_ARRAY_SUPPORT:k(),s.kMaxLength=S();function k(){try{var w=new Uint8Array(1);return w.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},w.foo()===42&&typeof w.subarray=="function"&&w.subarray(1,1).byteLength===0}catch{return!1}}function S(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function g(w,a){if(S()<a)throw new RangeError("Invalid typed array length");return e.TYPED_ARRAY_SUPPORT?(w=new Uint8Array(a),w.__proto__=e.prototype):(w===null&&(w=new e(a)),w.length=a),w}function e(w,a,u){if(!e.TYPED_ARRAY_SUPPORT&&!(this instanceof e))return new e(w,a,u);if(typeof w=="number"){if(typeof a=="string")throw new Error("If encoding is specified then the first argument must be a string");return n(this,w)}return f(this,w,a,u)}e.poolSize=8192,e._augment=function(w){return w.__proto__=e.prototype,w};function f(w,a,u,C){if(typeof a=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer?O(w,a,u,C):typeof a=="string"?y(w,a,u):R(w,a)}e.from=function(w,a,u){return f(null,w,a,u)},e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0}));function p(w){if(typeof w!="number")throw new TypeError('"size" argument must be a number');if(w<0)throw new RangeError('"size" argument must not be negative')}function c(w,a,u,C){return p(a),a<=0?g(w,a):u!==void 0?typeof C=="string"?g(w,a).fill(u,C):g(w,a).fill(u):g(w,a)}e.alloc=function(w,a,u){return c(null,w,a,u)};function n(w,a){if(p(a),w=g(w,a<0?0:b(a)|0),!e.TYPED_ARRAY_SUPPORT)for(var u=0;u<a;++u)w[u]=0;return w}e.allocUnsafe=function(w){return n(null,w)},e.allocUnsafeSlow=function(w){return n(null,w)};function y(w,a,u){if((typeof u!="string"||u==="")&&(u="utf8"),!e.isEncoding(u))throw new TypeError('"encoding" must be a valid string encoding');var C=_(a,u)|0;w=g(w,C);var M=w.write(a,u);return M!==C&&(w=w.slice(0,M)),w}function A(w,a){var u=a.length<0?0:b(a.length)|0;w=g(w,u);for(var C=0;C<u;C+=1)w[C]=a[C]&255;return w}function O(w,a,u,C){if(a.byteLength,u<0||a.byteLength<u)throw new RangeError("'offset' is out of bounds");if(a.byteLength<u+(C||0))throw new RangeError("'length' is out of bounds");return u===void 0&&C===void 0?a=new Uint8Array(a):C===void 0?a=new Uint8Array(a,u):a=new Uint8Array(a,u,C),e.TYPED_ARRAY_SUPPORT?(w=a,w.__proto__=e.prototype):w=A(w,a),w}function R(w,a){if(e.isBuffer(a)){var u=b(a.length)|0;return w=g(w,u),w.length===0||a.copy(w,0,0,u),w}if(a){if(typeof ArrayBuffer<"u"&&a.buffer instanceof ArrayBuffer||"length"in a)return typeof a.length!="number"||gt(a.length)?g(w,0):A(w,a);if(a.type==="Buffer"&&E(a.data))return A(w,a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(w){if(w>=S())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+S().toString(16)+" bytes");return w|0}function B(w){return+w!=w&&(w=0),e.alloc(+w)}e.isBuffer=function(a){return!!(a!=null&&a._isBuffer)},e.compare=function(a,u){if(!e.isBuffer(a)||!e.isBuffer(u))throw new TypeError("Arguments must be Buffers");if(a===u)return 0;for(var C=a.length,M=u.length,V=0,U=Math.min(C,M);V<U;++V)if(a[V]!==u[V]){C=a[V],M=u[V];break}return C<M?-1:M<C?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,u){if(!E(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return e.alloc(0);var C;if(u===void 0)for(u=0,C=0;C<a.length;++C)u+=a[C].length;var M=e.allocUnsafe(u),V=0;for(C=0;C<a.length;++C){var U=a[C];if(!e.isBuffer(U))throw new TypeError('"list" argument must be an Array of Buffers');U.copy(M,V),V+=U.length}return M};function _(w,a){if(e.isBuffer(w))return w.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(w)||w instanceof ArrayBuffer))return w.byteLength;typeof w!="string"&&(w=""+w);var u=w.length;if(u===0)return 0;for(var C=!1;;)switch(a){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":case void 0:return se(w).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return be(w).length;default:if(C)return se(w).length;a=(""+a).toLowerCase(),C=!0}}e.byteLength=_;function T(w,a,u){var C=!1;if((a===void 0||a<0)&&(a=0),a>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,a>>>=0,u<=a))return"";for(w||(w="utf8");;)switch(w){case"hex":return dt(this,a,u);case"utf8":case"utf-8":return J(this,a,u);case"ascii":return ct(this,a,u);case"latin1":case"binary":return ut(this,a,u);case"base64":return q(this,a,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ft(this,a,u);default:if(C)throw new TypeError("Unknown encoding: "+w);w=(w+"").toLowerCase(),C=!0}}e.prototype._isBuffer=!0;function x(w,a,u){var C=w[a];w[a]=w[u],w[u]=C}e.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<a;u+=2)x(this,u,u+1);return this},e.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<a;u+=4)x(this,u,u+3),x(this,u+1,u+2);return this},e.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<a;u+=8)x(this,u,u+7),x(this,u+1,u+6),x(this,u+2,u+5),x(this,u+3,u+4);return this},e.prototype.toString=function(){var a=this.length|0;return a===0?"":arguments.length===0?J(this,0,a):T.apply(this,arguments)},e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:e.compare(this,a)===0},e.prototype.inspect=function(){var a="",u=s.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,u).match(/.{2}/g).join(" "),this.length>u&&(a+=" ... ")),"<Buffer "+a+">"},e.prototype.compare=function(a,u,C,M,V){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");if(u===void 0&&(u=0),C===void 0&&(C=a?a.length:0),M===void 0&&(M=0),V===void 0&&(V=this.length),u<0||C>a.length||M<0||V>this.length)throw new RangeError("out of range index");if(M>=V&&u>=C)return 0;if(M>=V)return-1;if(u>=C)return 1;if(u>>>=0,C>>>=0,M>>>=0,V>>>=0,this===a)return 0;for(var U=V-M,K=C-u,ee=Math.min(U,K),te=this.slice(M,V),fe=a.slice(u,C),ie=0;ie<ee;++ie)if(te[ie]!==fe[ie]){U=te[ie],K=fe[ie];break}return U<K?-1:K<U?1:0};function N(w,a,u,C,M){if(w.length===0)return-1;if(typeof u=="string"?(C=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,isNaN(u)&&(u=M?0:w.length-1),u<0&&(u=w.length+u),u>=w.length){if(M)return-1;u=w.length-1}else if(u<0)if(M)u=0;else return-1;if(typeof a=="string"&&(a=e.from(a,C)),e.isBuffer(a))return a.length===0?-1:P(w,a,u,C,M);if(typeof a=="number")return a=a&255,e.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?M?Uint8Array.prototype.indexOf.call(w,a,u):Uint8Array.prototype.lastIndexOf.call(w,a,u):P(w,[a],u,C,M);throw new TypeError("val must be string, number or Buffer")}function P(w,a,u,C,M){var V=1,U=w.length,K=a.length;if(C!==void 0&&(C=String(C).toLowerCase(),C==="ucs2"||C==="ucs-2"||C==="utf16le"||C==="utf-16le")){if(w.length<2||a.length<2)return-1;V=2,U/=2,K/=2,u/=2}function ee(He,We){return V===1?He[We]:He.readUInt16BE(We*V)}var te;if(M){var fe=-1;for(te=u;te<U;te++)if(ee(w,te)===ee(a,fe===-1?0:te-fe)){if(fe===-1&&(fe=te),te-fe+1===K)return fe*V}else fe!==-1&&(te-=te-fe),fe=-1}else for(u+K>U&&(u=U-K),te=u;te>=0;te--){for(var ie=!0,Ie=0;Ie<K;Ie++)if(ee(w,te+Ie)!==ee(a,Ie)){ie=!1;break}if(ie)return te}return-1}e.prototype.includes=function(a,u,C){return this.indexOf(a,u,C)!==-1},e.prototype.indexOf=function(a,u,C){return N(this,a,u,C,!0)},e.prototype.lastIndexOf=function(a,u,C){return N(this,a,u,C,!1)};function F(w,a,u,C){u=Number(u)||0;var M=w.length-u;C?(C=Number(C),C>M&&(C=M)):C=M;var V=a.length;if(V%2!==0)throw new TypeError("Invalid hex string");C>V/2&&(C=V/2);for(var U=0;U<C;++U){var K=parseInt(a.substr(U*2,2),16);if(isNaN(K))return U;w[u+U]=K}return U}function L(w,a,u,C){return pe(se(a,w.length-u),w,u,C)}function z(w,a,u,C){return pe(ge(a),w,u,C)}function H(w,a,u,C){return z(w,a,u,C)}function D(w,a,u,C){return pe(be(a),w,u,C)}function X(w,a,u,C){return pe(mt(a,w.length-u),w,u,C)}e.prototype.write=function(a,u,C,M){if(u===void 0)M="utf8",C=this.length,u=0;else if(C===void 0&&typeof u=="string")M=u,C=this.length,u=0;else if(isFinite(u))u=u|0,isFinite(C)?(C=C|0,M===void 0&&(M="utf8")):(M=C,C=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var V=this.length-u;if((C===void 0||C>V)&&(C=V),a.length>0&&(C<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");M||(M="utf8");for(var U=!1;;)switch(M){case"hex":return F(this,a,u,C);case"utf8":case"utf-8":return L(this,a,u,C);case"ascii":return z(this,a,u,C);case"latin1":case"binary":return H(this,a,u,C);case"base64":return D(this,a,u,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,a,u,C);default:if(U)throw new TypeError("Unknown encoding: "+M);M=(""+M).toLowerCase(),U=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(w,a,u){return a===0&&u===w.length?h.fromByteArray(w):h.fromByteArray(w.slice(a,u))}function J(w,a,u){u=Math.min(w.length,u);for(var C=[],M=a;M<u;){var V=w[M],U=null,K=V>239?4:V>223?3:V>191?2:1;if(M+K<=u){var ee,te,fe,ie;switch(K){case 1:V<128&&(U=V);break;case 2:ee=w[M+1],(ee&192)===128&&(ie=(V&31)<<6|ee&63,ie>127&&(U=ie));break;case 3:ee=w[M+1],te=w[M+2],(ee&192)===128&&(te&192)===128&&(ie=(V&15)<<12|(ee&63)<<6|te&63,ie>2047&&(ie<55296||ie>57343)&&(U=ie));break;case 4:ee=w[M+1],te=w[M+2],fe=w[M+3],(ee&192)===128&&(te&192)===128&&(fe&192)===128&&(ie=(V&15)<<18|(ee&63)<<12|(te&63)<<6|fe&63,ie>65535&&ie<1114112&&(U=ie))}}U===null?(U=65533,K=1):U>65535&&(U-=65536,C.push(U>>>10&1023|55296),U=56320|U&1023),C.push(U),M+=K}return he(C)}var de=4096;function he(w){var a=w.length;if(a<=de)return String.fromCharCode.apply(String,w);for(var u="",C=0;C<a;)u+=String.fromCharCode.apply(String,w.slice(C,C+=de));return u}function ct(w,a,u){var C="";u=Math.min(w.length,u);for(var M=a;M<u;++M)C+=String.fromCharCode(w[M]&127);return C}function ut(w,a,u){var C="";u=Math.min(w.length,u);for(var M=a;M<u;++M)C+=String.fromCharCode(w[M]);return C}function dt(w,a,u){var C=w.length;(!a||a<0)&&(a=0),(!u||u<0||u>C)&&(u=C);for(var M="",V=a;V<u;++V)M+=pt(w[V]);return M}function ft(w,a,u){for(var C=w.slice(a,u),M="",V=0;V<C.length;V+=2)M+=String.fromCharCode(C[V]+C[V+1]*256);return M}e.prototype.slice=function(a,u){var C=this.length;a=~~a,u=u===void 0?C:~~u,a<0?(a+=C,a<0&&(a=0)):a>C&&(a=C),u<0?(u+=C,u<0&&(u=0)):u>C&&(u=C),u<a&&(u=a);var M;if(e.TYPED_ARRAY_SUPPORT)M=this.subarray(a,u),M.__proto__=e.prototype;else{var V=u-a;M=new e(V,void 0);for(var U=0;U<V;++U)M[U]=this[U+a]}return M};function oe(w,a,u){if(w%1!==0||w<0)throw new RangeError("offset is not uint");if(w+a>u)throw new RangeError("Trying to access beyond buffer length")}e.prototype.readUIntLE=function(a,u,C){a=a|0,u=u|0,C||oe(a,u,this.length);for(var M=this[a],V=1,U=0;++U<u&&(V*=256);)M+=this[a+U]*V;return M},e.prototype.readUIntBE=function(a,u,C){a=a|0,u=u|0,C||oe(a,u,this.length);for(var M=this[a+--u],V=1;u>0&&(V*=256);)M+=this[a+--u]*V;return M},e.prototype.readUInt8=function(a,u){return u||oe(a,1,this.length),this[a]},e.prototype.readUInt16LE=function(a,u){return u||oe(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUInt16BE=function(a,u){return u||oe(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUInt32LE=function(a,u){return u||oe(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+this[a+3]*16777216},e.prototype.readUInt32BE=function(a,u){return u||oe(a,4,this.length),this[a]*16777216+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readIntLE=function(a,u,C){a=a|0,u=u|0,C||oe(a,u,this.length);for(var M=this[a],V=1,U=0;++U<u&&(V*=256);)M+=this[a+U]*V;return V*=128,M>=V&&(M-=Math.pow(2,8*u)),M},e.prototype.readIntBE=function(a,u,C){a=a|0,u=u|0,C||oe(a,u,this.length);for(var M=u,V=1,U=this[a+--M];M>0&&(V*=256);)U+=this[a+--M]*V;return V*=128,U>=V&&(U-=Math.pow(2,8*u)),U},e.prototype.readInt8=function(a,u){return u||oe(a,1,this.length),this[a]&128?(255-this[a]+1)*-1:this[a]},e.prototype.readInt16LE=function(a,u){u||oe(a,2,this.length);var C=this[a]|this[a+1]<<8;return C&32768?C|4294901760:C},e.prototype.readInt16BE=function(a,u){u||oe(a,2,this.length);var C=this[a+1]|this[a]<<8;return C&32768?C|4294901760:C},e.prototype.readInt32LE=function(a,u){return u||oe(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,u){return u||oe(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readFloatLE=function(a,u){return u||oe(a,4,this.length),v.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,u){return u||oe(a,4,this.length),v.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,u){return u||oe(a,8,this.length),v.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,u){return u||oe(a,8,this.length),v.read(this,a,!1,52,8)};function ne(w,a,u,C,M,V){if(!e.isBuffer(w))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>M||a<V)throw new RangeError('"value" argument is out of bounds');if(u+C>w.length)throw new RangeError("Index out of range")}e.prototype.writeUIntLE=function(a,u,C,M){if(a=+a,u=u|0,C=C|0,!M){var V=Math.pow(2,8*C)-1;ne(this,a,u,C,V,0)}var U=1,K=0;for(this[u]=a&255;++K<C&&(U*=256);)this[u+K]=a/U&255;return u+C},e.prototype.writeUIntBE=function(a,u,C,M){if(a=+a,u=u|0,C=C|0,!M){var V=Math.pow(2,8*C)-1;ne(this,a,u,C,V,0)}var U=C-1,K=1;for(this[u+U]=a&255;--U>=0&&(K*=256);)this[u+U]=a/K&255;return u+C},e.prototype.writeUInt8=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,1,255,0),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[u]=a&255,u+1};function Ne(w,a,u,C){a<0&&(a=65535+a+1);for(var M=0,V=Math.min(w.length-u,2);M<V;++M)w[u+M]=(a&255<<8*(C?M:1-M))>>>(C?M:1-M)*8}e.prototype.writeUInt16LE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8):Ne(this,a,u,!0),u+2},e.prototype.writeUInt16BE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[u]=a>>>8,this[u+1]=a&255):Ne(this,a,u,!1),u+2};function Oe(w,a,u,C){a<0&&(a=4294967295+a+1);for(var M=0,V=Math.min(w.length-u,4);M<V;++M)w[u+M]=a>>>(C?M:3-M)*8&255}e.prototype.writeUInt32LE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[u+3]=a>>>24,this[u+2]=a>>>16,this[u+1]=a>>>8,this[u]=a&255):Oe(this,a,u,!0),u+4},e.prototype.writeUInt32BE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255):Oe(this,a,u,!1),u+4},e.prototype.writeIntLE=function(a,u,C,M){if(a=+a,u=u|0,!M){var V=Math.pow(2,8*C-1);ne(this,a,u,C,V-1,-V)}var U=0,K=1,ee=0;for(this[u]=a&255;++U<C&&(K*=256);)a<0&&ee===0&&this[u+U-1]!==0&&(ee=1),this[u+U]=(a/K>>0)-ee&255;return u+C},e.prototype.writeIntBE=function(a,u,C,M){if(a=+a,u=u|0,!M){var V=Math.pow(2,8*C-1);ne(this,a,u,C,V-1,-V)}var U=C-1,K=1,ee=0;for(this[u+U]=a&255;--U>=0&&(K*=256);)a<0&&ee===0&&this[u+U+1]!==0&&(ee=1),this[u+U]=(a/K>>0)-ee&255;return u+C},e.prototype.writeInt8=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,1,127,-128),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),a<0&&(a=255+a+1),this[u]=a&255,u+1},e.prototype.writeInt16LE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8):Ne(this,a,u,!0),u+2},e.prototype.writeInt16BE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[u]=a>>>8,this[u+1]=a&255):Ne(this,a,u,!1),u+2},e.prototype.writeInt32LE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8,this[u+2]=a>>>16,this[u+3]=a>>>24):Oe(this,a,u,!0),u+4},e.prototype.writeInt32BE=function(a,u,C){return a=+a,u=u|0,C||ne(this,a,u,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),e.TYPED_ARRAY_SUPPORT?(this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255):Oe(this,a,u,!1),u+4};function Le(w,a,u,C,M,V){if(u+C>w.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function ze(w,a,u,C,M){return M||Le(w,a,u,4),v.write(w,a,u,C,23,4),u+4}e.prototype.writeFloatLE=function(a,u,C){return ze(this,a,u,!0,C)},e.prototype.writeFloatBE=function(a,u,C){return ze(this,a,u,!1,C)};function _e(w,a,u,C,M){return M||Le(w,a,u,8),v.write(w,a,u,C,52,8),u+8}e.prototype.writeDoubleLE=function(a,u,C){return _e(this,a,u,!0,C)},e.prototype.writeDoubleBE=function(a,u,C){return _e(this,a,u,!1,C)},e.prototype.copy=function(a,u,C,M){if(C||(C=0),!M&&M!==0&&(M=this.length),u>=a.length&&(u=a.length),u||(u=0),M>0&&M<C&&(M=C),M===C||a.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(C<0||C>=this.length)throw new RangeError("sourceStart out of bounds");if(M<0)throw new RangeError("sourceEnd out of bounds");M>this.length&&(M=this.length),a.length-u<M-C&&(M=a.length-u+C);var V=M-C,U;if(this===a&&C<u&&u<M)for(U=V-1;U>=0;--U)a[U+u]=this[U+C];else if(V<1e3||!e.TYPED_ARRAY_SUPPORT)for(U=0;U<V;++U)a[U+u]=this[U+C];else Uint8Array.prototype.set.call(a,this.subarray(C,C+V),u);return V},e.prototype.fill=function(a,u,C,M){if(typeof a=="string"){if(typeof u=="string"?(M=u,u=0,C=this.length):typeof C=="string"&&(M=C,C=this.length),a.length===1){var V=a.charCodeAt(0);V<256&&(a=V)}if(M!==void 0&&typeof M!="string")throw new TypeError("encoding must be a string");if(typeof M=="string"&&!e.isEncoding(M))throw new TypeError("Unknown encoding: "+M)}else typeof a=="number"&&(a=a&255);if(u<0||this.length<u||this.length<C)throw new RangeError("Out of range index");if(C<=u)return this;u=u>>>0,C=C===void 0?this.length:C>>>0,a||(a=0);var U;if(typeof a=="number")for(U=u;U<C;++U)this[U]=a;else{var K=e.isBuffer(a)?a:se(new e(a,M).toString()),ee=K.length;for(U=0;U<C-u;++U)this[U+u]=K[U%ee]}return this};var lt=/[^+\/0-9A-Za-z-_]/g;function ht(w){if(w=we(w).replace(lt,""),w.length<2)return"";for(;w.length%4!==0;)w=w+"=";return w}function we(w){return w.trim?w.trim():w.replace(/^\s+|\s+$/g,"")}function pt(w){return w<16?"0"+w.toString(16):w.toString(16)}function se(w,a){a=a||1/0;for(var u,C=w.length,M=null,V=[],U=0;U<C;++U){if(u=w.charCodeAt(U),u>55295&&u<57344){if(!M){if(u>56319){(a-=3)>-1&&V.push(239,191,189);continue}else if(U+1===C){(a-=3)>-1&&V.push(239,191,189);continue}M=u;continue}if(u<56320){(a-=3)>-1&&V.push(239,191,189),M=u;continue}u=(M-55296<<10|u-56320)+65536}else M&&(a-=3)>-1&&V.push(239,191,189);if(M=null,u<128){if((a-=1)<0)break;V.push(u)}else if(u<2048){if((a-=2)<0)break;V.push(u>>6|192,u&63|128)}else if(u<65536){if((a-=3)<0)break;V.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((a-=4)<0)break;V.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return V}function ge(w){for(var a=[],u=0;u<w.length;++u)a.push(w.charCodeAt(u)&255);return a}function mt(w,a){for(var u,C,M,V=[],U=0;U<w.length&&!((a-=2)<0);++U)u=w.charCodeAt(U),C=u>>8,M=u%256,V.push(M),V.push(C);return V}function be(w){return h.toByteArray(ht(w))}function pe(w,a,u,C){for(var M=0;M<C&&!(M+u>=a.length||M>=w.length);++M)a[M+u]=w[M];return M}function gt(w){return w!==w}}).call(this,d("./node_modules/webpack/buildin/global.js"))},"./node_modules/node-libs-browser/node_modules/isarray/index.js":function(i,s){var d={}.toString;i.exports=Array.isArray||function(r){return d.call(r)=="[object Array]"}},"./node_modules/object-sizeof/byte_size.js":function(i,s){i.exports={STRING:2,BOOLEAN:4,NUMBER:8}},"./node_modules/object-sizeof/index.js":function(i,s,d){var r=d("./node_modules/object-sizeof/byte_size.js"),h=d("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer;function v(g){const e=[];for(var f in g)e.push(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(g);Array.prototype.push.apply(e,p)}return e}function E(g,e){if(e==null)return 0;for(var f=0,p=v(e),c=0;c<p.length;c++){var n=p[c];if(typeof e[n]=="object"&&e[n]!==null){if(g.has(e[n]))continue;g.add(e[n])}f+=k(g)(n);try{f+=k(g)(e[n])}catch(y){y instanceof RangeError&&(f=0)}}return f}function k(g){return function(f){if(h.isBuffer(f))return f.length;var p=typeof f;switch(p){case"string":return f.length*r.STRING;case"boolean":return r.BOOLEAN;case"number":return r.NUMBER;case"symbol":return Symbol.keyFor&&Symbol.keyFor(f)?Symbol.keyFor(f).length*r.STRING:(f.toString().length-8)*r.STRING;case"object":return Array.isArray(f)?f.map(k(g)).reduce(function(n,y){return n+y},0):E(g,f);default:return 0}}}function S(g){return k(new WeakSet)(g)}i.exports=S},"./node_modules/parseqs/index.js":function(i,s){s.encode=function(d){var r="";for(var h in d)d.hasOwnProperty(h)&&(r.length&&(r+="&"),r+=encodeURIComponent(h)+"="+encodeURIComponent(d[h]));return r},s.decode=function(d){for(var r={},h=d.split("&"),v=0,E=h.length;v<E;v++){var k=h[v].split("=");r[decodeURIComponent(k[0])]=decodeURIComponent(k[1])}return r}},"./node_modules/parseuri/index.js":function(i,s){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];i.exports=function(k){var S=k,g=k.indexOf("["),e=k.indexOf("]");g!=-1&&e!=-1&&(k=k.substring(0,g)+k.substring(g,e).replace(/:/g,";")+k.substring(e,k.length));for(var f=d.exec(k||""),p={},c=14;c--;)p[r[c]]=f[c]||"";return g!=-1&&e!=-1&&(p.source=S,p.host=p.host.substring(1,p.host.length-1).replace(/;/g,":"),p.authority=p.authority.replace("[","").replace("]","").replace(/;/g,":"),p.ipv6uri=!0),p.pathNames=h(p,p.path),p.queryKey=v(p,p.query),p};function h(E,k){var S=/\/{2,9}/g,g=k.replace(S,"/").split("/");return(k.substr(0,1)=="/"||k.length===0)&&g.splice(0,1),k.substr(k.length-1,1)=="/"&&g.splice(g.length-1,1),g}function v(E,k){var S={};return k.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(g,e,f){e&&(S[e]=f)}),S}},"./node_modules/process/browser.js":function(i,s){var d=i.exports={},r,h;function v(){throw new Error("setTimeout has not been defined")}function E(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?r=setTimeout:r=v}catch{r=v}try{typeof clearTimeout=="function"?h=clearTimeout:h=E}catch{h=E}})();function k(O){if(r===setTimeout)return setTimeout(O,0);if((r===v||!r)&&setTimeout)return r=setTimeout,setTimeout(O,0);try{return r(O,0)}catch{try{return r.call(null,O,0)}catch{return r.call(this,O,0)}}}function S(O){if(h===clearTimeout)return clearTimeout(O);if((h===E||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(O);try{return h(O)}catch{try{return h.call(null,O)}catch{return h.call(this,O)}}}var g=[],e=!1,f,p=-1;function c(){!e||!f||(e=!1,f.length?g=f.concat(g):p=-1,g.length&&n())}function n(){if(!e){var O=k(c);e=!0;for(var R=g.length;R;){for(f=g,g=[];++p<R;)f&&f[p].run();p=-1,R=g.length}f=null,e=!1,S(O)}}d.nextTick=function(O){var R=new Array(arguments.length-1);if(arguments.length>1)for(var b=1;b<arguments.length;b++)R[b-1]=arguments[b];g.push(new y(O,R)),g.length===1&&!e&&k(n)};function y(O,R){this.fun=O,this.array=R}y.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={};function A(){}d.on=A,d.addListener=A,d.once=A,d.off=A,d.removeListener=A,d.removeAllListeners=A,d.emit=A,d.prependListener=A,d.prependOnceListener=A,d.listeners=function(O){return[]},d.binding=function(O){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(O){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},"./node_modules/query-string/index.js":function(i,s,d){const r=d("./node_modules/strict-uri-encode/index.js"),h=d("./node_modules/decode-uri-component/index.js"),v=d("./node_modules/split-on-first/index.js"),E=d("./node_modules/filter-obj/index.js"),k=b=>b==null;function S(b){switch(b.arrayFormat){case"index":return B=>(_,T)=>{const x=_.length;return T===void 0||b.skipNull&&T===null||b.skipEmptyString&&T===""?_:T===null?[..._,[f(B,b),"[",x,"]"].join("")]:[..._,[f(B,b),"[",f(x,b),"]=",f(T,b)].join("")]};case"bracket":return B=>(_,T)=>T===void 0||b.skipNull&&T===null||b.skipEmptyString&&T===""?_:T===null?[..._,[f(B,b),"[]"].join("")]:[..._,[f(B,b),"[]=",f(T,b)].join("")];case"comma":case"separator":return B=>(_,T)=>T==null||T.length===0?_:_.length===0?[[f(B,b),"=",f(T,b)].join("")]:[[_,f(T,b)].join(b.arrayFormatSeparator)];default:return B=>(_,T)=>T===void 0||b.skipNull&&T===null||b.skipEmptyString&&T===""?_:T===null?[..._,f(B,b)]:[..._,[f(B,b),"=",f(T,b)].join("")]}}function g(b){let B;switch(b.arrayFormat){case"index":return(_,T,x)=>{if(B=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!B){x[_]=T;return}x[_]===void 0&&(x[_]={}),x[_][B[1]]=T};case"bracket":return(_,T,x)=>{if(B=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!B){x[_]=T;return}if(x[_]===void 0){x[_]=[T];return}x[_]=[].concat(x[_],T)};case"comma":case"separator":return(_,T,x)=>{const N=typeof T=="string"&&T.includes(b.arrayFormatSeparator),P=typeof T=="string"&&!N&&p(T,b).includes(b.arrayFormatSeparator);T=P?p(T,b):T;const F=N||P?T.split(b.arrayFormatSeparator).map(L=>p(L,b)):T===null?T:p(T,b);x[_]=F};default:return(_,T,x)=>{if(x[_]===void 0){x[_]=T;return}x[_]=[].concat(x[_],T)}}}function e(b){if(typeof b!="string"||b.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(b,B){return B.encode?B.strict?r(b):encodeURIComponent(b):b}function p(b,B){return B.decode?h(b):b}function c(b){return Array.isArray(b)?b.sort():typeof b=="object"?c(Object.keys(b)).sort((B,_)=>Number(B)-Number(_)).map(B=>b[B]):b}function n(b){const B=b.indexOf("#");return B!==-1&&(b=b.slice(0,B)),b}function y(b){let B="";const _=b.indexOf("#");return _!==-1&&(B=b.slice(_)),B}function A(b){b=n(b);const B=b.indexOf("?");return B===-1?"":b.slice(B+1)}function O(b,B){return B.parseNumbers&&!Number.isNaN(Number(b))&&typeof b=="string"&&b.trim()!==""?b=Number(b):B.parseBooleans&&b!==null&&(b.toLowerCase()==="true"||b.toLowerCase()==="false")&&(b=b.toLowerCase()==="true"),b}function R(b,B){B=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},B),e(B.arrayFormatSeparator);const _=g(B),T=Object.create(null);if(typeof b!="string"||(b=b.trim().replace(/^[?#&]/,""),!b))return T;for(const x of b.split("&")){if(x==="")continue;let[N,P]=v(B.decode?x.replace(/\+/g," "):x,"=");P=P===void 0?null:["comma","separator"].includes(B.arrayFormat)?P:p(P,B),_(p(N,B),P,T)}for(const x of Object.keys(T)){const N=T[x];if(typeof N=="object"&&N!==null)for(const P of Object.keys(N))N[P]=O(N[P],B);else T[x]=O(N,B)}return B.sort===!1?T:(B.sort===!0?Object.keys(T).sort():Object.keys(T).sort(B.sort)).reduce((x,N)=>{const P=T[N];return Boolean(P)&&typeof P=="object"&&!Array.isArray(P)?x[N]=c(P):x[N]=P,x},Object.create(null))}s.extract=A,s.parse=R,s.stringify=(b,B)=>{if(!b)return"";B=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},B),e(B.arrayFormatSeparator);const _=P=>B.skipNull&&k(b[P])||B.skipEmptyString&&b[P]==="",T=S(B),x={};for(const P of Object.keys(b))_(P)||(x[P]=b[P]);const N=Object.keys(x);return B.sort!==!1&&N.sort(B.sort),N.map(P=>{const F=b[P];return F===void 0?"":F===null?f(P,B):Array.isArray(F)?F.reduce(T(P),[]).join("&"):f(P,B)+"="+f(F,B)}).filter(P=>P.length>0).join("&")},s.parseUrl=(b,B)=>{B=Object.assign({decode:!0},B);const[_,T]=v(b,"#");return Object.assign({url:_.split("?")[0]||"",query:R(A(b),B)},B&&B.parseFragmentIdentifier&&T?{fragmentIdentifier:p(T,B)}:{})},s.stringifyUrl=(b,B)=>{B=Object.assign({encode:!0,strict:!0},B);const _=n(b.url).split("?")[0]||"",T=s.extract(b.url),x=s.parse(T,{sort:!1}),N=Object.assign(x,b.query);let P=s.stringify(N,B);P&&(P=`?${P}`);let F=y(b.url);return b.fragmentIdentifier&&(F=`#${f(b.fragmentIdentifier,B)}`),`${_}${P}${F}`},s.pick=(b,B,_)=>{_=Object.assign({parseFragmentIdentifier:!0},_);const{url:T,query:x,fragmentIdentifier:N}=s.parseUrl(b,_);return s.stringifyUrl({url:T,query:E(x,B),fragmentIdentifier:N},_)},s.exclude=(b,B,_)=>{const T=Array.isArray(B)?x=>!B.includes(x):(x,N)=>!B(x,N);return s.pick(b,T,_)}},"./node_modules/sdp-transform/lib/grammar.js":function(i,s){var d=i.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(r){return r.encoding?"rtpmap:%d %s/%s/%s":r.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(r){return r.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(r){return r.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(r){return"extmap:%d"+(r.direction?"/%s":"%v")+(r["encrypt-uri"]?" %s":"%v")+" %s"+(r.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(r){return r.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(r){var h="candidate:%s %d %s %d %s %d typ %s";return h+=r.raddr!=null?" raddr %s rport %d":"%v%v",h+=r.tcptype!=null?" tcptype %s":"%v",r.generation!=null&&(h+=" generation %d"),h+=r["network-id"]!=null?" network-id %d":"%v",h+=r["network-cost"]!=null?" network-cost %d":"%v",h}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(r){var h="ssrc:%d";return r.attribute!=null&&(h+=" %s",r.value!=null&&(h+=":%s")),h}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(r){return r.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(r){return r.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(r){return"imageattr:%s %s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(r){return"simulcast:%s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(r){return"ts-refclk:%s"+(r.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(r){var h="mediaclk:";return h+=r.id!=null?"id=%s %s":"%v%s",h+=r.mediaClockValue!=null?"=%s":"",h+=r.rateNumerator!=null?" rate=%s":"",h+=r.rateDenominator!=null?"/%s":"",h}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(d).forEach(function(r){var h=d[r];h.forEach(function(v){v.reg||(v.reg=/(.*)/),v.format||(v.format="%s")})})},"./node_modules/sdp-transform/lib/index.js":function(i,s,d){var r=d("./node_modules/sdp-transform/lib/parser.js"),h=d("./node_modules/sdp-transform/lib/writer.js");s.write=h,s.parse=r.parse,s.parseParams=r.parseParams,s.parseFmtpConfig=r.parseFmtpConfig,s.parsePayloads=r.parsePayloads,s.parseRemoteCandidates=r.parseRemoteCandidates,s.parseImageAttributes=r.parseImageAttributes,s.parseSimulcastStreamList=r.parseSimulcastStreamList},"./node_modules/sdp-transform/lib/parser.js":function(i,s,d){var r=function(g){return String(Number(g))===g?Number(g):g},h=function(g,e,f,p){if(p&&!f)e[p]=r(g[1]);else for(var c=0;c<f.length;c+=1)g[c+1]!=null&&(e[f[c]]=r(g[c+1]))},v=function(g,e,f){var p=g.name&&g.names;g.push&&!e[g.push]?e[g.push]=[]:p&&!e[g.name]&&(e[g.name]={});var c=g.push?{}:p?e[g.name]:e;h(f.match(g.reg),c,g.names,g.name),g.push&&e[g.push].push(c)},E=d("./node_modules/sdp-transform/lib/grammar.js"),k=RegExp.prototype.test.bind(/^([a-z])=(.*)/);s.parse=function(g){var e={},f=[],p=e;return g.split(/(\r\n|\r|\n)/).filter(k).forEach(function(c){var n=c[0],y=c.slice(2);n==="m"&&(f.push({rtp:[],fmtp:[]}),p=f[f.length-1]);for(var A=0;A<(E[n]||[]).length;A+=1){var O=E[n][A];if(O.reg.test(y))return v(O,p,y)}}),e.media=f,e};var S=function(g,e){var f=e.split(/=(.+)/,2);return f.length===2?g[f[0]]=r(f[1]):f.length===1&&e.length>1&&(g[f[0]]=void 0),g};s.parseParams=function(g){return g.split(/;\s?/).reduce(S,{})},s.parseFmtpConfig=s.parseParams,s.parsePayloads=function(g){return g.toString().split(" ").map(Number)},s.parseRemoteCandidates=function(g){for(var e=[],f=g.split(" ").map(r),p=0;p<f.length;p+=3)e.push({component:f[p],ip:f[p+1],port:f[p+2]});return e},s.parseImageAttributes=function(g){return g.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(S,{})})},s.parseSimulcastStreamList=function(g){return g.split(";").map(function(e){return e.split(",").map(function(f){var p,c=!1;return f[0]!=="~"?p=r(f):(p=r(f.substring(1,f.length)),c=!0),{scid:p,paused:c}})})}},"./node_modules/sdp-transform/lib/writer.js":function(i,s,d){var r=d("./node_modules/sdp-transform/lib/grammar.js"),h=/%[sdv%]/g,v=function(g){var e=1,f=arguments,p=f.length;return g.replace(h,function(c){if(e>=p)return c;var n=f[e];switch(e+=1,c){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}})},E=function(g,e,f){var p=e.format instanceof Function?e.format(e.push?f:f[e.name]):e.format,c=[g+"="+p];if(e.names)for(var n=0;n<e.names.length;n+=1){var y=e.names[n];e.name?c.push(f[e.name][y]):c.push(f[e.names[n]])}else c.push(f[e.name]);return v.apply(null,c)},k=["v","o","s","i","u","e","p","c","b","t","r","z","a"],S=["i","c","b","a"];i.exports=function(g,e){e=e||{},g.version==null&&(g.version=0),g.name==null&&(g.name=" "),g.media.forEach(function(n){n.payloads==null&&(n.payloads="")});var f=e.outerOrder||k,p=e.innerOrder||S,c=[];return f.forEach(function(n){r[n].forEach(function(y){y.name in g&&g[y.name]!=null?c.push(E(n,y,g)):y.push in g&&g[y.push]!=null&&g[y.push].forEach(function(A){c.push(E(n,y,A))})})}),g.media.forEach(function(n){c.push(E("m",r.m[0],n)),p.forEach(function(y){r[y].forEach(function(A){A.name in n&&n[A.name]!=null?c.push(E(y,A,n)):A.push in n&&n[A.push]!=null&&n[A.push].forEach(function(O){c.push(E(y,A,O))})})})}),c.join(`\r
`)+`\r
`}},"./node_modules/socket.io-client/lib/index.js":function(i,s,d){var r=d("./node_modules/socket.io-client/lib/url.js"),h=d("./node_modules/socket.io-parser/index.js"),v=d("./node_modules/socket.io-client/lib/manager.js"),E=d("./node_modules/debug/src/browser.js")("socket.io-client");i.exports=s=S;var k=s.managers={};function S(g,e){typeof g=="object"&&(e=g,g=void 0),e=e||{};var f=r(g),p=f.source,c=f.id,n=f.path,y=k[c]&&n in k[c].nsps,A=e.forceNew||e["force new connection"]||e.multiplex===!1||y,O;return A?(E("ignoring socket cache for %s",p),O=v(p,e)):(k[c]||(E("new io instance for %s",p),k[c]=v(p,e)),O=k[c]),f.query&&!e.query&&(e.query=f.query),O.socket(f.path,e)}s.protocol=h.protocol,s.connect=S,s.Manager=d("./node_modules/socket.io-client/lib/manager.js"),s.Socket=d("./node_modules/socket.io-client/lib/socket.js")},"./node_modules/socket.io-client/lib/manager.js":function(i,s,d){var r=d("./node_modules/engine.io-client/lib/index.js"),h=d("./node_modules/socket.io-client/lib/socket.js"),v=d("./node_modules/component-emitter/index.js"),E=d("./node_modules/socket.io-parser/index.js"),k=d("./node_modules/socket.io-client/lib/on.js"),S=d("./node_modules/component-bind/index.js"),g=d("./node_modules/debug/src/browser.js")("socket.io-client:manager"),e=d("./node_modules/indexof/index.js"),f=d("./node_modules/backo2/index.js"),p=Object.prototype.hasOwnProperty;i.exports=c;function c(n,y){if(!(this instanceof c))return new c(n,y);n&&typeof n=="object"&&(y=n,n=void 0),y=y||{},y.path=y.path||"/socket.io",this.nsps={},this.subs=[],this.opts=y,this.reconnection(y.reconnection!==!1),this.reconnectionAttempts(y.reconnectionAttempts||1/0),this.reconnectionDelay(y.reconnectionDelay||1e3),this.reconnectionDelayMax(y.reconnectionDelayMax||5e3),this.randomizationFactor(y.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(y.timeout==null?2e4:y.timeout),this.readyState="closed",this.uri=n,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var A=y.parser||E;this.encoder=new A.Encoder,this.decoder=new A.Decoder,this.autoConnect=y.autoConnect!==!1,this.autoConnect&&this.open()}c.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var n in this.nsps)p.call(this.nsps,n)&&this.nsps[n].emit.apply(this.nsps[n],arguments)},c.prototype.updateSocketIds=function(){for(var n in this.nsps)p.call(this.nsps,n)&&(this.nsps[n].id=this.generateId(n))},c.prototype.generateId=function(n){return(n==="/"?"":n+"#")+this.engine.id},v(c.prototype),c.prototype.reconnection=function(n){return arguments.length?(this._reconnection=!!n,this):this._reconnection},c.prototype.reconnectionAttempts=function(n){return arguments.length?(this._reconnectionAttempts=n,this):this._reconnectionAttempts},c.prototype.reconnectionDelay=function(n){return arguments.length?(this._reconnectionDelay=n,this.backoff&&this.backoff.setMin(n),this):this._reconnectionDelay},c.prototype.randomizationFactor=function(n){return arguments.length?(this._randomizationFactor=n,this.backoff&&this.backoff.setJitter(n),this):this._randomizationFactor},c.prototype.reconnectionDelayMax=function(n){return arguments.length?(this._reconnectionDelayMax=n,this.backoff&&this.backoff.setMax(n),this):this._reconnectionDelayMax},c.prototype.timeout=function(n){return arguments.length?(this._timeout=n,this):this._timeout},c.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()},c.prototype.open=c.prototype.connect=function(n,y){if(g("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;g("opening %s",this.uri),this.engine=r(this.uri,this.opts);var A=this.engine,O=this;this.readyState="opening",this.skipReconnect=!1;var R=k(A,"open",function(){O.onopen(),n&&n()}),b=k(A,"error",function(T){if(g("connect_error"),O.cleanup(),O.readyState="closed",O.emitAll("connect_error",T),n){var x=new Error("Connection error");x.data=T,n(x)}else O.maybeReconnectOnOpen()});if(this._timeout!==!1){var B=this._timeout;g("connect attempt will timeout after %d",B),B===0&&R.destroy();var _=setTimeout(function(){g("connect attempt timed out after %d",B),R.destroy(),A.close(),A.emit("error","timeout"),O.emitAll("connect_timeout",B)},B);this.subs.push({destroy:function(){clearTimeout(_)}})}return this.subs.push(R),this.subs.push(b),this},c.prototype.onopen=function(){g("open"),this.cleanup(),this.readyState="open",this.emit("open");var n=this.engine;this.subs.push(k(n,"data",S(this,"ondata"))),this.subs.push(k(n,"ping",S(this,"onping"))),this.subs.push(k(n,"pong",S(this,"onpong"))),this.subs.push(k(n,"error",S(this,"onerror"))),this.subs.push(k(n,"close",S(this,"onclose"))),this.subs.push(k(this.decoder,"decoded",S(this,"ondecoded")))},c.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},c.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},c.prototype.ondata=function(n){this.decoder.add(n)},c.prototype.ondecoded=function(n){this.emit("packet",n)},c.prototype.onerror=function(n){g("error",n),this.emitAll("error",n)},c.prototype.socket=function(n,y){var A=this.nsps[n];if(!A){A=new h(this,n,y),this.nsps[n]=A;var O=this;A.on("connecting",R),A.on("connect",function(){A.id=O.generateId(n)}),this.autoConnect&&R()}function R(){~e(O.connecting,A)||O.connecting.push(A)}return A},c.prototype.destroy=function(n){var y=e(this.connecting,n);~y&&this.connecting.splice(y,1),!this.connecting.length&&this.close()},c.prototype.packet=function(n){g("writing packet %j",n);var y=this;n.query&&n.type===0&&(n.nsp+="?"+n.query),y.encoding?y.packetBuffer.push(n):(y.encoding=!0,this.encoder.encode(n,function(A){for(var O=0;O<A.length;O++)y.engine.write(A[O],n.options);y.encoding=!1,y.processPacketQueue()}))},c.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var n=this.packetBuffer.shift();this.packet(n)}},c.prototype.cleanup=function(){g("cleanup");for(var n=this.subs.length,y=0;y<n;y++){var A=this.subs.shift();A.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},c.prototype.close=c.prototype.disconnect=function(){g("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,this.readyState==="opening"&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},c.prototype.onclose=function(n){g("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",n),this._reconnection&&!this.skipReconnect&&this.reconnect()},c.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var n=this;if(this.backoff.attempts>=this._reconnectionAttempts)g("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var y=this.backoff.duration();g("will wait %dms before reconnect attempt",y),this.reconnecting=!0;var A=setTimeout(function(){n.skipReconnect||(g("attempting reconnect"),n.emitAll("reconnect_attempt",n.backoff.attempts),n.emitAll("reconnecting",n.backoff.attempts),!n.skipReconnect&&n.open(function(O){O?(g("reconnect attempt error"),n.reconnecting=!1,n.reconnect(),n.emitAll("reconnect_error",O.data)):(g("reconnect success"),n.onreconnect())}))},y);this.subs.push({destroy:function(){clearTimeout(A)}})}},c.prototype.onreconnect=function(){var n=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",n)}},"./node_modules/socket.io-client/lib/on.js":function(i,s){i.exports=d;function d(r,h,v){return r.on(h,v),{destroy:function(){r.removeListener(h,v)}}}},"./node_modules/socket.io-client/lib/socket.js":function(i,s,d){var r=d("./node_modules/socket.io-parser/index.js"),h=d("./node_modules/component-emitter/index.js"),v=d("./node_modules/to-array/index.js"),E=d("./node_modules/socket.io-client/lib/on.js"),k=d("./node_modules/component-bind/index.js"),S=d("./node_modules/debug/src/browser.js")("socket.io-client:socket"),g=d("./node_modules/parseqs/index.js"),e=d("./node_modules/has-binary2/index.js");i.exports=c;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=h.prototype.emit;function c(n,y,A){this.io=n,this.nsp=y,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},A&&A.query&&(this.query=A.query),this.io.autoConnect&&this.open()}h(c.prototype),c.prototype.subEvents=function(){if(!this.subs){var n=this.io;this.subs=[E(n,"open",k(this,"onopen")),E(n,"packet",k(this,"onpacket")),E(n,"close",k(this,"onclose"))]}},c.prototype.open=c.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.reconnecting||this.io.open(),this.io.readyState==="open"&&this.onopen(),this.emit("connecting"),this)},c.prototype.send=function(){var n=v(arguments);return n.unshift("message"),this.emit.apply(this,n),this},c.prototype.emit=function(n){if(f.hasOwnProperty(n))return p.apply(this,arguments),this;var y=v(arguments),A={type:(this.flags.binary!==void 0?this.flags.binary:e(y))?r.BINARY_EVENT:r.EVENT,data:y};return A.options={},A.options.compress=!this.flags||this.flags.compress!==!1,typeof y[y.length-1]=="function"&&(S("emitting packet with ack id %d",this.ids),this.acks[this.ids]=y.pop(),A.id=this.ids++),this.connected?this.packet(A):this.sendBuffer.push(A),this.flags={},this},c.prototype.packet=function(n){n.nsp=this.nsp,this.io.packet(n)},c.prototype.onopen=function(){if(S("transport is open - connecting"),this.nsp!=="/")if(this.query){var n=typeof this.query=="object"?g.encode(this.query):this.query;S("sending connect packet with query %s",n),this.packet({type:r.CONNECT,query:n})}else this.packet({type:r.CONNECT})},c.prototype.onclose=function(n){S("close (%s)",n),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",n)},c.prototype.onpacket=function(n){var y=n.nsp===this.nsp,A=n.type===r.ERROR&&n.nsp==="/";if(!(!y&&!A))switch(n.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(n);break;case r.BINARY_EVENT:this.onevent(n);break;case r.ACK:this.onack(n);break;case r.BINARY_ACK:this.onack(n);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",n.data);break}},c.prototype.onevent=function(n){var y=n.data||[];S("emitting event %j",y),n.id!=null&&(S("attaching ack callback to event"),y.push(this.ack(n.id))),this.connected?p.apply(this,y):this.receiveBuffer.push(y)},c.prototype.ack=function(n){var y=this,A=!1;return function(){if(!A){A=!0;var O=v(arguments);S("sending ack %j",O),y.packet({type:e(O)?r.BINARY_ACK:r.ACK,id:n,data:O})}}},c.prototype.onack=function(n){var y=this.acks[n.id];typeof y=="function"?(S("calling ack %s with %j",n.id,n.data),y.apply(this,n.data),delete this.acks[n.id]):S("bad ack %s",n.id)},c.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},c.prototype.emitBuffered=function(){var n;for(n=0;n<this.receiveBuffer.length;n++)p.apply(this,this.receiveBuffer[n]);for(this.receiveBuffer=[],n=0;n<this.sendBuffer.length;n++)this.packet(this.sendBuffer[n]);this.sendBuffer=[]},c.prototype.ondisconnect=function(){S("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},c.prototype.destroy=function(){if(this.subs){for(var n=0;n<this.subs.length;n++)this.subs[n].destroy();this.subs=null}this.io.destroy(this)},c.prototype.close=c.prototype.disconnect=function(){return this.connected&&(S("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},c.prototype.compress=function(n){return this.flags.compress=n,this},c.prototype.binary=function(n){return this.flags.binary=n,this}},"./node_modules/socket.io-client/lib/url.js":function(i,s,d){var r=d("./node_modules/parseuri/index.js"),h=d("./node_modules/debug/src/browser.js")("socket.io-client:url");i.exports=v;function v(E,k){var S=E;k=k||typeof location<"u"&&location,E==null&&(E=k.protocol+"//"+k.host),typeof E=="string"&&(E.charAt(0)==="/"&&(E.charAt(1)==="/"?E=k.protocol+E:E=k.host+E),/^(https?|wss?):\/\//.test(E)||(h("protocol-less url %s",E),typeof k<"u"?E=k.protocol+"//"+E:E="https://"+E),h("parse %s",E),S=r(E)),S.port||(/^(http|ws)$/.test(S.protocol)?S.port="80":/^(http|ws)s$/.test(S.protocol)&&(S.port="443")),S.path=S.path||"/";var g=S.host.indexOf(":")!==-1,e=g?"["+S.host+"]":S.host;return S.id=S.protocol+"://"+e+":"+S.port,S.href=S.protocol+"://"+e+(k&&k.port===S.port?"":":"+S.port),S}},"./node_modules/socket.io-parser/binary.js":function(i,s,d){var r=d("./node_modules/isarray/index.js"),h=d("./node_modules/socket.io-parser/is-buffer.js"),v=Object.prototype.toString,E=typeof Blob=="function"||typeof Blob<"u"&&v.call(Blob)==="[object BlobConstructor]",k=typeof File=="function"||typeof File<"u"&&v.call(File)==="[object FileConstructor]";s.deconstructPacket=function(e){var f=[],p=e.data,c=e;return c.data=S(p,f),c.attachments=f.length,{packet:c,buffers:f}};function S(e,f){if(!e)return e;if(h(e)){var p={_placeholder:!0,num:f.length};return f.push(e),p}else if(r(e)){for(var c=new Array(e.length),n=0;n<e.length;n++)c[n]=S(e[n],f);return c}else if(typeof e=="object"&&!(e instanceof Date)){var c={};for(var y in e)c[y]=S(e[y],f);return c}return e}s.reconstructPacket=function(e,f){return e.data=g(e.data,f),e.attachments=void 0,e};function g(e,f){if(!e)return e;if(e&&e._placeholder)return f[e.num];if(r(e))for(var p=0;p<e.length;p++)e[p]=g(e[p],f);else if(typeof e=="object")for(var c in e)e[c]=g(e[c],f);return e}s.removeBlobs=function(e,f){function p(y,A,O){if(!y)return y;if(E&&y instanceof Blob||k&&y instanceof File){c++;var R=new FileReader;R.onload=function(){O?O[A]=this.result:n=this.result,--c||f(n)},R.readAsArrayBuffer(y)}else if(r(y))for(var b=0;b<y.length;b++)p(y[b],b,y);else if(typeof y=="object"&&!h(y))for(var B in y)p(y[B],B,y)}var c=0,n=e;p(n),c||f(n)}},"./node_modules/socket.io-parser/index.js":function(i,s,d){var r=d("./node_modules/debug/src/browser.js")("socket.io-parser"),h=d("./node_modules/component-emitter/index.js"),v=d("./node_modules/socket.io-parser/binary.js"),E=d("./node_modules/isarray/index.js"),k=d("./node_modules/socket.io-parser/is-buffer.js");s.protocol=4,s.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=S,s.Decoder=c;function S(){}var g=s.ERROR+'"encode error"';S.prototype.encode=function(R,b){if(r("encoding packet %j",R),s.BINARY_EVENT===R.type||s.BINARY_ACK===R.type)p(R,b);else{var B=e(R);b([B])}};function e(R){var b=""+R.type;if((s.BINARY_EVENT===R.type||s.BINARY_ACK===R.type)&&(b+=R.attachments+"-"),R.nsp&&R.nsp!=="/"&&(b+=R.nsp+","),R.id!=null&&(b+=R.id),R.data!=null){var B=f(R.data);if(B!==!1)b+=B;else return g}return r("encoded %j as %s",R,b),b}function f(R){try{return JSON.stringify(R)}catch{return!1}}function p(R,b){function B(_){var T=v.deconstructPacket(_),x=e(T.packet),N=T.buffers;N.unshift(x),b(N)}v.removeBlobs(R,B)}function c(){this.reconstructor=null}h(c.prototype),c.prototype.add=function(R){var b;if(typeof R=="string")b=n(R),s.BINARY_EVENT===b.type||s.BINARY_ACK===b.type?(this.reconstructor=new A(b),this.reconstructor.reconPack.attachments===0&&this.emit("decoded",b)):this.emit("decoded",b);else if(k(R)||R.base64)if(this.reconstructor)b=this.reconstructor.takeBinaryData(R),b&&(this.reconstructor=null,this.emit("decoded",b));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+R)};function n(R){var b=0,B={type:Number(R.charAt(0))};if(s.types[B.type]==null)return O("unknown packet type "+B.type);if(s.BINARY_EVENT===B.type||s.BINARY_ACK===B.type){for(var _=b+1;R.charAt(++b)!=="-"&&b!=R.length;);var T=R.substring(_,b);if(T!=Number(T)||R.charAt(b)!=="-")throw new Error("Illegal attachments");B.attachments=Number(T)}if(R.charAt(b+1)==="/"){for(var _=b+1;++b;){var x=R.charAt(b);if(x===","||b===R.length)break}B.nsp=R.substring(_,b)}else B.nsp="/";var N=R.charAt(b+1);if(N!==""&&Number(N)==N){for(var _=b+1;++b;){var x=R.charAt(b);if(x==null||Number(x)!=x){--b;break}if(b===R.length)break}B.id=Number(R.substring(_,b+1))}if(R.charAt(++b)){var P=y(R.substr(b)),F=P!==!1&&(B.type===s.ERROR||E(P));if(F)B.data=P;else return O("invalid payload")}return r("decoded %s as %j",R,B),B}function y(R){try{return JSON.parse(R)}catch{return!1}}c.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};function A(R){this.reconPack=R,this.buffers=[]}A.prototype.takeBinaryData=function(R){if(this.buffers.push(R),this.buffers.length===this.reconPack.attachments){var b=v.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null},A.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};function O(R){return{type:s.ERROR,data:"parser error: "+R}}},"./node_modules/socket.io-parser/is-buffer.js":function(i,s,d){(function(r){i.exports=k;var h=typeof r=="function"&&typeof r.isBuffer=="function",v=typeof ArrayBuffer=="function",E=function(S){return typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(S):S.buffer instanceof ArrayBuffer};function k(S){return h&&r.isBuffer(S)||v&&(S instanceof ArrayBuffer||E(S))}}).call(this,d("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/split-on-first/index.js":function(i,s,d){i.exports=(r,h)=>{if(!(typeof r=="string"&&typeof h=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(h==="")return[r];const v=r.indexOf(h);return v===-1?[r]:[r.slice(0,v),r.slice(v+h.length)]}},"./node_modules/strict-uri-encode/index.js":function(i,s,d){i.exports=r=>encodeURIComponent(r).replace(/[!'()*]/g,h=>`%${h.charCodeAt(0).toString(16).toUpperCase()}`)},"./node_modules/to-array/index.js":function(i,s){i.exports=d;function d(r,h){var v=[];h=h||0;for(var E=h||0;E<r.length;E++)v[E-h]=r[E];return v}},"./node_modules/webpack/buildin/global.js":function(i,s){var d;d=function(){return this}();try{d=d||new Function("return this")()}catch{typeof window=="object"&&(d=window)}i.exports=d},"./node_modules/yeast/index.js":function(i,s,d){var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),h=64,v={},E=0,k=0,S;function g(p){var c="";do c=r[p%h]+c,p=Math.floor(p/h);while(p>0);return c}function e(p){var c=0;for(k=0;k<p.length;k++)c=c*h+v[p.charAt(k)];return c}function f(){var p=g(+new Date);return p!==S?(E=0,S=p):p+"."+g(E++)}for(;k<h;k++)v[r[k]]=k;f.encode=g,f.decode=e,i.exports=f},"./package.json":function(i){i.exports=JSON.parse('{"name":"skyway-js","version":"4.4.5","description":"The official JavaScript SDK for SkyWay","main":"dist/skyway.js","types":"skyway-js.d.ts","scripts":{"test":"karma start ./karma.conf.js","clean":"del ./dist","lint":"eslint .","build":"NODE_ENV=production webpack","dev":"webpack -w"},"repository":{"type":"git","url":"git+https://github.com/skyway/skyway-js-sdk"},"files":["dist/skyway.js","skyway-js.d.ts","LICENSE","CHANGELOG.md","README.md"],"author":"NTT Communications Corp.","license":"Apache-2.0","devDependencies":{"babel-loader":"7.1.5","babel-plugin-espower":"2.4.0","babel-plugin-istanbul":"4.1.6","babel-preset-es2015":"^6.24.1","del-cli":"^2.0.0","eslint":"^6.1.0","eslint-config-prettier":"^6.0.0","eslint-plugin-prettier":"^3.1.0","inject-loader":"^4.0.1","karma":"^4.2.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^1.1.2","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^4.0.2","mocha":"^6.2.0","power-assert":"^1.6.1","prettier":"^1.18.2","sinon":"^7.3.2","webpack":"^4.38.0","webpack-cli":"^3.3.6"},"dependencies":{"@jitsi/sdp-interop":"^0.1.13","@types/node":"^12.6.8","detect-browser":"^4.6.0","enum":"^3.0.4","events":"^3.0.0","js-binarypack":"0.0.9","object-sizeof":"^1.4.0","query-string":"^6.8.2","sdp-transform":"^2.11.0","socket.io-client":"^2.2.0","socket.io-parser":"~3.3.0"}}')},"./src/peer.js":function(i,s,d){d.r(s);var r=d("./node_modules/events/events.js"),h=d.n(r),v=d("./node_modules/enum/lib/enum.js"),E=d("./node_modules/socket.io-client/lib/index.js"),k=d.n(E),S=d("./node_modules/query-string/index.js"),g=d.n(S);const e="dispatcher.webrtc.ecl.ntt.com",f=443,p=!0,c=1e4,n="turn.webrtc.ecl.ntt.com",y=443,A={CLIENT:new v.default(["SEND_OFFER","SEND_ANSWER","SEND_CANDIDATE","SEND_LEAVE","ROOM_JOIN","ROOM_LEAVE","ROOM_GET_LOGS","ROOM_GET_USERS","ROOM_SEND_DATA","SFU_GET_OFFER","SFU_ANSWER","SFU_CANDIDATE","PING","UPDATE_CREDENTIAL","SEND_FORCE_CLOSE"]),SERVER:new v.default(["OPEN","ERROR","OFFER","ANSWER","CANDIDATE","LEAVE","AUTH_EXPIRES_IN","ROOM_LOGS","ROOM_USERS","ROOM_DATA","ROOM_USER_JOIN","ROOM_USER_LEAVE","SFU_OFFER","FORCE_CLOSE"])},O=16300,R=20*1024*1024;var F={DISPATCHER_HOST:e,DISPATCHER_PORT:f,DISPATCHER_SECURE:p,DISPATCHER_TIMEOUT:c,TURN_HOST:n,TURN_PORT:y,MESSAGE_TYPES:A,maxChunkSize:O,maxDataSize:R,minBroadcastIntervalMs:100,maxNumberOfAttempts:10,reconnectionAttempts:2,numberServersToTry:3,sendInterval:1,pingInterval:25e3,defaultConfig:{iceServers:[{urls:"stun:stun.webrtc.ecl.ntt.com:3478",url:"stun:stun.webrtc.ecl.ntt.com:3478"}],iceTransportPolicy:"all"}};const L="SkyWay: ",z=new v.default({NONE:0,ERROR:1,WARN:2,FULL:3});class H{constructor(){this._logLevel=z.NONE.value,this.LOG_LEVELS=z}setLogLevel(o){switch(o.value&&(o=o.value),parseInt(o,10)){case 0:this._logLevel=z.NONE.value;break;case 1:this._logLevel=z.ERROR.value;break;case 2:this._logLevel=z.WARN.value;break;case 3:this._logLevel=z.FULL.value;break;default:this._logLevel=z.NONE.value;break}}warn(...o){this._logLevel>=z.WARN.value&&console.warn(L,...o)}error(...o){this._logLevel>=z.ERROR.value&&console.error(L,...o)}log(...o){this._logLevel>=z.FULL.value&&console.log(L,...o)}}var D=new H,X=d("./node_modules/detect-browser/index.js");function q(ue){return!ue||/^[A-Za-z0-9_-]+(?:[ _-][A-Za-z0-9]+)*$/.exec(ue)}function J(ue){return!ue||/^[a-z0-9]{8}(-[a-z0-9]{4}){3}-[a-z0-9]{12}$/.exec(ue)}function de(){return(Math.random().toString(36)+"0000000000000000000").substr(2,16)}function he(){return Math.random().toString(36).substr(2)}function ct(ue){const o=ue.reduce((j,W)=>j+W.byteLength,0),m=new Uint8Array(o);let I=0;for(const j of ue)m.set(new Uint8Array(j),I),I+=j.byteLength;return m.buffer}function ut(ue,o){const m=new FileReader;m.onload=I=>{o(I.target.result)},m.readAsArrayBuffer(ue)}function dt(){return location.protocol==="https:"}function ft(){const{name:ue,version:o}=Object(X.detect)(),[m,I,j]=o.split(".").map(W=>parseInt(W));return{name:ue,major:m,minor:I,patch:j}}function oe(){const{name:ue}=Object(X.detect)();return!(!(ue==="safari"||ue==="ios")||RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))}var ne={validateId:q,validateKey:J,randomId:de,randomToken:he,joinArrayBuffers:ct,blobToArrayBuffer:ut,isSecure:dt,detectBrowser:ft,isPlanBSafari:oe},Ne=d("./package.json");class Oe extends h.a{constructor(o,m){if(super(),this._isOpen=!1,this._isPeerIdSet=!1,this._queue=[],this._io=null,this._key=o,this._reconnectAttempts=0,m.host&&m.port){const I=m.secure?"https://":"http://";this.signalingServerUrl=`${I}${m.host}:${m.port}`}else{const I=m.dispatcherHost||F.DISPATCHER_HOST,j=m.dispatcherPort||F.DISPATCHER_PORT,re=m.dispatcherSecure||F.DISPATCHER_SECURE?"https://":"http://";this._dispatcherUrl=`${re}${I}:${j}/signaling`}}get isOpen(){return Boolean(this._io&&this._io.connected&&this._isOpen)}async start(o,m,I){let j=`apiKey=${this._key}&token=${m}&platform=javascript&sdk_version=${Ne.version}`;if(o&&(j+=`&peerId=${o}`,this._isPeerIdSet=!0),I&&(j+=`&credential=${encodeURIComponent(JSON.stringify(I))}`),this._dispatcherUrl)try{this.signalingServerUrl=await this._fetchSignalingServerUrlWithRetry()}catch(le){this.emit("error",le);return}const W=ne.detectBrowser(),ae=(W.name==="ios"||W.name==="safari")&&W.major>=15?["polling"]:["polling","websocket"];this._io=k()(this.signalingServerUrl,{"force new connection":!0,query:j,reconnectionAttempts:F.reconnectionAttempts,transports:ae}),this._io.on("reconnect_failed",()=>{this._stopPings(),this._connectToNewServer()}),this._io.on("error",le=>{D.error(le)}),this._setupMessageHandlers()}async _connectToNewServer(){if(this._reconnectAttempts>=F.numberServersToTry){this.emit("error","Could not connect to server.");return}try{this.signalingServerUrl=await this._fetchSignalingServerUrlWithRetry()}catch(o){this.emit("error",o);return}this._io.io.uri=this.signalingServerUrl,this._io.connect(),this._reconnectAttempts++}async _fetchSignalingServerUrlWithRetry(){for(let o=0;o<F.maxNumberOfAttempts;o++){const m=await this._fetchSignalingServer().catch(I=>{D.warn(I)});if(m&&m.port&&m.host&&(!this.signalingServerUrl||this.signalingServerUrl.indexOf(m.host)===-1))return`${m.secure?"https://":"http://"}${m.host}:${m.port}`}throw new Error("Could not get signaling server url.")}_fetchSignalingServer(){return new Promise((o,m)=>{const I=new XMLHttpRequest;I.timeout=F.DISPATCHER_TIMEOUT,I.open("GET",this._dispatcherUrl,!0),I.onerror=()=>{m(new Error("There was a problem with the request for the dispatcher. Check your peer options and network connections."))},I.onabort=()=>{m(new Error("The request for the dispatcher was aborted."))},I.ontimeout=()=>{m(new Error("The request for the dispatcher timed out. Check your firewall, network speed, SkyWay failure information"))},I.onload=()=>{if(I.status!==200){m(new Error("Connection failed. Unexpected response: "+I.status));return}try{const j=JSON.parse(I.responseText);if(j&&j.domain){o({host:j.domain,port:443,secure:!0});return}m(new Error("The dispatcher server returned an invalid JSON response. have no signaling server domain in JSON."))}catch{m(new Error("The dispatcher server returned an invalid JSON response."))}},I.send(null)})}send(o,m){if(!o){this._io.emit("error","Invalid message");return}if(!this.isOpen){this._queue.push({type:o,message:m});return}this._io.connected===!0&&this._io.emit(o,m)}close(){this.isOpen&&(this._stopPings(),this._io.disconnect(),this._isOpen=!1)}reconnect(){this._io.connect()}updateCredential(o){const m=g.a.parse(this._io.io.opts.query);m.credential?m.credential=encodeURIComponent(JSON.stringify(o)):D.warn("Adding a credential when one wasn't specified before."),this._io.io.opts.query=g.a.stringify(m),this.send(F.MESSAGE_TYPES.CLIENT.UPDATE_CREDENTIAL.key,o)}_setupMessageHandlers(){F.MESSAGE_TYPES.SERVER.enums.forEach(o=>{o.key===F.MESSAGE_TYPES.SERVER.OPEN.key?this._io.on(o.key,m=>{!m||!m.peerId||(this._isPeerIdSet||(this._io.io.opts.query+=`&peerId=${m.peerId}`,this._isPeerIdSet=!0),this._reconnectAttempts=0,this._startPings(),this._sendQueuedMessages(),this._isOpen||(this._isOpen=!0,this.emit(o.key,m)))}):this._io.on(o.key,m=>{this.emit(o.key,m)})})}_sendQueuedMessages(){for(const o of this._queue)this.send(o.type,o.message);this._queue=[]}_startPings(){this._pingIntervalId||(this._pingIntervalId=setInterval(()=>{this.send(F.MESSAGE_TYPES.CLIENT.PING.key)},F.pingInterval))}_stopPings(){clearInterval(this._pingIntervalId),this._pingIntervalId=void 0}}var Le=Oe,ze=d("./node_modules/sdp-transform/lib/index.js"),_e=d.n(ze),lt=d("./node_modules/@jitsi/sdp-interop/lib/index.js");class ht{unifiedToPlanB(o){const I=new lt.Interop().toPlanB(o).sdp,j=new Set,W=/a=ssrc:\d+ msid:(\w+)/g;let re;for(;re=W.exec(I);)j.add(re[1]);const ae=I.replace("a=msid-semantic:WMS *",`a=msid-semantic:WMS ${Array.from(j).join(" ")}`);return new RTCSessionDescription({type:"offer",sdp:ae})}addVideoBandwidth(o,m){return this._validateBandwidth(m),this._addBandwidth(o,m,"video")}addAudioBandwidth(o,m){return this._validateBandwidth(m),this._addBandwidth(o,m,"audio")}filterVideoCodec(o,m){return this._filterCodec(o,m,"video")}filterAudioCodec(o,m){return this._filterCodec(o,m,"audio")}ensureUnifiedPlan(o){const m=`\r
`;return o.split(m).map(I=>I.startsWith("a=msid-semantic")?"a=msid-semantic:WMS *":I).join(m)}_filterCodec(o,m,I){if(m===void 0)throw new Error("codec is not passed");const j=_e.a.parse(o);return j.media=j.media.map(W=>{if(W.type===I){W.rtp=W.rtp.filter(ae=>ae.codec===m);const re=W.rtp.reduce((ae,le)=>[...ae,le.payload],[]);if(W.rtp.length===0)throw new Error(`${m} does not exist`);W.fmtp&&(W.fmtp=W.fmtp.filter(ae=>re.includes(ae.payload))),W.rtcpFb&&(W.rtcpFb=W.rtcpFb.filter(ae=>re.includes(ae.payload))),W.payloads=re.join(" ")}return W}),_e.a.write(j)}_addBandwidth(o,m,I){const j=_e.a.parse(o);return j.media=j.media.map(W=>(W.type===I&&(W.bandwidth=[{type:"AS",limit:m.toString()},{type:"TIAS",limit:(m*1e3).toString()}]),W)),_e.a.write(j)}_validateBandwidth(o){if(o===void 0)throw new Error("bandwidth is not passed");if(!/^\d+$/.test(o))throw new Error(`${o} is not a number`)}}var we=new ht;const pt=new v.default(["addStream","dcCreated","offerCreated","answerCreated","iceCandidate","iceConnectionFailed","negotiationNeeded","error"]);class se extends h.a{constructor(){super(),this._offerQueue=[],this._isExpectingAnswer=!1,this._isNegotiationAllowed=!0,this._isExecutingHandleOffer=!1,this.hasRemoteDescription=!1}async startConnection(o={}){if(this._pc=this._createPeerConnection(o.pcConfig),this._setupPCListeners(),this.originator=o.originator,this._audioBandwidth=o.audioBandwidth,this._videoBandwidth=o.videoBandwidth,this._audioCodec=o.audioCodec,this._videoCodec=o.videoCodec,this._type=o.type,this._type==="media")if(o.stream){const m=o.stream.getVideoTracks(),I=o.stream.getAudioTracks(),j=this._getReceiveOnlyState(o);m.length>0?m.forEach(W=>this._pc.addTrack(W,o.stream)):j.video&&this._pc.addTransceiver("video",{direction:"recvonly"}),I.length>0?I.forEach(W=>this._pc.addTrack(W,o.stream)):j.audio&&this._pc.addTransceiver("audio",{direction:"recvonly"})}else this.originator&&(this._pc.addTransceiver("audio",{direction:"recvonly"}),this._pc.addTransceiver("video",{direction:"recvonly"}));if(this.originator){if(this._type==="data"){const m=o.label||"",I=o.dcInit||{},j=this._pc.createDataChannel(m,I);this.emit(se.EVENTS.dcCreated.key,j)}}else await this.handleOffer(o.offer)}replaceStream(o){if(!this._pc)return;this._isNegotiationAllowed=!0;const m=this,I=o.getVideoTracks(),j=o.getAudioTracks(),W=this._pc.getSenders(),re=W.find(me=>me.track&&me.track.kind==="video"),ae=W.find(me=>me.track&&me.track.kind==="audio");le(re,I[0],o),le(ae,j[0],o);function le(me,Ce,yt){if(!(Ce===void 0&&me===void 0)){if(Ce===void 0){m._pc.removeTrack(me);return}if(me===void 0){m._pc.addTrack(Ce,yt);return}me.track.id!==Ce.id&&me.replaceTrack(Ce)}}}async handleOffer(o){if(this._lastOffer&&o&&this._lastOffer.sdp===o.sdp)return;if(this._isNegotiationAllowed=!0,this._pc.signalingState==="have-remote-offer"||this._isExecutingHandleOffer){this._offerQueue.push(o);return}this._lastOffer=o,this._isExecutingHandleOffer=!0;let m;try{await this._setRemoteDescription(o),m=await this._makeAnswerSdp().catch(I=>D.error(I))}finally{this._isExecutingHandleOffer=!1}if(this._pc.signalingState==="stable"){const I=this._offerQueue.shift();I&&this.handleOffer(I)}this.emit(se.EVENTS.answerCreated.key,m)}async handleAnswer(o){this._isNegotiationAllowed=!0,this._isExpectingAnswer?(await this._setRemoteDescription(o),this._isExpectingAnswer=!1):this._pc.onnegotiationneeded&&this._pc.onnegotiationneeded()}async handleCandidate(o){!this._pc||await this._pc.addIceCandidate(new RTCIceCandidate(o)).then(()=>D.log("Successfully added ICE candidate")).catch(m=>D.error("Failed to add ICE candidate",m))}cleanup(){D.log("Cleaning up PeerConnection"),this._pc&&(this._pc.readyState!=="closed"||this._pc.signalingState!=="closed")&&this._pc.close(),this._pc=null}_createPeerConnection(o={}){return D.log("Creating RTCPeerConnection"),o.sdpSemantics="unified-plan",new RTCPeerConnection(o)}_setupPCListeners(){const o=this._pc;o.ontrack=m=>{D.log("Received remote media stream track"),m.streams.forEach(I=>{this.emit(se.EVENTS.addStream.key,I)})},o.ondatachannel=m=>{D.log("Received data channel");const I=m.channel;this.emit(se.EVENTS.dcCreated.key,I)},o.onicecandidate=m=>{if(!m.candidate||m.candidate.candidate===""){D.log("ICE candidates gathering complete");return}D.log("Generated ICE candidate for:",m.candidate),this.emit(se.EVENTS.iceCandidate.key,m.candidate)},o.oniceconnectionstatechange=()=>{switch(o.iceConnectionState){case"completed":D.log("iceConnectionState is completed"),o.onicecandidate=()=>{};break;case"disconnected":D.log("iceConnectionState is disconnected, trying reconnect by browser");break;case"failed":D.log("iceConnectionState is failed, closing connection"),this.emit(se.EVENTS.iceConnectionFailed.key);break;default:D.log(`iceConnectionState is ${o.iceConnectionState}`);break}},o.onconnectionstatechange=()=>{D.log(`connectionState is ${o.connectionState}`),o.connectionState==="failed"&&o.iceConnectionState==="disconnected"&&(D.log("connectionState is failed, closing connection"),this.emit(se.EVENTS.iceConnectionFailed.key))},o.onnegotiationneeded=async()=>{if(D.log("`negotiationneeded` triggered"),o.signalingState==="stable"&&this._isNegotiationAllowed&&(this._isNegotiationAllowed=!1,this.originator)){const m=await this._makeOfferSdp();this._setLocalDescription(m),this.emit(se.EVENTS.negotiationNeeded.key)}},o.onsignalingstatechange=()=>{if(D.log(`signalingState is ${o.signalingState}`),o.signalingState==="stable"&&!this._isExecutingHandleOffer){const m=this._offerQueue.shift();m&&this.handleOffer(m)}}}async _makeOfferSdp(){let o;try{o=await this._pc.createOffer()}catch(m){throw m.type="webrtc",D.error(m),this.emit(se.EVENTS.error.key,m),D.log("Failed to createOffer, ",m),m}return D.log("Created offer."),this._audioBandwidth&&(o.sdp=we.addAudioBandwidth(o.sdp,this._audioBandwidth)),this._videoBandwidth&&(o.sdp=we.addVideoBandwidth(o.sdp,this._videoBandwidth)),this._audioCodec&&(o.sdp=we.filterAudioCodec(o.sdp,this._audioCodec)),this._videoCodec&&(o.sdp=we.filterVideoCodec(o.sdp,this._videoCodec)),o}async _makeAnswerSdp(){let o;try{o=await this._pc.createAnswer()}catch(m){throw m.type="webrtc",D.error(m),this.emit(se.EVENTS.error.key,m),D.log("Failed to createAnswer, ",m),m}D.log("Created answer."),this._audioBandwidth&&(o.sdp=we.addAudioBandwidth(o.sdp,this._audioBandwidth)),this._videoBandwidth&&(o.sdp=we.addVideoBandwidth(o.sdp,this._videoBandwidth)),this._audioCodec&&(o.sdp=we.filterAudioCodec(o.sdp,this._audioCodec)),this._videoCodec&&(o.sdp=we.filterVideoCodec(o.sdp,this._videoCodec));try{await this._pc.setLocalDescription(o)}catch(m){throw m.type="webrtc",D.error(m),this.emit(se.EVENTS.error.key,m),D.log("Failed to setLocalDescription, ",m),m}return D.log("Set localDescription: answer"),D.log(`Setting local description ${JSON.stringify(o.sdp)}`),o}async _setLocalDescription(o){D.log(`Setting local description ${JSON.stringify(o.sdp)}`);try{await this._pc.setLocalDescription(o)}catch(m){throw m.type="webrtc",D.error(m),this.emit(se.EVENTS.error.key,m),D.log("Failed to setLocalDescription, ",m),m}D.log("Set localDescription: offer"),this._isExpectingAnswer=!0,this.emit(se.EVENTS.offerCreated.key,o)}async _setRemoteDescription(o){D.log(`Setting remote description ${JSON.stringify(o)}`);try{await this._pc.setRemoteDescription(new RTCSessionDescription(o)),this.hasRemoteDescription=!0}catch(m){throw m.type="webrtc",D.error(m),this.emit(se.EVENTS.error.key,m),D.log("Failed to setRemoteDescription: ",m),m}D.log("Set remoteDescription:",o.type)}_getReceiveOnlyState(o={}){const m={audio:!1,video:!1},I=o.stream instanceof MediaStream,j=I?o.stream.getAudioTracks().length!==0:!1,W=I?o.stream.getVideoTracks().length!==0:!1;return I===!1&&o.audioReceiveEnabled===void 0&&o.videoReceiveEnabled===void 0?(m.audio=!0,m.video=!0,m):(o.audioReceiveEnabled&&j===!1&&(m.audio=!0),o.videoReceiveEnabled&&W===!1&&(m.video=!0),o.audioReceiveEnabled===!1&&j&&D.warn("Option audioReceiveEnabled will be treated as true, because passed stream has MediaStreamTrack(kind = audio)"),o.videoReceiveEnabled===!1&&W&&D.warn("Option videoReceiveEnabled will be treated as true, because passed stream has MediaStreamTrack(kind = video)"),m)}static get EVENTS(){return pt}}var ge=se;const mt=new v.default(["candidate","offer","answer","close","forceClose"]);class be extends h.a{constructor(o,m){if(super(),m=m||{},this.constructor===be)throw new TypeError("Cannot construct Connection instances directly");this._options=m,this.open=!1,this.type=void 0,this.metadata=this._options.metadata,this.remoteId=o,this._negotiator=new ge,this._idPrefix="c_",this._randomIdSuffix=ne.randomToken(),this._setupNegotiatorMessageHandlers()}get id(){return this._options.connectionId||this._idPrefix+this._randomIdSuffix}async handleAnswer(o){this._pcAvailable?(await this._negotiator.handleAnswer(o.answer),this.open=!0,this._handleQueuedMessages()):(D.log(`Queuing ANSWER message in ${this.id} from ${this.remoteId}`),this._queuedMessages.push({type:F.MESSAGE_TYPES.SERVER.ANSWER.key,payload:o}))}handleCandidate(o){if(this._negotiator.originator&&!this._negotiator.hasRemoteDescription){this._queuedMessages.push({type:F.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:o});return}this._pcAvailable?this._negotiator.handleCandidate(o.candidate):(D.log(`Queuing CANDIDATE message in ${this.id} from ${this.remoteId}`),this._queuedMessages.push({type:F.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:o}))}updateOffer(o){this.open?this._negotiator.handleOffer(o.offer):this._options.payload=o}getPeerConnection(){return this.open?this._negotiator._pc:null}_handleQueuedMessages(){for(const o of this._queuedMessages)switch(o.type){case F.MESSAGE_TYPES.SERVER.ANSWER.key:this.handleAnswer(o.payload);break;case F.MESSAGE_TYPES.SERVER.CANDIDATE.key:this.handleCandidate(o.payload);break;default:D.warn("Unrecognized message type:",o.type,"from peer:",this.remoteId);break}this._queuedMessages=[]}close(o=void 0){!this.open||(this.open=!1,this._negotiator.cleanup(),this.emit(be.EVENTS.close.key),o?this.emit(be.EVENTS.forceClose.key):o===void 0&&D.warn("Default value of the forceClose parameter will change false to true from future versions."))}_setupNegotiatorMessageHandlers(){this._negotiator.on(ge.EVENTS.answerCreated.key,o=>{const m={answer:o,dst:this.remoteId,connectionId:this.id,connectionType:this.type};this.emit(be.EVENTS.answer.key,m)}),this._negotiator.on(ge.EVENTS.offerCreated.key,o=>{const m={offer:o,dst:this.remoteId,connectionId:this.id,connectionType:this.type,metadata:this.metadata};this.serialization&&(m.serialization=this.serialization),this.label&&(m.label=this.label),this.dcInit&&(m.dcInit=this.dcInit),this.emit(be.EVENTS.offer.key,m)}),this._negotiator.on(ge.EVENTS.iceCandidate.key,o=>{const m={candidate:o,dst:this.remoteId,connectionId:this.id,connectionType:this.type};this.emit(be.EVENTS.candidate.key,m)}),this._negotiator.on(ge.EVENTS.iceConnectionFailed.key,()=>{this.close(!1)})}get peer(){return D.warn(`${this.constructor.name}.peer is deprecated and may be removed from a future version. Please use ${this.constructor.name}.remoteId instead.`),this.remoteId}static get EVENTS(){return mt}}var pe=be,gt=d("./node_modules/js-binarypack/lib/binarypack.js"),w=d.n(gt),a=d("./node_modules/object-sizeof/index.js"),u=d.n(a);const C=new v.default(["open","data","error"]);C.extend(pe.EVENTS.enums);const M=new v.default(["binary","binary-utf8","json","none"]);class V extends pe{constructor(o,m){if(super(o,m),this._idPrefix="dc_",this.type="data",this._isOnOpenCalled=!1,this.label=this._options.label||this.id,this.dcInit=this._options.dcInit||{},this.serialization=V.SERIALIZATIONS.binary.key,this._options.serialization){if(!V.SERIALIZATIONS.get(this._options.serialization))throw new Error("Invalid serialization");this.serialization=this._options.serialization,this._isUnreliableDCInit(this.dcInit)&&(D.warn("You can not specify serialization with unreliable mode enabled."),this.serialization=V.SERIALIZATIONS.binary.key)}this._sendBuffer=[],this._receivedData={},this._queuedMessages=this._options.queuedMessages||[],this._negotiator.on(ge.EVENTS.dcCreated.key,I=>{this._dc=I,this._dc.binaryType="arraybuffer",this._setupMessageHandlers(),!this._isOnOpenCalled&&this._dc.readyState==="open"&&this._dc.onopen()}),this._options.payload&&(this._options.payload.pcConfig=this._options.pcConfig)}async startConnection(){await this._negotiator.startConnection(this._options.payload||{originator:!0,type:"data",label:this.label,dcInit:this.dcInit,pcConfig:this._options.pcConfig}),this._pcAvailable=!0,this._handleQueuedMessages()}_setupMessageHandlers(){this._dc.onopen=()=>{this._isOnOpenCalled||(D.log("Data channel connection success"),this.open=!0,this._isOnOpenCalled=!0,this.emit(V.EVENTS.open.key))},this._dc.onmessage=o=>{this._handleDataMessage(o)},this._dc.onclose=()=>{D.log("DataChannel closed for:",this.id),this.close(!1)},this._dc.onerror=o=>{D.error(o)}}_handleDataMessage(o){if(this.serialization===V.SERIALIZATIONS.none.key){this.emit(V.EVENTS.data.key,o.data);return}else if(this.serialization===V.SERIALIZATIONS.json.key){this.emit(V.EVENTS.data.key,JSON.parse(o.data));return}const m=w.a.unpack(o.data);let I=this._receivedData[m.id];if(I||(I=this._receivedData[m.id]={size:m.size,type:m.type,name:m.name,mimeType:m.mimeType,totalParts:m.totalParts,parts:new Array(m.totalParts),receivedParts:0}),I.receivedParts++,I.parts[m.index]=m.data,I.receivedParts===I.totalParts){delete this._receivedData[m.id];const j=ne.joinArrayBuffers(I.parts),W=w.a.unpack(j);let re;switch(I.type){case"Blob":re=new Blob([new Uint8Array(W)],{type:I.mimeType});break;case"File":re=new File([new Uint8Array(W)],I.name,{type:I.mimeType});break;default:re=W}this.emit(V.EVENTS.data.key,re)}}send(o){if(!this.open){this.emit(V.EVENTS.error.key,new Error("Connection is not open. You should listen for the `open` event before sending messages."));return}if(o==null)return;if(this.serialization===V.SERIALIZATIONS.none.key){this._sendBuffer.push(o),this._startSendLoop();return}else if(this.serialization===V.SERIALIZATIONS.json.key){this._sendBuffer.push(JSON.stringify(o)),this._startSendLoop();return}const m=w.a.pack(o),I=m.size,j=o.constructor.name,W={id:ne.randomId(),type:j,size:I,totalParts:0};j==="File"&&(W.name=o.name),o instanceof Blob&&(W.mimeType=o.type);const re=F.maxChunkSize-u()(W),ae=Math.ceil(I/re);W.totalParts=ae;for(let le=0;le<ae;le++){const me=m.slice(le*re,(le+1)*re);W.index=le,W.data=me,ne.blobToArrayBuffer(w.a.pack(W),Ce=>{this._sendBuffer.push(Ce),this._startSendLoop()})}}close(o){const m=I=>{super.close(I),this._isOnOpenCalled=!1};if(!this._dc){m(o);return}this._dc.onclose=()=>{D.log("DataChannel closed for:",this.id),m(o)},this._dc.readyState!=="closing"&&(this._dc.readyState==="closed"?m(o):this._dc.close())}_startSendLoop(){this.sendInterval||(this.sendInterval=setInterval(()=>{const o=this._sendBuffer.shift();try{this._dc.send(o)}catch{this._sendBuffer.push(o)}this._sendBuffer.length===0&&(clearInterval(this.sendInterval),this.sendInterval=void 0)},F.sendInterval))}_isUnreliableDCInit(o){return o?"maxRetransmits"in o||"maxPacketLifeTime"in o:!1}static get SERIALIZATIONS(){return M}static get EVENTS(){return C}}var U=V;const K=new v.default(["stream"]);K.extend(pe.EVENTS.enums);class ee extends pe{constructor(o,m){super(o,m),this._idPrefix="mc_",this.type="media",this.localStream=this._options.stream,this._queuedMessages=this._options.queuedMessages||[],this._pcAvailable=!1}async startConnection(){!this._options.originator||(await this._negotiator.startConnection({type:"media",stream:this.localStream,originator:this._options.originator,pcConfig:this._options.pcConfig,videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled}),this._pcAvailable=!0,this._handleQueuedMessages())}answer(o,m={}){if(this.localStream){D.warn("localStream already exists on this MediaConnection. Are you answering a call twice?");return}this._options.payload.stream=o,this.localStream=o,this._negotiator.startConnection({type:"media",stream:this.localStream,originator:!1,offer:this._options.payload.offer,pcConfig:this._options.pcConfig,audioBandwidth:m.audioBandwidth,videoBandwidth:m.videoBandwidth,videoCodec:m.videoCodec,audioCodec:m.audioCodec}),this._pcAvailable=!0,this._handleQueuedMessages(),this.open=!0}replaceStream(o){this._negotiator.replaceStream(o),this.localStream=o}_setupNegotiatorMessageHandlers(){super._setupNegotiatorMessageHandlers(),this._negotiator.on(ge.EVENTS.addStream.key,o=>{D.log("Receiving stream",o),!(this.remoteStream&&this.remoteStream.id===o.id)&&(this.remoteStream=o,this.emit(ee.EVENTS.stream.key,o))})}static get EVENTS(){return K}}var te=ee,fe=d("./node_modules/socket.io-parser/index.js"),ie=d.n(fe),Ie=d("./node_modules/has-binary2/index.js"),He=d.n(Ie);const We=["stream","open","close","peerJoin","peerLeave","error","data","log"],rr=["offer","answer","candidate","leave","close","getLog","broadcast"],nr=new v.default(We),ir=new v.default(rr);class Fe extends h.a{constructor(o,m,I={}){if(super(),this.constructor===Fe)throw new TypeError("Cannot construct Room instances directly");this.name=o,this._options=I,this._peerId=m,this._localStream=this._options.stream,this._pcConfig=this._options.pcConfig,this.lastSent=0,this.messageQueue=[],this.sendIntervalID=null}validateSendDataSize(o){const m=He()([o]),I={type:m?ie.a.BINARY_EVENT:ie.a.EVENT,data:[o]},j=new ie.a.Encoder;let W;j.encode(I,ae=>{W=m?ae[1].byteLength:ae[0].length});const re=F.maxDataSize;if(W>re)throw new Error("The size of data to send must be less than 20 MB");return!0}_sendData(o,m){const I=F.minBroadcastIntervalMs,j=Date.now(),W=j-this.lastsend;if(this.messageQueue.length==0&&W>=I){this.lastsend=j,this.emit(m,o);return}this.messageQueue.push({msg:o,key:m}),this.sendIntervalID===null&&(this.sendIntervalID=setInterval(()=>{if(this.messageQueue.length===0){clearInterval(this.sendIntervalID),this.sendIntervalID=null;return}const re=this.messageQueue.shift();this.lastsend=Date.now(),this.emit(re.key,re.msg)},I))}handleData(o){const m={data:o.data,src:o.src};this.emit(Fe.EVENTS.data.key,m)}handleLog(o){this.emit(Fe.EVENTS.log.key,o)}getLog(){const o={roomName:this.name};this.emit(Fe.MESSAGE_EVENTS.getLog.key,o)}static get EVENTS(){return nr}static get MESSAGE_EVENTS(){return ir}}var Pe=Fe;const sr=["offerRequest","candidate"],Bt=new v.default([]);Bt.extend(Pe.EVENTS.enums);const Tt=new v.default(sr);Tt.extend(Pe.MESSAGE_EVENTS.enums);class ye extends Pe{constructor(o,m,I){super(o,m,I),this.remoteStreams={},this.members=[],this._open=!1,this._msidMap={},this._unknownStreams={},this._negotiator=new ge}call(o){o&&(this._localStream=o);const m={roomName:this.name};this.emit(ye.MESSAGE_EVENTS.offerRequest.key,m)}handleOffer(o){let m=o.offer;ne.isPlanBSafari()&&(m=we.unifiedToPlanB(m)),this._connectionStarted?this._negotiator.handleOffer(m):(this._negotiator.startConnection({type:"media",stream:this._localStream,pcConfig:this._options.pcConfig,offer:m}),this._setupNegotiatorMessageHandlers(),this._connectionStarted=!0)}_setupNegotiatorMessageHandlers(){this._negotiator.on(ge.EVENTS.addStream.key,o=>{const m=o;if(this._msidMap[m.id]){if(m.peerId=this._msidMap[m.id],m.peerId===this._peerId)return;const I=this.remoteStreams[m.id];if(I&&I.id===m.id)return;this.remoteStreams[m.id]=m,this.emit(ye.EVENTS.stream.key,m),D.log(`Received remote media stream for ${m.peerId} in ${this.name}`)}else this._unknownStreams[m.id]=m}),this._negotiator.on(ge.EVENTS.negotiationNeeded.key,()=>{const o={roomName:this.name};this.emit(ye.MESSAGE_EVENTS.offerRequest.key,o)}),this._negotiator.on(ge.EVENTS.answerCreated.key,o=>{ne.isPlanBSafari()||(o.sdp=we.ensureUnifiedPlan(o.sdp));const m={roomName:this.name,answer:o};this.emit(ye.MESSAGE_EVENTS.answer.key,m)}),this._negotiator.on(ge.EVENTS.iceConnectionFailed.key,()=>{this.close()}),this._negotiator.on(ge.EVENTS.iceCandidate.key,o=>{const m={roomName:this.name,candidate:o};this.emit(ye.MESSAGE_EVENTS.candidate.key,m)})}handleJoin(o){const{src:m,roomMembers:I}=o;if(m===this._peerId){this._open=!0,this.members=I.filter(j=>j!==m),this.call(this._localStream),this.emit(ye.EVENTS.open.key);return}this.members.push(m),this.emit(ye.EVENTS.peerJoin.key,m)}handleLeave(o){if(!this._open)return;const m=o.src,I=this.members.indexOf(m);I>=0&&this.members.splice(I,1);for(const j in this.remoteStreams)this.remoteStreams[j].peerId===m&&(delete this.remoteStreams[j],delete this._msidMap[j],delete this._unknownStreams[j]);this.emit(ye.EVENTS.peerLeave.key,m)}send(o){if(!this._open||!this.validateSendDataSize(o))return;const m={roomName:this.name,data:o};this._sendData(m,ye.MESSAGE_EVENTS.broadcast.key)}close(){if(!this._open)return;this._negotiator&&this._negotiator.cleanup(),this._open=!1;const o={roomName:this.name};this.emit(ye.MESSAGE_EVENTS.leave.key,o),this.emit(ye.EVENTS.close.key)}replaceStream(o){this._localStream=o,this._negotiator.replaceStream(o)}updateMsidMap(o={}){this._msidMap=o;for(const m of Object.keys(this._unknownStreams))if(this._msidMap[m]){const I=this._unknownStreams[m];if(I.peerId=this._msidMap[I.id],delete this._unknownStreams[m],I.peerId===this._peerId)return;this.remoteStreams[I.id]=I,this.emit(ye.EVENTS.stream.key,I)}}getPeerConnection(){return this._connectionStarted?this._negotiator._pc:null}static get EVENTS(){return Bt}static get MESSAGE_EVENTS(){return Tt}}var Re=ye;const or=["broadcastByDC","getPeers"],_t=new v.default([]);_t.extend(Pe.EVENTS.enums);const Rt=new v.default(or);Rt.extend(Pe.MESSAGE_EVENTS.enums);class ve extends Pe{constructor(o,m,I){super(o,m,I),this.connections={},this._queuedMessages={}}call(o){o&&(this._localStream=o);const m={roomName:this.name,type:"media"};this.emit(ve.MESSAGE_EVENTS.getPeers.key,m)}connect(){const o={roomName:this.name,type:"data"};this.emit(ve.MESSAGE_EVENTS.getPeers.key,o)}makeMediaConnections(o){const m={stream:this._localStream,pcConfig:this._pcConfig,originator:!0,videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled};this._makeConnections(o,"media",m)}makeDataConnections(o){const m={pcConfig:this._pcConfig};this._makeConnections(o,"data",m)}handleJoin(o){const m=o.src;if(m===this._peerId){this.call(this._localStream),this.emit(ve.EVENTS.open.key);return}this.emit(ve.EVENTS.peerJoin.key,m)}handleLeave(o){const m=o.src;this._deleteConnections(m),this.emit(ve.EVENTS.peerLeave.key,m)}handleOffer(o){const m=o.connectionId;let I=this._getConnection(o.src,m);if(I){I.updateOffer(o);return}if(o.connectionType==="media"){if(this._hasConnection(o.src)&&this._peerId>o.src)return;I=new te(o.src,{connectionId:m,payload:o,metadata:o.metadata,queuedMessages:this._queuedMessages[m],pcConfig:this._pcConfig}),I.startConnection(),D.log("MediaConnection created in OFFER"),this._addConnection(o.src,I),this._setupMessageHandlers(I),I.answer(this._localStream,{videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled})}else D.warn(`Received malformed connection type: ${o.connectionType}`)}handleAnswer(o){const m=this._getConnection(o.src,o.connectionId);m&&m.handleAnswer(o)}handleCandidate(o){const m=this._getConnection(o.src,o.connectionId);m?m.handleCandidate(o):(this._queuedMessages[o.connectionId]===void 0&&(this._queuedMessages[o.connectionId]=[]),this._queuedMessages[o.connectionId].push({type:F.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:o}))}send(o){if(!this.validateSendDataSize(o))return;const m={roomName:this.name,data:o};this._sendData(m,ve.MESSAGE_EVENTS.broadcast.key)}close(){for(const m in this.connections)this.connections.hasOwnProperty(m)&&this.connections[m].forEach(I=>{I.close(!1)});const o={roomName:this.name};this.emit(ve.MESSAGE_EVENTS.leave.key,o),this.emit(ve.EVENTS.close.key)}replaceStream(o){this._localStream=o;for(const m in this.connections)this.connections.hasOwnProperty(m)&&this.connections[m].forEach(I=>{I.type==="media"&&I.replaceStream(o)})}getPeerConnections(){const o={};for(const[m,[I]]of Object.entries(this.connections)){const j=I.getPeerConnection();j&&(o[m]=j)}return o}_addConnection(o,m){this.connections[o]||(this.connections[o]=[]),this.connections[o].push(m)}_makeConnections(o,m,I){o.filter(j=>j!==this._peerId).filter(j=>!this._hasConnection(j)).forEach(j=>{let W;switch(m){case"data":W=new U(j,I);break;case"media":W=new te(j,I);break;default:return}W.startConnection(),this._addConnection(j,W),this._setupMessageHandlers(W),D.log(`${m} connection to ${j} created in ${this.name}`)})}_deleteConnections(o){this.connections[o]&&(this.connections[o].forEach(m=>{m.close(!1)}),delete this.connections[o])}_getConnection(o,m){return this.connections&&this.connections[o]?this.connections[o].filter(j=>j.id===m)[0]:null}_hasConnection(o){return this.connections[o]&&this.connections[o].length>0}_setupMessageHandlers(o){o.on(pe.EVENTS.offer.key,m=>{m.roomName=this.name,this.emit(ve.MESSAGE_EVENTS.offer.key,m)}),o.on(pe.EVENTS.answer.key,m=>{m.roomName=this.name,this.emit(ve.MESSAGE_EVENTS.answer.key,m)}),o.on(pe.EVENTS.candidate.key,m=>{m.roomName=this.name,this.emit(ve.MESSAGE_EVENTS.candidate.key,m)}),o.type==="media"&&o.on(te.EVENTS.stream.key,m=>{m.peerId=o.remoteId,this.emit(ve.EVENTS.stream.key,m)})}static get EVENTS(){return _t}static get MESSAGE_EVENTS(){return Rt}}var De=ve;const ar=new v.default(["open","error","call","connection","expiresin","close","disconnected"]);class Ee extends h.a{constructor(o,m){super(),this.connections={},this.rooms={},this._queuedMessages={},o&&o.constructor===Object?(m=o,o=void 0):o&&(o=o.toString());const I={debug:D.LOG_LEVELS.NONE,secure:!0,config:F.defaultConfig,turn:!0,dispatcherSecure:F.DISPATCHER_SECURE,dispatcherHost:F.DISPATCHER_HOST,dispatcherPort:F.DISPATCHER_PORT};if(this.options=Object.assign({},I,m),this.options.token=ne.randomToken(),D.setLogLevel(this.options.debug),!ne.validateId(o)){this._abort("invalid-id",`ID "${o}" is invalid`);return}if(!ne.validateKey(m.key)){this._abort("invalid-key",`API KEY "${this.options.key}" is invalid`);return}this.options.host==="/"&&(this.options.host=window.location.hostname),m.secure===void 0&&this.options.port!==443&&(this.options.secure=void 0),this._initializeServerConnection(o)}call(o,m,I={}){if(!this._checkOpenStatus())return;I.originator=!0,I.stream=m,I.pcConfig=this._pcConfig;const j=new te(o,I);return j.startConnection(),D.log("MediaConnection created in call method"),this._addConnection(o,j),j}connect(o,m={}){if(!this._checkOpenStatus())return;m.pcConfig=this._pcConfig;const I=new U(o,m);return I.startConnection(),D.log("DataConnection created in connect method"),this._addConnection(o,I),I}joinRoom(o,m={}){if(!!this._checkOpenStatus()){if(!o){const I=new Error("Room name must be defined.");return I.type="room-error",D.error(I),this.emit(Ee.EVENTS.error.key,I),null}return m.pcConfig=this._pcConfig,m.peerId=this.id,m.mode==="sfu"?this._initializeSfuRoom(o,m):this._initializeFullMeshRoom(o,m)}}getConnection(o,m){if(!!this._checkOpenStatus()){if(this.connections[o]){for(const I of this.connections[o])if(I.id===m)return I}return null}}get open(){return this.socket&&this.socket.isOpen}destroy(){this._cleanup(),this.disconnect(!0)}disconnect(o=!1){o||D.warn("Use peer's destroy method instead. This method may be removed in future versions."),this.open&&(this.socket.close(),this.emit(Ee.EVENTS.disconnected.key,this.id))}reconnect(){D.warn("Recreate peer instance instead. This method may be removed in future versions."),this.open||this.socket.reconnect()}updateCredential(o){this.socket.updateCredential(o)}listAllPeers(o){if(!this._checkOpenStatus())return;o=o||function(){};const m=this,I=new XMLHttpRequest,j=`${this.socket.signalingServerUrl}/api/apikeys/${this.options.key}/clients/`;I.open("get",j,!0),I.onerror=function(){m._abort("server-error","Could not get peers from the server."),o([])},I.onreadystatechange=function(){if(I.readyState===4)if(I.status===401){o([]);const W=new Error("It doesn't look like you have permission to list peers IDs. Please enable the SkyWay REST API on dashboard");W.type="list-error",D.error(W),m.emit(Ee.EVENTS.error.key,W)}else I.status===200?o(JSON.parse(I.responseText)):o([])},I.send(null)}async fetchPeerExists(o){if(!this.open)throw new Error("Peer is not yet connected to signaling server");const m=new Date().getTime();if(this._lastFetchPeerExistsTime!==void 0&&m-this._lastFetchPeerExistsTime<1e3)throw new Error("fetchPeerExists can only be called once per second");this._lastFetchPeerExistsTime=m;const I=`${this.socket.signalingServerUrl}/api/apikeys/${this.options.key}/peers/${o}/exists`,j=await fetch(I);if(j.status===200)return(await j.json()).exists;{const W=await j.text();throw new Error(W)}}_checkOpenStatus(){return this.open||this._emitNotConnectedError(),this.open}_emitNotConnectedError(){D.warn("You cannot connect to a new Peer because you are not connecting to SkyWay server now.You can create a new Peer to reconnect, or call reconnect() on this peer if you believe its ID to still be available.");const o=new Error("Cannot connect to new Peer before connecting to SkyWay server or after disconnecting from the server.");o.type="disconnected",D.error(o),this.emit(Ee.EVENTS.error.key,o)}_initializeServerConnection(o){this.socket=new Le(this.options.key,{secure:this.options.secure,host:this.options.host,port:this.options.port,dispatcherSecure:this.options.dispatcherSecure,dispatcherHost:this.options.dispatcherHost,dispatcherPort:this.options.dispatcherPort}),this._setupMessageHandlers(),this.socket.on("error",m=>{this._abort("socket-error",m)}),this.socket.on("disconnect",()=>{this.disconnect(!0);const m=new Error("Lost connection to server.");m.type="socket-error",D.error(m),this.emit(Ee.EVENTS.error.key,m)}),this.socket.start(o,this.options.token,this.options.credential)}_initializeSfuRoom(o,m={}){if(this.rooms[o])return this.rooms[o];const I=new Re(o,this.id,m);this.rooms[o]=I,this._setupSFURoomMessageHandlers(I);const j={roomName:o,roomType:"sfu"};return this.socket.send(F.MESSAGE_TYPES.CLIENT.ROOM_JOIN.key,j),I}_initializeFullMeshRoom(o,m={}){if(this.rooms[o])return this.rooms[o];const I=new De(o,this.id,m);this.rooms[o]=I,this._setupMeshRoomMessageHandlers(I);const j={roomName:o,roomType:"mesh"};return this.socket.send(F.MESSAGE_TYPES.CLIENT.ROOM_JOIN.key,j),I}_setupMessageHandlers(){this.socket.on(F.MESSAGE_TYPES.SERVER.OPEN.key,o=>{this.id=o.peerId,this._pcConfig=Object.assign({},this.options.config);const m=this._pcConfig.iceServers;this._pcConfig.iceServers=m?m.slice():[];const I=o.turnCredential;let j,W;if(typeof I=="object"?(j=I.username,W=I.credential):typeof I=="string"&&(j=`${this.options.key}$${this.id}`,W=I),this.options.turn===!0&&j&&W){const re=[{protocol:"turn",transport:"tcp"},{protocol:"turn",transport:"udp"}];ne.detectBrowser().name!=="edge"&&re.push({protocol:"turns",transport:"tcp"});for(const le of re){const me=le.protocol,Ce=le.transport,yt={urls:`${me}:${F.TURN_HOST}:${F.TURN_PORT}?transport=${Ce}`,url:`${me}:${F.TURN_HOST}:${F.TURN_PORT}?transport=${Ce}`,username:j,credential:W};this._pcConfig.iceServers.push(yt)}D.log("SkyWay TURN Server is available")}else D.log("SkyWay TURN Server is unavailable");this.emit(Ee.EVENTS.open.key,this.id)}),this.socket.on(F.MESSAGE_TYPES.SERVER.ERROR.key,o=>{const m=new Error(o.message);m.type=o.type,D.error(m),this.emit(Ee.EVENTS.error.key,m)}),this.socket.on(F.MESSAGE_TYPES.SERVER.LEAVE.key,o=>{D.log(`Received leave message from ${o}`),this._cleanupPeer(o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.FORCE_CLOSE.key,({src:o,connectionId:m})=>{const I=this.getConnection(o,m);I&&I.close(!1)}),this.socket.on(F.MESSAGE_TYPES.SERVER.AUTH_EXPIRES_IN.key,o=>{D.log(`Credential expires in ${o}`),this.emit(Ee.EVENTS.expiresin.key,o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.OFFER.key,o=>{const m=o.roomName;if(m){const W=this.rooms[m];W&&W.handleOffer(o);return}const I=o.connectionId;let j=this.getConnection(o.src,I);if(j){j.updateOffer(o);return}o.connectionType==="media"?(j=new te(o.src,{connectionId:I,payload:o,metadata:o.metadata,originator:!1,queuedMessages:this._queuedMessages[I],pcConfig:this._pcConfig}),j.startConnection(),D.log("MediaConnection created in OFFER"),this._addConnection(o.src,j),this.emit(Ee.EVENTS.call.key,j)):o.connectionType==="data"?(j=new U(o.src,{connectionId:I,payload:o,metadata:o.metadata,label:o.label,dcInit:o.dcInit,serialization:o.serialization,queuedMessages:this._queuedMessages[I],pcConfig:this._pcConfig}),j.startConnection(),D.log("DataConnection created in OFFER"),this._addConnection(o.src,j),this.emit(Ee.EVENTS.connection.key,j)):D.warn("Received malformed connection type: ",o.connectionType),delete this._queuedMessages[I]}),this.socket.on(F.MESSAGE_TYPES.SERVER.ANSWER.key,o=>{const m=o.roomName;if(m){const j=this.rooms[m];j&&j.handleAnswer(o);return}const I=this.getConnection(o.src,o.connectionId);I?I.handleAnswer(o):this._storeMessage(F.MESSAGE_TYPES.SERVER.ANSWER.key,o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.CANDIDATE.key,o=>{const m=o.roomName;if(m){const j=this.rooms[m];j&&j.handleCandidate(o);return}const I=this.getConnection(o.src,o.connectionId);I?I.handleCandidate(o):this._storeMessage(F.MESSAGE_TYPES.SERVER.CANDIDATE.key,o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.ROOM_USER_JOIN.key,o=>{const m=this.rooms[o.roomName];m&&m.handleJoin(o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.ROOM_USER_LEAVE.key,o=>{const m=this.rooms[o.roomName];m&&m.handleLeave(o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.ROOM_DATA.key,o=>{const m=this.rooms[o.roomName];m&&m.handleData(o)}),this.socket.on(F.MESSAGE_TYPES.SERVER.ROOM_LOGS.key,o=>{const m=this.rooms[o.roomName];m&&m.handleLog(o.log)}),this.socket.on(F.MESSAGE_TYPES.SERVER.ROOM_USERS.key,o=>{const m=this.rooms[o.roomName];m&&(o.type==="media"?m.makeMediaConnections(o.userList):m.makeDataConnections(o.userList))}),this.socket.on(F.MESSAGE_TYPES.SERVER.SFU_OFFER.key,o=>{const m=this.rooms[o.roomName];m&&(m.updateMsidMap(o.msids),m.handleOffer(o))})}_setupConnectionMessageHandlers(o){o.on(pe.EVENTS.candidate.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_CANDIDATE.key,m)}),o.on(pe.EVENTS.answer.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_ANSWER.key,m)}),o.on(pe.EVENTS.offer.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_OFFER.key,m)}),o.on(pe.EVENTS.forceClose.key,()=>{const m={dst:o.remoteId,connectionId:o.id};this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_FORCE_CLOSE.key,m)})}_setupRoomMessageHandlers(o){o.on(Re.MESSAGE_EVENTS.broadcast.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.ROOM_SEND_DATA.key,m)}),o.on(Re.MESSAGE_EVENTS.getLog.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.ROOM_GET_LOGS.key,m)}),o.on(Re.MESSAGE_EVENTS.leave.key,m=>{delete this.rooms[o.name],this.socket.send(F.MESSAGE_TYPES.CLIENT.ROOM_LEAVE.key,m)})}_setupSFURoomMessageHandlers(o){this._setupRoomMessageHandlers(o),o.on(Re.MESSAGE_EVENTS.offerRequest.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SFU_GET_OFFER.key,m)}),o.on(Re.MESSAGE_EVENTS.answer.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SFU_ANSWER.key,m)}),o.on(Re.MESSAGE_EVENTS.candidate.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SFU_CANDIDATE.key,m)})}_setupMeshRoomMessageHandlers(o){this._setupRoomMessageHandlers(o),o.on(De.MESSAGE_EVENTS.offer.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_OFFER.key,m)}),o.on(De.MESSAGE_EVENTS.answer.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_ANSWER.key,m)}),o.on(De.MESSAGE_EVENTS.candidate.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.SEND_CANDIDATE.key,m)}),o.on(De.MESSAGE_EVENTS.getPeers.key,m=>{this.socket.send(F.MESSAGE_TYPES.CLIENT.ROOM_GET_USERS.key,m)})}_abort(o,m){D.error("Aborting!"),this.disconnect(!0);const I=new Error(m);I.type=o,D.error(I),this.emit(Ee.EVENTS.error.key,I)}_addConnection(o,m){this.connections[o]||(this.connections[o]=[]),this.connections[o].push(m),this._setupConnectionMessageHandlers(m)}_storeMessage(o,m){this._queuedMessages[m.connectionId]||(this._queuedMessages[m.connectionId]=[]),this._queuedMessages[m.connectionId].push({type:o,payload:m})}_cleanup(){if(this.connections)for(const o of Object.keys(this.connections))this._cleanupPeer(o);this.emit(Ee.EVENTS.close.key)}_cleanupPeer(o){if(this.connections[o])for(const m of this.connections[o])m.close(!1)}static get EVENTS(){return ar}}s.default=Ee},0:function(i,s){}}).default})})(Zt);const er=_i(Zt.exports),Ri="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABmUlEQVQ4ja3UwWoTURTG8f85jQkFl4II7oVYrPgKuuiyM5Pbokg3LhQXvoJ9hkapguBO0TBJ38Bt0bqoUV9BBLeikzrnuJgOjDHNdGjO7h7u/fEduPcyiaJ3WQhdFlRqrdYDyfNXWRStLAIUgN8hXNE8f+Pudzuj0eczgQ6Sr6+vuepPhz7wHJE/J54wc0TG7eFwfyY4ieNnwH3gUOCRw1vgYn0UedhO091qy0EU2DperzrsCGwA32tB9zvV5VGvd/MoST60gOVKv0QTg4HApTkJlwGyJLmq8NjNAoDO2LrqIk9UdbMuaRZFsbh/cvdQ9maB4H7dzfoCicO3E0OqXpg2ZoNlUniqqr156HTNAwvUvRFaBxbjN0DrwRI166v7P1fKzX4A1hws6oar9kU1LpN2RqOhi1wTkUEV/HVqshh/RyFgdj4LodtJ0y/n0nRDVG8h8lEmcfwCuNcgKcABxXN96UtLtzuDwVconp749rbm4/GaweVTUWaO+2F7b+99FkJX8vx1FZWGyf6r6a/vzOA0uhAQ4Hj83b/p9b66cJMW3AAAAABJRU5ErkJggg==",tr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAABkklEQVQ4ja3SP4wMYRjH8e/v3VCdRCI6IgoJBZ2r2JmhUUg2kdwfUYiQnJqoRJxCQa7QaFBenJ1tuIJC3MxuqdFxiYKo6bby5/0pHJm7W3u7w9O9z/N7P3mfzMB/LlUPaTFz2uJakO8XSZ7/E5h2p6/auisIQB/rcJk9+TguGNaw81gLaxjABMGP8PoNRgYhXNg0MSfTcnquHhgZuJrFrVqggpcHDSW9rwUWzUNPgTebwB+6WQtE89FwvTowfAV/rgcC3bT9wvD4z+tguwPP0uLcnloggBznDG8rrX3o+8vjvandtcAy6/RDjGdAXyrtg40Yes3u7N5RwIE/blLOHBW8Anb87hk+ybEFjZ2WbwsOIG6UzfYDhIeCAGkxmyIvV1HgG7CtmjNesXypl3Q+DAUBTvSmJmNsPAfvGpYD+pIvFkmeh2GplWbnNdYx4N0W4ISty7DhowyqMltaxXFSaOlvGUOUvABbrLyx0uLsKSveERxZ55krZda+Nzb46/p8SLqrLZmW5f2yH5ZZvji2M2r9BFzciirmK+ZYAAAAAElFTkSuQmCC",Ni=`#videoCall{width:75%;height:75%;position:relative;border:solid 1px #000;margin:0 auto;background-color:#ffffff4d;overflow:hidden;border-radius:8px}#videoCall .contact-name{position:absolute;top:0;margin-left:15px;color:#050000;text-shadow:0 1px rgba(0,0,0,.7)}#videoCall .remote-stream{width:100%;height:50%;background:rgba(3,33,52,.7);z-index:-1}#videoCall .local-stream{width:25%;height:25%;position:sticky;z-index:1000;background:#fff;border:solirgb(203,204,200)x rgba(0,0,0,.3);bottom:0;left:0%;border-radius:8px;margin:5px;padding:2px}#videoCall .controls{position:relative;bottom:0;right:0;margin-right:20px;margin-bottom:10px}#videoCall .controls button{border:0 none;padding:11px 12px;border-radius:50%;margin-right:6px}#videoCall .controls button i{color:#f5f5f5}.room>div{display:flex;justify-content:start;margin-bottom:5px;float:left}.video-call{height:250px;width:100%}.video-call>video{height:250px;width:100%;margin-left:2px}input,button{margin:5px}.member{width:250px;padding:0;height:140px;margin:2px}
`,Oi={name:"webrtcMultiCall",data:function(){return{Peer:this.Peer,isJoined:!1,peerID:null,roomName:this.roomName,videoList:[],remoteStream:null,roomMode:null,isStreaming:!1,SHButton:!1,localStream:null,konferenzRaum:null,muteBtn:!1,hideCamBtn:!1}},props:{PeerAPIKey:{type:String,default:"39f1fcb4-867e-44d7-ab1e-1bc417d09a54"},roomname:{type:String},isAudio:{type:Boolean,default:!1},videoHeight:{type:[Number,String],default:300},videoWidth:{type:[Number,String],default:500},doScreenShot:{type:Boolean,default:!1},doShareScreen:{type:Boolean,default:!1}},mounted(){this.Peer=new er({key:this.PeerAPIKey,debug:3}),this.Peer.on("open",function(){this.peerID=this.Peer.id}.bind(this))},methods:{getRoomHash:function(){location.hash,sfu},startStream:function(){this.isJoined=!0,this.isStreaming=!0,this.localStream=navigator.mediaDevices.getUserMedia({video:{width:this.videoWidth,height:this.videoHeight},audio:!0}).then(function(l){this.$refs.localVideo.srcObject=l,this.$refs.localVideo.play(),this.localStream=l}.bind(this)).catch(function(l){console.log(l)})},stopStream:function(){this.isStreaming=!1,this.isJoined=!1,this.$refs.localVideo.srcObject.srcObject=null,this.Peer=null},joinRoom:function(){if(this.isStreaming=!0,this.roomName==null||this.roomName==""||this.roomName==" ")alert("enter a room name");else{if(this.konferenzRaum=this.Peer.joinRoom(this.roomName,{mode:this.getRoomHash,stream:this.localStream}),!this.Peer.open)return;this.konferenzRaum.once("open",()=>{let l=document.createElement("p");l.setAttribute("ref","peerID"),l.innerHTML=`you are joined at: <b>${this.roomName}</b>`,this.$el.parentNode.getElementById("board").append(l)}),this.konferenzRaum.on("stream",l=>{let t=document.createElement("video");t.setAttribute("id","videoElement"),t.setAttribute("class","member"),console.log("parent node",this.$el.parentNode),this.$el.parentNode.getElementById("remoteVideo").append(t),t.srcObject=l,t.playsInline=!0,this.remoteStream=l,t.play()})}},leaveRoom:function(){this.konferenzRaum.close(),this.konferenzRaum.once("open",()=>{})?(this.$refs.localVideo.srcObject.getTracks().forEach(l=>l.stop()),this.$refs.localVideo.srcObject.srcObject=null,console.log("you left"),this.isJoined=!1,this.isStreaming=!1,this.Peer=null):alert("you are not joined")},screenShot:function(){this.$refs.localVideo.srcObject!=null?(this.SHButton=!0,this.$refs.canvas.width=this.$refs.localVideo.videoWidth,this.$refs.canvas.height=this.$refs.localVideo.videoHeight,this.$refs.canvas.getContext("2d").drawImage(this.$refs.localVideo,0,0,this.videoWidth,this.videoHeight)):alert("there is no streaming")},screenShotDelete:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,this.videoWidth,this.videoHeight),this.SHButton=!1},doMute:function(){this.muteBtn=!0,this.$refs.localVideo.srcObject.getTracks()[0].enabled=!1},unMute:function(){this.muteBtn=!1,this.$refs.localVideo.srcObject.getTracks()[0].enabled=!0},hideCam:function(){this.hideCamBtn=!0,this.$refs.localVideo.srcObject.getTracks()[1].enabled=!1},showCam:function(){this.hideCamBtn=!1,this.$refs.localVideo.srcObject.getTracks()[1].enabled=!0},shareScreen:function(){navigator.mediaDevices.getDisplayMedia({audio:this.isAudio,video:{width:this.videoWidth,height:this.videoHeight}}).then(function(l){l.getVideoTracks()[0],this.$refs.shareScreen.srcObject=l}.bind(this),function(l){alert("error")})}}},Ii={id:"videoCall"},Fi={key:0,id:"board"},Pi={key:1,ref:"localVideo"},Mi=G("hr",null,null,-1),Di={class:"remote-streams",ref:"remoteVideo",id:"remoteVideo"},Vi={class:"controls"},ji=G("img",{src:Ct},null,-1),Ui=[ji],Li=G("img",{src:Ri},null,-1),zi=[Li],Hi=G("img",{src:et},null,-1),Wi=[Hi],Gi=G("img",{src:tt},null,-1),Yi=[Gi],Qi=G("img",{src:rt},null,-1),qi=[Qi],$i=G("img",{src:nt},null,-1),Ji=[$i],Ki=G("img",{src:it},null,-1),Xi=[Ki],Zi={ref:"canvas"},es=G("img",{src:st},null,-1),ts=[es],rs={key:8},ns=G("img",{src:tr},null,-1),is=[ns],ss=G("img",{src:Ze},null,-1),os=[ss],as={key:2,ref:"canvas"};function cs(l,t,i,s,d,r){return Y(),Q("div",Ii,[l.isStreaming?(Y(),Q("div",Fi,[G("p",{ref:"peerID"},"Your Peer ID: "+Ue(this.peerID),513)])):$("",!0),l.isStreaming?(Y(),Q("video",Pi,null,512)):$("",!0),Mi,G("div",Di,null,512),G("div",Vi,[l.isStreaming?$("",!0):(Y(),Q("button",{key:0,onClick:t[0]||(t[0]=(...h)=>r.startStream&&r.startStream(...h)),title:"start stream"},Ui)),l.isStreaming?(Y(),Q("button",{key:1,id:"btn2",onClick:t[1]||(t[1]=(...h)=>r.stopStream&&r.stopStream(...h)),title:"leave"},zi)):$("",!0),l.isStreaming?(Y(),Q("button",{key:2,id:"btn3",onClick:t[2]||(t[2]=(...h)=>r.screenShot&&r.screenShot(...h)),title:"selfie"},Wi)):$("",!0),l.isStreaming&&!l.muteBtn?(Y(),Q("button",{key:3,id:"muteBtn",onClick:t[3]||(t[3]=(...h)=>r.doMute&&r.doMute(...h)),title:"mute"},Yi)):$("",!0),l.isStreaming&&l.muteBtn?(Y(),Q("button",{key:4,id:"muteBtn",onClick:t[4]||(t[4]=(...h)=>r.unMute&&r.unMute(...h)),title:"ummute"},qi)):$("",!0),l.isStreaming&&!l.hideCamBtn?(Y(),Q("button",{key:5,id:"hideCamBtn",onClick:t[5]||(t[5]=(...h)=>r.hideCam&&r.hideCam(...h)),title:"hide camera"},Ji)):$("",!0),l.isStreaming&&l.hideCamBtn?(Y(),Q("button",{key:6,id:"hideCamBtn",onClick:t[6]||(t[6]=(...h)=>r.showCam&&r.showCam(...h)),title:"show camera"},Xi)):$("",!0),G("canvas",Zi,null,512),l.SHButton?(Y(),Q("button",{key:7,onClick:t[7]||(t[7]=(...h)=>r.screenShotDelete&&r.screenShotDelete(...h)),title:"delete img"},ts)):$("",!0),l.isJoined?(Y(),Q("div",rs,[Je(G("input",{type:"text",placeholder:"Room Name",ref:"roomName","onUpdate:modelValue":t[8]||(t[8]=h=>l.roomName=h)},null,512),[[Ke,l.roomName]]),G("button",{ref:"joinRoom",onClick:t[9]||(t[9]=(...h)=>r.joinRoom&&r.joinRoom(...h))},is,512),G("button",{ref:"leaveRoom",onClick:t[10]||(t[10]=(...h)=>r.leaveRoom&&r.leaveRoom(...h))},os,512),i.doScreenShot?(Y(),Q("button",{key:0,onClick:t[11]||(t[11]=(...h)=>r.screenShot&&r.screenShot(...h))},"screenshot")):$("",!0)])):$("",!0)]),i.doScreenShot&&l.SHButton?(Y(),Q("canvas",as,null,512)):$("",!0)])}const us=ot(Oi,[["render",cs],["styles",[Ni]]]),ds=`#videoCall{width:75%;height:75%;position:relative;border:solid 1px #000;margin:0 auto;background-color:#ffffff4d;overflow:hidden;border-radius:8px}#videoCall .contact-name{position:absolute;top:0;margin-left:15px;color:#050000;text-shadow:0 1px rgba(0,0,0,.7)}#videoCall .remote-stream{width:100%;height:50%;background:rgba(255 255 255 / 30%);z-index:-1}#videoCall .local-stream{width:50%;height:25%;position:inherit;z-index:1000;background:rgb(255 255 255 / 30%);bottom:0;left:0%;border-radius:8px}#videoCall .controls{position:absolute;bottom:0;right:0;margin-right:20px;margin-bottom:10px}#videoCall .controls button{border:0 none;padding:6px 9px;border-radius:50%;margin-right:6px;margin-bottom:0}.divInput{margin-bottom:3px}#videoCall .controls button i{color:#f5f5f5}.container{position:relative;width:50%}.container canvas{width:100%;height:auto;border-radius:5px}.container .btn{position:absolute;top:9%;left:95%;transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);padding:5px 9px;border:black;cursor:pointer;border-radius:23px}.material-icons.md-18{font-size:18px}.material-icons.md-24{font-size:24px}.material-icons.md-36{font-size:36px}.material-icons.md-48{font-size:48px}
`,fs={name:"webrtc-peercall",data:function(){return{localStream:null,peerID:null,isStreaming:!1,isJoined:!1,SHButton:!1,muteBtn:!1,hideCamBtn:!1,remoteID:"",mediaConnection:null,isaudio:this.isAudio}},props:{peerAPIkey:{type:String,default:"426053f4-1d3a-4030-b78c-0985d60f8f5f"},videoWidth:{type:[String,Number],default:450},videoHeight:{type:[String,Number],default:250},isAudio:{type:Boolean,default:!1},peer_ID:{type:String},remote_ID:{type:String}},methods:{startCall:function(){this.isStreaming=!0,this.localStream=navigator.mediaDevices.getUserMedia({video:{height:this.videoHeight,width:this.videoWidth},audio:!0}).then(function(l){this.$refs.localVideo.srcObject=l,this.$refs.localVideo.play(),this.localStream=l}.bind(this)).catch(function(l){console.log(l)}),console.log(this.localStream)},joinCall:function(){this.isJoined=!0,this.remoteID==null||this.remoteID==""||this.remoteID==" "?alert("enter peer id "):(document.getElementById("remoteVideo"),this.mediaConnection=this.Peer.call(this.remoteID,this.localStream),this.mediaConnection.on("stream",l=>{this.$refs.remoteVideo.srcObject=l,this.$refs.remoteVideo.playsInline=!0,this.$refs.remoteVideo.play()}),this.mediaConnection.once("close",()=>{this.$refs.remoteVideo.srcObject.getTracks().forEach(l=>l.stop()),this.$refs.remoteVideo.srcObject=null,this.$refs.localVideo.srcObject=null}))},leaveCall:function(){this.isStreaming=!1,this.$refs.remoteVideo.srcObject=null,this.$refs.localVideo.srcObject=null,this.Peer=null,this.mediaConnection.close(!0)},screenShot:function(){this.localStream?(this.SHButton=!0,this.$refs.canvas.width=this.$refs.localVideo.videoWidth,this.$refs.canvas.height=this.$refs.localVideo.videoHeight,this.$refs.canvas.getContext("2d").drawImage(this.$refs.localVideo,0,0,this.videoWidth,this.videoHeight)):alert("error")},screenShotDelete:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,this.videoWidth,this.videoHeight),this.SHButton=!1},doMute:function(){this.muteBtn=!0,this.$refs.localVideo.srcObject.getTracks()[0].enabled=!1},unMute:function(){this.muteBtn=!1,this.$refs.localVideo.srcObject.getTracks()[0].enabled=!0},hideCam:function(){this.hideCamBtn=!0,this.$refs.localVideo.srcObject.getTracks()[1].enabled=!1},showCam:function(){this.hideCamBtn=!1,this.$refs.localVideo.srcObject.getTracks()[1].enabled=!0}},mounted(){this.Peer=new er({key:this.peerAPIkey,debug:3}),this.Peer.once("open",function(){this.peerID=this.Peer.id}.bind(this)),this.Peer.on("call",function(l){l.answer(this.localStream),l.on("stream",t=>{this.$refs.remoteVideo.srcObject=t,this.$refs.remoteVideo.playsInline=!0,this.$refs.remoteVideo.play().catch(console.log(error))}),l.once("close",function(){this.$refs.remoteVideo.srcObject.getTracks().forEach(t=>t.stop()),this.$refs.remoteVideo.srcObject=null}.bind(this))}.bind(this))}},ls={id:"videoCall"},hs=G("div",{class:"contact-name"},null,-1),ps={key:0,class:"remote-stream",ref:"localVideo",id:"localVideo"},ms={key:1,class:"local-stream",id:"remoteVideo",ref:"remoteVideo"},gs={class:"controls"},ys=G("img",{src:Ct},null,-1),vs=[ys],Es=G("img",{src:Ze},null,-1),Ss=[Es],ws=G("img",{src:tt},null,-1),bs=[ws],As=G("img",{src:rt},null,-1),Cs=[As],ks=G("img",{src:nt},null,-1),xs=[ks],Bs=G("img",{src:it},null,-1),Ts=[Bs],_s=G("img",{src:et},null,-1),Rs=[_s],Ns=G("img",{src:tr},null,-1),Os=[Ns],Is=G("div",{class:""},null,-1),Fs=At(),Ps={class:"container",id:"container"},Ms={ref:"canvas"};function Ds(l,t,i,s,d,r){return Y(),Q("div",null,[G("div",ls,[hs,G("p",{ref:"peerID"},"Your Peer ID: "+Ue(this.peerID),513),l.isStreaming?(Y(),Q("video",ps,null,512)):$("",!0),l.isStreaming?(Y(),Q("video",ms,null,512)):$("",!0),G("div",gs,[l.isStreaming?$("",!0):(Y(),Q("button",{key:0,onClick:t[0]||(t[0]=(...h)=>r.startCall&&r.startCall(...h)),title:"start stream"},vs)),l.isStreaming?(Y(),Q("button",{key:1,id:"btn2",ref:"",onClick:t[1]||(t[1]=(...h)=>r.leaveCall&&r.leaveCall(...h)),title:"leave call"},Ss,512)):$("",!0),l.isStreaming&&!l.muteBtn?(Y(),Q("button",{key:2,id:"muteBtn",onClick:t[2]||(t[2]=(...h)=>r.doMute&&r.doMute(...h)),title:"mute"},bs)):$("",!0),l.isStreaming&&l.muteBtn?(Y(),Q("button",{key:3,id:"muteBtn",onClick:t[3]||(t[3]=(...h)=>r.unMute&&r.unMute(...h)),title:"ummute"},Cs)):$("",!0),l.isStreaming&&!l.hideCamBtn?(Y(),Q("button",{key:4,id:"hideCamBtn",onClick:t[4]||(t[4]=(...h)=>r.hideCam&&r.hideCam(...h)),title:"hide camera"},xs)):$("",!0),l.isStreaming&&l.hideCamBtn?(Y(),Q("button",{key:5,id:"hideCamBtn",onClick:t[5]||(t[5]=(...h)=>r.showCam&&r.showCam(...h)),title:"show camera"},Ts)):$("",!0),l.isStreaming?(Y(),Q("button",{key:6,id:"btn3",onClick:t[6]||(t[6]=(...h)=>r.screenShot&&r.screenShot(...h)),title:"selfie"},Rs)):$("",!0),l.isStreaming?(Y(),Q("button",{key:7,onClick:t[7]||(t[7]=(...h)=>r.joinCall&&r.joinCall(...h))},Os)):$("",!0),G("div",null,[l.isStreaming?Je((Y(),Q("input",{key:0,ref:"peerid",type:"text","onUpdate:modelValue":t[8]||(t[8]=h=>l.remoteID=h)},null,512)),[[Ke,l.remoteID]]):$("",!0)])]),Is,Fs,G("div",Ps,[G("canvas",Ms,null,512),l.SHButton?(Y(),Q("button",{key:0,class:"btn",onClick:t[9]||(t[9]=(...h)=>r.screenShotDelete&&r.screenShotDelete(...h))}," X ")):$("",!0)])])])}const Vs=ot(fs,[["render",Ds],["styles",[ds]]]),js=Xe(tn),Us=Xe(Ti),Ls=Xe(Vs),zs=Xe(us);customElements.define("webrtc-stream",js);customElements.define("webrtc-call",Us);customElements.define("webrtc-peercall",Ls);customElements.define("webrtc-roomcall",zs);
